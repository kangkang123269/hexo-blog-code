{"meta":{"version":1,"warehouse":"4.0.1"},"models":{"Asset":[{"_id":"themes/butterfly/source/css/index.styl","path":"css/index.styl","modified":0,"renderable":1},{"_id":"themes/butterfly/source/css/var.styl","path":"css/var.styl","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/404.jpg","path":"img/404.jpg","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/favicon.png","path":"img/favicon.png","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/friend_404.gif","path":"img/friend_404.gif","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/main.js","path":"js/main.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/tw_cn.js","path":"js/tw_cn.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/utils.js","path":"js/utils.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/search/algolia.js","path":"js/search/algolia.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/search/local-search.js","path":"js/search/local-search.js","modified":0,"renderable":1}],"Cache":[{"_id":"source/categories/index.md","hash":"ad7a0f34871f3417b80bf67bc8bae35dc2421625","modified":1665543025547},{"_id":"source/link/index.md","hash":"756fd36b023a6de226e053180384d1791d912d07","modified":1665543025547},{"_id":"source/archives/index.md","hash":"2542bd2d0965fbaf7b270d68256e82c87bb6eda9","modified":1665543025547},{"_id":"source/about/index.md","hash":"f7881fef88b8fbcde462bc2a91dfa753799a77f9","modified":1665543025546},{"_id":"source/music/index.md","hash":"d80451813cccba40ed38fa79f7d47dd5b15e714b","modified":1665543025548},{"_id":"source/tags/index.md","hash":"1155c8a84f2874279a47e4191c1e7933f68bc5f5","modified":1665543025548},{"_id":"source/messageboard/index.md","hash":"97d3237d3e7fadd0ba107570a6278c99a5df2dc0","modified":1665543025547},{"_id":"source/_posts/css/css弹窗动画.md","hash":"078687e9f125961ad1d583fccb3e7dbec7058f55","modified":1665543025543},{"_id":"source/_posts/javascript/js实现拖拽.md","hash":"5d8c412001efb52ab5d475aad40b23dcacaf0080","modified":1665543025544},{"_id":"source/_posts/html5/实现全屏功能.md","hash":"b1a4627737983f30d3431b026bf1429cc0da0859","modified":1665543025544},{"_id":"source/_posts/html5/生成任意文件.md","hash":"879362034d0d555653892f856a8ad5ccd77eef9e","modified":1665543025544},{"_id":"source/_posts/react/学习react-dnd.md","hash":"0687ee4460ccb71e9f18edce682514d573151195","modified":1665543025545},{"_id":"source/_posts/skill/js时间操作的应用.md","hash":"6ccd079dec356ba50bdf9cc88378c09214e9c9c0","modified":1665543025545},{"_id":"source/_posts/skill/一行代码的JavaScript.md","hash":"89d5dc4b66df391e51d30ab7e0aec2a1901b824d","modified":1665543025545},{"_id":"source/_posts/vite/vite中用@别名.md","hash":"7cb90728673fe55de265f83d1795d9a27167122f","modified":1665543025545},{"_id":"source/_posts/vite/初识vite插件.md","hash":"d203bae152cc64b2c1f172cc4c7eedbcb91c7c8f","modified":1665543025545},{"_id":"source/_posts/vite/手写一个vite-mock-plugin.md","hash":"1ea9dd02cb1d3bd046b43a351f10ac92ce831bc6","modified":1665543025546},{"_id":"source/_posts/vue/在Vue中使用keep-alive.md","hash":"78c04270c05628b75c66738a2a0c8af4142b2ce2","modified":1665543025546},{"_id":"source/_posts/前端笔试/错题集.md","hash":"8de55e6e26b75ad0e21b0818aef63b1a58c70b9b","modified":1665716299766},{"_id":"source/_posts/docker/docker基础学习.md","hash":"f8eeb4a8d97a3f15631536ed1a4a53fcbdd3988a","modified":1665543025543},{"_id":"themes/butterfly/README.md","hash":"cde88743f77bad1b463aa78049398b19f878090e","modified":1658809870000},{"_id":"themes/butterfly/LICENSE","hash":"1128f8f91104ba9ef98d37eea6523a888dcfa5de","modified":1658809870000},{"_id":"themes/butterfly/package.json","hash":"3bcb70e12282156703626e238e3719611c34c3b7","modified":1658809870000},{"_id":"themes/butterfly/README_CN.md","hash":"01b4feffb432293223f540921ce2cde748b2d2fe","modified":1658809870000},{"_id":"themes/butterfly/_config.yml","hash":"26a7fa8c79b3732318e751875aff79975abe3775","modified":1658809870000},{"_id":"themes/butterfly/plugins.yml","hash":"0194c4fb88a6be30d983a83ac22072bb4d799c9a","modified":1658809870000},{"_id":"themes/butterfly/.github/stale.yml","hash":"5e8ea535424e8112439135d21afc5262c0bc0b39","modified":1658809870000},{"_id":"themes/butterfly/languages/default.yml","hash":"1e37a3695d50e3e61d7c36e58a6dac872a4a56cd","modified":1658809870000},{"_id":"themes/butterfly/languages/en.yml","hash":"d1bb560698eb8b0079495b7b18b44facb610f9fd","modified":1658809870000},{"_id":"themes/butterfly/languages/zh-CN.yml","hash":"28b6f0c39155651d747eb595e0a283bc97be2e09","modified":1658809870000},{"_id":"themes/butterfly/layout/category.pug","hash":"710708cfdb436bc875602abf096c919ccdf544db","modified":1658809870000},{"_id":"themes/butterfly/layout/index.pug","hash":"e1c3146834c16e6077406180858add0a8183875a","modified":1658809870000},{"_id":"themes/butterfly/languages/zh-TW.yml","hash":"947f794e862bb2813e36887f777bdb760f70a322","modified":1658809870000},{"_id":"themes/butterfly/layout/page.pug","hash":"baf469784aef227e4cc840550888554588e87a13","modified":1658809870000},{"_id":"themes/butterfly/layout/post.pug","hash":"fc9f45252d78fcd15e4a82bfd144401cba5b169a","modified":1658809870000},{"_id":"themes/butterfly/layout/tag.pug","hash":"0440f42569df2676273c026a92384fa7729bc4e9","modified":1658809870000},{"_id":"themes/butterfly/layout/archive.pug","hash":"a0c034c2d319320a54046805e80b58dc48b7e233","modified":1658809870000},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/bug_report.yml","hash":"67e4f5a66d4b8cabadbaad0410628364ee75e0ae","modified":1658809870000},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/config.yml","hash":"7dfe7189ffeaebb6db13842237f8e124649bea3d","modified":1658809870000},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/feature_request.yml","hash":"996640605ed1e8e35182f0fd9a60a88783b24b03","modified":1658809870000},{"_id":"themes/butterfly/.github/workflows/publish.yml","hash":"05857c2f265246d8de00e31037f2720709540c09","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/404.pug","hash":"cb49f737aca272ccfeb62880bd651eccee72a129","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/additional-js.pug","hash":"594a977ebe8d97e60fa3d7cb40fc260ded4d8a58","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/footer.pug","hash":"02390a5b6ae1f57497b22ba2e6be9f13cfb7acac","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/head.pug","hash":"de8e618ec03295561c667a49e1c383213b856f6f","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/layout.pug","hash":"a557280a25f63f4312afad63fc3303ec74165557","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/pagination.pug","hash":"0b80f04950bd0fe5e6c4e7b7559adf4d0ce28436","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/rightside.pug","hash":"699d0d2cff233628752956c4434125c8203f7d63","modified":1658809870000},{"_id":"themes/butterfly/scripts/events/404.js","hash":"83cd7f73225ccad123afbd526ce1834eb1eb6a6d","modified":1658809870000},{"_id":"themes/butterfly/scripts/events/cdn.js","hash":"acfe765fb2c607bff7198630dbfa53a888c36357","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/sidebar.pug","hash":"8d39473ed112d113674a0f689f63fae06c72abd2","modified":1658809870000},{"_id":"themes/butterfly/scripts/events/comment.js","hash":"a3d1f417965ca20253c36f9e93429f3df6268856","modified":1658809870000},{"_id":"themes/butterfly/scripts/events/init.js","hash":"b4940a5c73d3a5cd8bb5883e3041ecdd905a74e0","modified":1658809870000},{"_id":"themes/butterfly/scripts/events/stylus.js","hash":"9819f0996234fbd80d6c50a9e526c56ebf22588d","modified":1658809870000},{"_id":"themes/butterfly/scripts/events/welcome.js","hash":"3cfc46c749e2fd7ae9c2a17206238ed0e0e17e7d","modified":1658809870000},{"_id":"themes/butterfly/scripts/filters/post_lazyload.js","hash":"932df912976261929f809b7dbd4eb473e7787345","modified":1658809870000},{"_id":"themes/butterfly/scripts/filters/random_cover.js","hash":"21379ed2dccb69c43b893895c9d56238c11e5f43","modified":1658809870000},{"_id":"themes/butterfly/scripts/helpers/aside_archives.js","hash":"2ec66513d5322f185d2071acc052978ba9415a8e","modified":1658809870000},{"_id":"themes/butterfly/scripts/helpers/aside_categories.js","hash":"e00efdb5d02bc5c6eb4159e498af69fa61a7dbb9","modified":1658809870000},{"_id":"themes/butterfly/scripts/helpers/findArchiveLength.js","hash":"ee3e70098eb0849497d50b75e18cf4a27c397d52","modified":1658809870000},{"_id":"themes/butterfly/scripts/helpers/inject_head_js.js","hash":"b4cd617c619d1a0df93603721a6fa1317526174b","modified":1658809870000},{"_id":"themes/butterfly/scripts/helpers/page.js","hash":"763dab5c83f50c1c62fffc9a9dfedea29bb4e629","modified":1658809870000},{"_id":"themes/butterfly/scripts/helpers/related_post.js","hash":"d368a8830e506c8b5eb6512b709ec8db354d5ea1","modified":1658809870000},{"_id":"themes/butterfly/scripts/tag/button.js","hash":"91d954f6e9fe6e571eb8ec9f8996294b2dc3688e","modified":1658809870000},{"_id":"themes/butterfly/scripts/tag/flink.js","hash":"ab62919fa567b95fbe14889517abda649991b1ee","modified":1658809870000},{"_id":"themes/butterfly/scripts/tag/gallery.js","hash":"f79c99f6c5b626c272dc2bed2b0250d6b91bb28a","modified":1658809870000},{"_id":"themes/butterfly/scripts/tag/hide.js","hash":"396c3ab1bcf1c7693ad7e506eadd13016c6769b6","modified":1658809870000},{"_id":"themes/butterfly/scripts/tag/inlineImg.js","hash":"a43ee2c7871bdd93cb6beb804429e404570f7929","modified":1658809870000},{"_id":"themes/butterfly/scripts/tag/label.js","hash":"03b2afef41d02bd1045c89578a02402c28356006","modified":1658809870000},{"_id":"themes/butterfly/scripts/tag/mermaid.js","hash":"531808a290b8bdd66bac2faab211ada8e9646a37","modified":1658809870000},{"_id":"themes/butterfly/scripts/tag/note.js","hash":"d51812b43924f1bbf413c67499510dd125022005","modified":1658809870000},{"_id":"themes/butterfly/scripts/tag/tabs.js","hash":"6c6e415623d0fd39da016d9e353bb4f5cca444f5","modified":1658809870000},{"_id":"themes/butterfly/scripts/tag/timeline.js","hash":"300eb779588bf35a1b687d9f829d866074b707e3","modified":1658809870000},{"_id":"themes/butterfly/source/css/index.styl","hash":"861998e4ac67a59529a8245a9130d68f826c9c12","modified":1658809870000},{"_id":"themes/butterfly/source/css/var.styl","hash":"4890a40366d6443f8b8942a4e9a6dce9fe3494f5","modified":1658809870000},{"_id":"themes/butterfly/source/img/404.jpg","hash":"fb4489bc1d30c93d28f7332158c1c6c1416148de","modified":1658809870000},{"_id":"themes/butterfly/source/img/favicon.png","hash":"3cf89864b4f6c9b532522a4d260a2e887971c92d","modified":1658809870000},{"_id":"themes/butterfly/source/js/tw_cn.js","hash":"00053ce73210274b3679f42607edef1206eebc68","modified":1658809870000},{"_id":"themes/butterfly/source/js/utils.js","hash":"0b95daada72abb5d64a1e3236049a60120e47cca","modified":1658809870000},{"_id":"themes/butterfly/source/img/friend_404.gif","hash":"8d2d0ebef70a8eb07329f57e645889b0e420fa48","modified":1658809870000},{"_id":"themes/butterfly/source/js/main.js","hash":"73d2624ed465e4cfb1ebb00b2c8a24f5fc29bb21","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/head/analytics.pug","hash":"15530d9ac59c576d79af75dd687efe71e8d261b0","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/head/config.pug","hash":"8f41fa9732ea654a10f6e666d9c782c7e27e5ea6","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/head/config_site.pug","hash":"7df90c8e432e33716517ab918b0a125bc284041b","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/head/google_adsense.pug","hash":"95a37e92b39c44bcbea4be7e29ddb3921c5b8220","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/head/noscript.pug","hash":"d16ad2ee0ff5751fd7f8a5ce1b83935518674977","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/head/preconnect.pug","hash":"65a23b5170204e55b813ce13a79d799b66b7382c","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/head/pwa.pug","hash":"3d492cfe645d37c94d30512e0b230b0a09913148","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/head/site_verification.pug","hash":"e2e8d681f183f00ce5ee239c42d2e36b3744daad","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/header/index.pug","hash":"aa175e2254704335f4da09175e59ef2375ca7d03","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/header/menu_item.pug","hash":"31346a210f4f9912c5b29f51d8f659913492f388","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/header/post-info.pug","hash":"8c2524e843adfce00b16e31ee355f14ce9ffb8ba","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/header/social.pug","hash":"0d953e51d04a9294a64153c89c20f491a9ec42d4","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/header/nav.pug","hash":"78a3abd90bb3c18cd773d3d5abac3541e7f415e5","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/loading/loading-js.pug","hash":"4cfcf0100e37ce91864703cd44f1cb99cb5493ea","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/loading/loading.pug","hash":"5276937fbcceb9d62879dc47be880cd469a27349","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/mixins/article-sort.pug","hash":"2fb74d0b0e4b98749427c5a1a1b0acb6c85fadc4","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/mixins/post-ui.pug","hash":"0d10532648d0335254f21a3b7d8676cb96ea8eba","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/page/categories.pug","hash":"5276a8d2835e05bd535fedc9f593a0ce8c3e8437","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/page/default-page.pug","hash":"12c65c174d26a41821df9bad26cdf1087ec5b0ca","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/page/flink.pug","hash":"fed069baa9b383f57db32bb631115071d29bdc60","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/page/tags.pug","hash":"6311eda08e4515281c51bd49f43902a51832383c","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/post/post-copyright.pug","hash":"ebecba46a5f4efe1c98a386df06c56e26fbd07b9","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/post/reward.pug","hash":"864869c43fe5b5bb6f4ac6b13dd4bfb16ea47550","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/aplayer.pug","hash":"c7cfade2b160380432c47eef4cd62273b6508c58","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/effect.pug","hash":"6528e86656906117a1af6b90e0349c2c4651d5e1","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/pangu.pug","hash":"0f024e36b8116118233e10118714bde304e01e12","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/pjax.pug","hash":"6d6474ef186c18d9b4f334e1f735eadd6699effa","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/prismjs.pug","hash":"ffb9ea15a2b54423cd4cd441e2d061b8233e9b58","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/subtitle.pug","hash":"bae2f32ac96cebef600c1e37eaa8467c9a7e5d92","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/widget/card_ad.pug","hash":"60dc48a7b5d89c2a49123c3fc5893ab9c57dd225","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/widget/card_announcement.pug","hash":"ae392459ad401a083ca51ee0b27526b3c1e1faed","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/widget/card_archives.pug","hash":"86897010fe71503e239887fd8f6a4f5851737be9","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/widget/card_author.pug","hash":"e37468e63db2a0ac09b65d21b7de3e62425bb455","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/widget/card_bottom_self.pug","hash":"13dc8ce922e2e2332fe6ad5856ebb5dbf9ea4444","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/widget/card_categories.pug","hash":"d1a416d0a8a7916d0b1a41d73adc66f8c811e493","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/widget/card_newest_comment.pug","hash":"6d93564a8bd13cb9b52ee5e178db3bcbf18b1bc6","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/widget/card_post_toc.pug","hash":"3057a2f6f051355e35d3b205121af8735100eacf","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/widget/card_recent_post.pug","hash":"9c1229af6ab48961021886882c473514101fba21","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/widget/card_tags.pug","hash":"438aea3e713ed16b7559b9a80a9c5ec0221263df","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/widget/index.pug","hash":"7fb096656c8a6c21a4b6a5100885b1081d6021ed","modified":1658809870000},{"_id":"themes/butterfly/source/css/_global/function.styl","hash":"644d520fe80cc82058467708ab82ccad313b0c27","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/widget/card_top_self.pug","hash":"ae67c6d4130a6c075058a9c1faea1648bcc6f83e","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/widget/card_webinfo.pug","hash":"35ce167c5a275211bfc1fa3d49adfde5b404d98f","modified":1658809870000},{"_id":"themes/butterfly/source/css/_global/index.styl","hash":"714f19e7d66df84938bd1b82b33d5667abe1f147","modified":1658809870000},{"_id":"themes/butterfly/source/css/_highlight/highlight.styl","hash":"2f95e99b8351fbecd9037a1bbdc3fee9d6ea8a77","modified":1658809870000},{"_id":"themes/butterfly/source/css/_highlight/theme.styl","hash":"bcd384c8b2aa0390c9eb69ac1abbfd1240ce1da4","modified":1658809870000},{"_id":"themes/butterfly/source/css/_layout/aside.styl","hash":"a0010d833ed30211601c1e0bbbc68e85b77428c6","modified":1658809870000},{"_id":"themes/butterfly/source/css/_layout/chat.styl","hash":"29f48f9370f245e6e575b5836bccf47eb5688d8b","modified":1658809870000},{"_id":"themes/butterfly/source/css/_layout/comments.styl","hash":"c61dccca690d486c3d9c29cf028d87b777385141","modified":1658809870000},{"_id":"themes/butterfly/source/css/_layout/footer.styl","hash":"26be2afa9d4e7016cf3c42a6cd166f01e8e4ad5c","modified":1658809870000},{"_id":"themes/butterfly/source/css/_layout/head.styl","hash":"d97c1722ce0fcc319f1f90ec2d51f9d746748e2b","modified":1658809870000},{"_id":"themes/butterfly/source/css/_layout/loading.styl","hash":"ef21990de28bd75dcd0f88b8d616e1a7a137502f","modified":1658809870000},{"_id":"themes/butterfly/source/css/_layout/pagination.styl","hash":"fb9f78bfbb79579f1d752cb73fb6d25c8418e0fd","modified":1658809870000},{"_id":"themes/butterfly/source/css/_layout/post.styl","hash":"15056fba0bd5a45ea8dc97eb557f6929ff16797a","modified":1658809870000},{"_id":"themes/butterfly/source/css/_layout/relatedposts.styl","hash":"d53de408cb27a2e704aba7f7402b7caebe0410d8","modified":1658809870000},{"_id":"themes/butterfly/source/css/_layout/reward.styl","hash":"c5cfed620708807a48076b5ee59b0ba84e29aa80","modified":1658809870000},{"_id":"themes/butterfly/source/css/_layout/rightside.styl","hash":"bd88ee30ebf8ca2e7b4d3a034c317fd61733921f","modified":1658809870000},{"_id":"themes/butterfly/source/css/_layout/sidebar.styl","hash":"631ca35a38bc4ac052e9caf47508ff1f99842fc7","modified":1658809870000},{"_id":"themes/butterfly/source/css/_layout/third-party.styl","hash":"8314e9749eb1ae40c4bae9735b7a6638b2d6876a","modified":1658809870000},{"_id":"themes/butterfly/source/css/_mode/darkmode.styl","hash":"a92984f566c97bb4179f34be79240af1552c6f17","modified":1658809870000},{"_id":"themes/butterfly/source/css/_mode/readmode.styl","hash":"69f8e9414526dfda3af9a71c8e528fdd0ecbbfe5","modified":1658809870000},{"_id":"themes/butterfly/source/css/_page/404.styl","hash":"50dbb9e6d98c71ffe16741b8c1b0c1b9771efd2b","modified":1658809870000},{"_id":"themes/butterfly/source/css/_page/archives.styl","hash":"6f4b4ede52305bce9b22c8c897dcbde8af6e2ce4","modified":1658809870000},{"_id":"themes/butterfly/source/css/_page/categories.styl","hash":"f01ee74948cedb44e53cd3bb1ef36b7d2778ede7","modified":1658809870000},{"_id":"themes/butterfly/source/css/_page/common.styl","hash":"a58d35d698885f1034dedbe99f7dbc1a801412c6","modified":1658809870000},{"_id":"themes/butterfly/source/css/_page/flink.styl","hash":"98d755b686ee833e9da10afaa40c4ec2bd66c19a","modified":1658809870000},{"_id":"themes/butterfly/source/css/_page/homepage.styl","hash":"8c90483d461e09cb06e91b16d8bb7b3205b0a40c","modified":1658809870000},{"_id":"themes/butterfly/source/css/_page/tags.styl","hash":"580feb7e8b0822a1be48ac380f8c5c53b1523321","modified":1658809870000},{"_id":"themes/butterfly/source/css/_search/algolia.styl","hash":"51e45625929d57c9df3ba9090af99b9b7bb9a15b","modified":1658809870000},{"_id":"themes/butterfly/source/css/_search/index.styl","hash":"39d61cbe0c1e937f83ba3b147afaa29b4de2f87d","modified":1658809870000},{"_id":"themes/butterfly/source/css/_search/local-search.styl","hash":"25e58a7a8bda4b73d0a0e551643ca01b09ccd7e5","modified":1658809870000},{"_id":"themes/butterfly/source/css/_tags/button.styl","hash":"45f0c32bdea117540f6b14ebac6450d7142bd710","modified":1658809870000},{"_id":"themes/butterfly/source/css/_tags/gallery.styl","hash":"a310e48f826a4cacc55d8e68f43806e5085554f6","modified":1658809870000},{"_id":"themes/butterfly/source/css/_tags/hexo.styl","hash":"d76c38adf1d9c1279ef4241835667789f5b736e0","modified":1658809870000},{"_id":"themes/butterfly/source/css/_tags/hide.styl","hash":"ce489ca2e249e2a3cf71584e20d84bdb022e3475","modified":1658809870000},{"_id":"themes/butterfly/source/css/_tags/inlineImg.styl","hash":"df9d405c33a9a68946b530410f64096bcb72560c","modified":1658809870000},{"_id":"themes/butterfly/source/css/_tags/label.styl","hash":"66c59e193d794cdb02cca7bd1dc4aea5a19d7e84","modified":1658809870000},{"_id":"themes/butterfly/source/css/_tags/note.styl","hash":"85ae91c83691ea4511f4277da1194a185251cc78","modified":1658809870000},{"_id":"themes/butterfly/source/css/_tags/tabs.styl","hash":"bf9568444dd54e39dc59b461323dcd38942f27d9","modified":1658809870000},{"_id":"themes/butterfly/source/css/_tags/timeline.styl","hash":"f071156d439556e7463ed4bc61ceee87170d5d08","modified":1658809870000},{"_id":"themes/butterfly/source/css/_third-party/normalize.min.css","hash":"2c18a1c9604af475b4749def8f1959df88d8b276","modified":1658809870000},{"_id":"themes/butterfly/source/js/search/algolia.js","hash":"9feb248552667c53ce1b19bc7a295215f8c77008","modified":1658809870000},{"_id":"themes/butterfly/source/js/search/local-search.js","hash":"3071a4208fdf89ad7e0031536dd6ffa7bc951e4d","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/fb.pug","hash":"7848ec58c6ec03243abf80a3b22b4dc10f3edf53","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/index.pug","hash":"2be601477e1b81eee90a00c14ce5c8761d19a332","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/head/Open_Graph.pug","hash":"6c41f49a3e682067533dd9384e6e4511fc3a1349","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/disqus.pug","hash":"d85c3737b5c9548553a78b757a7698df126a52cf","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/remark42.pug","hash":"001e8be47854b891efe04013c240c38fed4185eb","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/valine.pug","hash":"39427e107230a10790972349c9dd4c4f31d55eb7","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/twikoo.pug","hash":"58406a7a3bf45815769f652bf3ef81e57dcd07eb","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/chat/chatra.pug","hash":"481cd5053bafb1a19f623554a27d3aa077ea59c3","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/waline.pug","hash":"5f648086a33a32d169a2f8d8c549c08aa02f67db","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/chat/crisp.pug","hash":"76634112c64023177260d1317ae39cef2a68e35f","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/chat/gitter.pug","hash":"d1d2474420bf4edc2e43ccdff6f92b8b082143df","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/chat/index.pug","hash":"3f05f8311ae559d768ee3d0925e84ed767c314d3","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/chat/tidio.pug","hash":"24a926756c2300b9c561aaab6bd3a71fdd16e16d","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/chat/daovoice.pug","hash":"cfe63e7d26a6665df6aa32ca90868ad48e05ec04","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/comments/disqusjs.pug","hash":"98ef20f8a3b10c1692f9b2b3c06033d2da8a8eae","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/comments/facebook_comments.pug","hash":"2d8fc3fb8f9aec61400acf3c94070bd8539058f8","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/comments/giscus.pug","hash":"591ef23c583690bd74af0cafb09af64ba5bd8151","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/comments/gitalk.pug","hash":"22e2ef30fe5eb1db7566e89943c74ece029b2a8e","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/comments/index.pug","hash":"2e26af16d359ba362fa611575d7f547848057c0c","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/comments/js.pug","hash":"190b1cca42c7f73c50f62f07d0751449941bff3f","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/comments/livere.pug","hash":"52ea8aa26b84d3ad38ae28cdf0f163e9ca8dced7","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/comments/disqus.pug","hash":"8ec24c1939895ac0db2b2e8700bc9307b4ceb53c","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/comments/remark42.pug","hash":"e9bdf80d6796afc04eb809dbbe780d97f22c7fcd","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/comments/valine.pug","hash":"e55b9c0f8ced231f47eb88bd7f4ec99f29c5c29d","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/comments/waline.pug","hash":"15462d1ed04651ad3b430c682842ac400f6f9b47","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/comments/twikoo.pug","hash":"e18fbd88d8942e53e771f29b26209ab735c5c567","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/math/katex.pug","hash":"dfcbd9881be569ea420eff1a6b00e4f4dbe2138e","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/math/mathjax.pug","hash":"f4dc7d02c8192979404ae9e134c5048d3d0a76e2","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/math/mermaid.pug","hash":"8e33aca36a4d3ae9e041ba05ced8eff56ae38f77","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/disqus-comment.pug","hash":"04b2a5882e789a988e41d45abe606f0617b08e38","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/comments/utterances.pug","hash":"a737046e730eb7264606ba0536218964044492f9","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/github-issues.pug","hash":"e846ddfe4a63b15d1416f6055f5756af5e3da7c6","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/index.pug","hash":"8ca02f97bfa93fff9cce5b8eb8feb234e7beeb98","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/math/index.pug","hash":"b8ae5fd7d74e1edcef21f5004fc96147e064d219","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/remark42.pug","hash":"ab167c00da4506f591b96f0591bf5bd214a26d4b","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/twikoo-comment.pug","hash":"233907dd7f5b5f33412701d2ccffbc0bbae8707b","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/waline.pug","hash":"dd0bc119029b62dce5dc965d5de7377e438fa29a","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/valine.pug","hash":"d19e1c2c0a50f0e4547d71a17b9be88e8152f17c","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/search/algolia.pug","hash":"e8245d0b4933129bb1c485d8de11a9e52e676348","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/search/index.pug","hash":"da3b9437d061ee68dbc383057db5c73034c49605","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/search/local-search.pug","hash":"178c9cdcc4ce5a006885b24ce4a3d624e4734899","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/share/add-this.pug","hash":"2980f1889226ca981aa23b8eb1853fde26dcf89a","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/share/addtoany.pug","hash":"85c92f8a7e44d7cd1c86f089a05be438535e5362","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/share/index.pug","hash":"4c4a9c15215ae8ac5eadb0e086b278f76db9ee92","modified":1658809870000},{"_id":"themes/butterfly/layout/includes/third-party/share/share-js.pug","hash":"f61d63724ea5c5f352568b3a16bde023affefbe5","modified":1658809870000},{"_id":"themes/butterfly/source/css/_highlight/highlight/diff.styl","hash":"cf1fae641c927621a4df1be5ca4a853b9b526e23","modified":1658809870000},{"_id":"themes/butterfly/source/css/_highlight/highlight/index.styl","hash":"18804c58239d95798fa86d0597f32d7f7dd30051","modified":1658809870000},{"_id":"themes/butterfly/source/css/_highlight/prismjs/index.styl","hash":"5dc2e0bcae9a54bfb9bdcc82d02ae5a3cf1ca97d","modified":1658809870000},{"_id":"themes/butterfly/source/css/_highlight/prismjs/diff.styl","hash":"5972c61f5125068cbe0af279a0c93a54847fdc3b","modified":1658809870000},{"_id":"themes/butterfly/source/css/_highlight/prismjs/line-number.styl","hash":"8970cc1916c982b64a1478792b2822d1d31e276d","modified":1658809870000},{"_id":"public/categories/index.html","hash":"44360cf4d1b5c89e5318856327082aacf820e44f","modified":1665716323274},{"_id":"public/link/index.html","hash":"4d05c03e89262516570672684d3762a26442d15c","modified":1665716323274},{"_id":"public/archives/index.html","hash":"056a90d951eb2109a0c2abfc3e949eedbd067697","modified":1665716323274},{"_id":"public/about/index.html","hash":"f1042c3082412d5781d2c21da4ce60eb4efe4118","modified":1665716323274},{"_id":"public/music/index.html","hash":"1e046d9e226c911e0c433eb4054999d1c93c22ea","modified":1665716323274},{"_id":"public/tags/index.html","hash":"0a149ac875fe58df75d49bdf0720e4d0546e37af","modified":1665716323274},{"_id":"public/messageboard/index.html","hash":"2850ce517287f64b8c6e02a7820823d4d9317f89","modified":1665716323274},{"_id":"public/2022/10/12/前端笔试/错题集/index.html","hash":"43504cd507e6a441fbe7c1ad5960f78668b433b3","modified":1665716323274},{"_id":"public/2022/08/28/html5/生成任意文件/index.html","hash":"3b3f3630a8d0908997cbb5e4f92ab64c52b1dc66","modified":1665544183818},{"_id":"public/2022/08/01/skill/js时间操作的应用/index.html","hash":"e07937ac00d10126d8eef61a2fe90622ba536d61","modified":1665544183818},{"_id":"public/2022/07/31/css/css弹窗动画/index.html","hash":"df598d29ab2dbf2d855a3cadbcf0bc923187120b","modified":1665544183818},{"_id":"public/2022/07/31/html5/实现全屏功能/index.html","hash":"8e0c7587023c00793619d842e3ac41386d0aabd5","modified":1665544183818},{"_id":"public/2022/07/29/vite/初识vite插件/index.html","hash":"dac409a6438a2f5165c696103e56ef3a3a1ac898","modified":1665544183818},{"_id":"public/2022/07/29/vite/手写一个vite-mock-plugin/index.html","hash":"bfd2c98474ccea1937034a9ffcbcd1d9aade561e","modified":1665544183818},{"_id":"public/2022/07/28/javascript/js实现拖拽/index.html","hash":"c3441bd00ec4ec44e3a0b47fba53b53d7e03f57f","modified":1665544183818},{"_id":"public/2022/07/28/docker/docker基础学习/index.html","hash":"4975ce73b0205d3d2e78b42dbc4873c41d790e9e","modified":1665544183818},{"_id":"public/2022/07/27/react/学习react-dnd/index.html","hash":"59c9e628b2f1d59975de12cfa643b3a3c8041930","modified":1665544183818},{"_id":"public/2022/07/27/skill/一行代码的JavaScript/index.html","hash":"3296b4c38f585c9bb2b2309322c2b942dd6ad926","modified":1665544183818},{"_id":"public/2022/07/27/vue/在Vue中使用keep-alive/index.html","hash":"64bb42a343dbfa9c0e5ea1655b1d9e35e6104dd0","modified":1665544183818},{"_id":"public/2022/07/26/vite/vite中用@别名/index.html","hash":"867979f34a3ea1380ca1c2f9d63b77637114c3fb","modified":1665544183818},{"_id":"public/archives/page/2/index.html","hash":"54b421a38d9a62e296c1e4e4be44ecb06e092300","modified":1665716323274},{"_id":"public/archives/2022/index.html","hash":"aefb6aaca97b8d053e4d4684d4d5c73adb7d10d8","modified":1665716323274},{"_id":"public/archives/2022/page/2/index.html","hash":"75959548a4e383c40e68198af083d1fbf32e8574","modified":1665716323274},{"_id":"public/archives/2022/07/index.html","hash":"7dcb3e029a9d44c114f846092e66cc6f31a4d4fc","modified":1665716323274},{"_id":"public/archives/2022/08/index.html","hash":"4aa2a7c2c1492de21a23ab59aa7ab211282ded6b","modified":1665716323274},{"_id":"public/archives/2022/10/index.html","hash":"fd9b151f92f8f180d5c67788249ae82c20890ce7","modified":1665716323274},{"_id":"public/categories/css/index.html","hash":"f77cb8616461dbecbb653e8f0d6f4570d7e39c3c","modified":1665716323274},{"_id":"public/categories/JavaScript/index.html","hash":"b289333349b9da92d8843995af0724caf8ce827d","modified":1665716323274},{"_id":"public/categories/html/index.html","hash":"e11b43234cdd5627d29c1effd41f505a15f083e8","modified":1665716323274},{"_id":"public/categories/react/index.html","hash":"649b8ed5dffa6e1bd218235620adeef9d793c4c7","modified":1665716323274},{"_id":"public/categories/JavaScript/demo/index.html","hash":"61465e820b18f197a24170560ceb3ba4f843d57a","modified":1665716323274},{"_id":"public/categories/Vue3/index.html","hash":"0245036ac305ae1412b57b57c912b16db8fdd997","modified":1665716323274},{"_id":"public/categories/前端工程化/index.html","hash":"efe97d743c56dfc1a10d92db70daf11351664522","modified":1665716323274},{"_id":"public/categories/Vue/index.html","hash":"188ce72c09bad7162075311bebe77ff584f5e62e","modified":1665716323274},{"_id":"public/categories/前端笔试/index.html","hash":"722d38ff2b96a03361880c520ca32a4d771f5811","modified":1665716323274},{"_id":"public/categories/docker/index.html","hash":"b0ad13f59043b311acb8fcd5aec942b7fb8a3f5e","modified":1665716323274},{"_id":"public/index.html","hash":"448de3d529e08a430f643b8af29d9757e5f2e8c7","modified":1665716323274},{"_id":"public/page/2/index.html","hash":"c27262f92ff06651203a93989f1ea666dfa6aeb5","modified":1665716323274},{"_id":"public/tags/前端/index.html","hash":"7ab73861be9da21b4c5435d4bcdf7d90191d0459","modified":1665716323274},{"_id":"public/tags/JavaScript/index.html","hash":"d29316478ca3e8b5b66602cf489c28275c4aa2d6","modified":1665716323274},{"_id":"public/tags/react-dnd/index.html","hash":"1c5f749a55ffdfe7b1daa45fbfcbb1d4a66a6d7f","modified":1665716323274},{"_id":"public/tags/skill/index.html","hash":"9347985e62a5567ff745f1b628b7180bc59ea430","modified":1665716323274},{"_id":"public/tags/项目/index.html","hash":"ebe1643605829bcabf71291ce535e71aef22ea99","modified":1665716323274},{"_id":"public/tags/Vue/index.html","hash":"144a8c1a72f32e0d25ab7ce40cf96bdf7a3be82d","modified":1665716323274},{"_id":"public/tags/vite/index.html","hash":"4d3538a24d2dd35cef97fb63756708dd4170a907","modified":1665716323274},{"_id":"public/tags/前端性能优化/index.html","hash":"f8ea1de5c4242f1246348ff17137100624c9f40f","modified":1665716323274},{"_id":"public/tags/错题集/index.html","hash":"08d0d118d51326f0b97a82886baf35881a53c45e","modified":1665716323274},{"_id":"public/tags/运维/index.html","hash":"8054bd2aa262d1be21bdb2191ee403f84d281970","modified":1665716323274},{"_id":"public/img/404.jpg","hash":"fb4489bc1d30c93d28f7332158c1c6c1416148de","modified":1665544183818},{"_id":"public/img/favicon.png","hash":"3cf89864b4f6c9b532522a4d260a2e887971c92d","modified":1665544183818},{"_id":"public/assets/js/Meting.min.js","hash":"a0585220b918d78649a7893279e1ec4fb5abe835","modified":1665544183818},{"_id":"public/assets/css/APlayer.min.css","hash":"07372a2ba507388d0fed166d761b1c2c2a659dce","modified":1665544183818},{"_id":"public/assets/js/APlayer.min.js","hash":"22caa28ff6b41a16ff40f15d38f1739e22359478","modified":1665544183818},{"_id":"public/img/friend_404.gif","hash":"8d2d0ebef70a8eb07329f57e645889b0e420fa48","modified":1665544183818},{"_id":"public/css/index.css","hash":"0dfe2a45b1a5be019c71398ef7e0e6ae38ef9ade","modified":1665544183818},{"_id":"public/css/var.css","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1665544183818},{"_id":"public/js/utils.js","hash":"0b95daada72abb5d64a1e3236049a60120e47cca","modified":1665544183818},{"_id":"public/js/search/algolia.js","hash":"9feb248552667c53ce1b19bc7a295215f8c77008","modified":1665544183818},{"_id":"public/js/search/local-search.js","hash":"3071a4208fdf89ad7e0031536dd6ffa7bc951e4d","modified":1665544183818},{"_id":"public/js/main.js","hash":"73d2624ed465e4cfb1ebb00b2c8a24f5fc29bb21","modified":1665544183818},{"_id":"public/js/tw_cn.js","hash":"00053ce73210274b3679f42607edef1206eebc68","modified":1665544183818}],"Category":[{"name":"css","_id":"cl95206c100043no20m9r0iqw"},{"name":"JavaScript","_id":"cl95206c8000c3no20708d6yy"},{"name":"html","_id":"cl95206ch000m3no2f4ftb0ej"},{"name":"react","_id":"cl95206cn000y3no2f4di7nww"},{"name":"demo","parent":"cl95206c8000c3no20708d6yy","_id":"cl95206cr00153no25rab2zqv"},{"name":"Vue3","_id":"cl95206ct001a3no255ux3ft5"},{"name":"前端工程化","_id":"cl95206cu001d3no25k4p6w98"},{"name":"Vue","_id":"cl95206cy001m3no23bpc0hpv"},{"name":"前端笔试","_id":"cl95206cz001t3no28slz9dem"},{"name":"docker","_id":"cl95206d0001w3no28quaap2z"}],"Data":[],"Page":[{"title":"categories","date":"2022-07-27T07:48:34.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2022-07-27 15:48:34\ntype: categories\n---\n","updated":"2022-10-12T02:50:25.547Z","path":"categories/index.html","comments":1,"layout":"page","_id":"cl95206bm00003no21mgmgsl2","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script>","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"","more":""},{"title":"link","date":"2022-07-26T04:58:07.000Z","type":"link","_content":"","source":"link/index.md","raw":"---\ntitle: link\ndate: 2022-07-26 12:58:07\ntype: link\n---\n","updated":"2022-10-12T02:50:25.547Z","path":"link/index.html","comments":1,"layout":"page","_id":"cl95206by00023no24hd91ten","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script>","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"","more":""},{"title":"archives","date":"2022-07-27T07:48:19.000Z","type":"archives","_content":"","source":"archives/index.md","raw":"---\ntitle: archives\ndate: 2022-07-27 15:48:19\ntype: archives\n---\n","updated":"2022-10-12T02:50:25.547Z","path":"archives/index.html","comments":1,"layout":"page","_id":"cl95206c300063no2dy16b4to","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script>","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"","more":""},{"title":"about","date":"2022-07-26T04:58:18.000Z","type":"about","top_img":"https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/banner/about.jpg","_content":"<!-- https://www.bootcdn.cn/botui/ -->\n<link href=\"https://cdn.bootcss.com/botui/0.3.9/botui-theme-default.css\" rel=\"stylesheet\">\n<link href=\"https://cdn.bootcss.com/botui/0.3.9/botui.min.css\" rel=\"stylesheet\">\n\n{% raw %}\n<!-- 因为vue和botui更新导至bug,现将对话移至js下的botui中配置 -->\n<div class=\"entry-content\">\n  <div class=\"moe-mashiro\" style=\"text-align:center; font-size: 50px; margin-bottom: 20px;\">[影风の小屋]</div>\n  <div id=\"hello-mashiro\" class=\"popcontainer\" style=\"min-height: 300px; padding: 2px 6px 4px; background-color: rgb(36, 200, 255); border-radius: 10px;\">\n    <center>\n    <p>\n    </p>\n    <h4>\n    与&nbsp;<ruby>\n    cungudafa&nbsp;<rp>\n    （</rp>\n    <rt>\n    真（ま）白（しろ）</rt>\n    <rp>\n    ）</rp>\n    </ruby>\n    对话中...</h4>\n    <p>\n    </p>\n    </center>\n    <bot-ui></botui>\n  </div>\n</div>\n<!--<script src=\"https://cungudafa.gitee.io/js/botui.js></script>-->\n<script src=\"/js/third-party/botui.js\"></script>\n<script>\nbot_ui_ini()\n</script>\n{% endraw %}\n","source":"about/index.md","raw":"---\ntitle: about\ndate: 2022-07-26 12:58:18\ntype: about\ntop_img: https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/banner/about.jpg\n---\n<!-- https://www.bootcdn.cn/botui/ -->\n<link href=\"https://cdn.bootcss.com/botui/0.3.9/botui-theme-default.css\" rel=\"stylesheet\">\n<link href=\"https://cdn.bootcss.com/botui/0.3.9/botui.min.css\" rel=\"stylesheet\">\n\n{% raw %}\n<!-- 因为vue和botui更新导至bug,现将对话移至js下的botui中配置 -->\n<div class=\"entry-content\">\n  <div class=\"moe-mashiro\" style=\"text-align:center; font-size: 50px; margin-bottom: 20px;\">[影风の小屋]</div>\n  <div id=\"hello-mashiro\" class=\"popcontainer\" style=\"min-height: 300px; padding: 2px 6px 4px; background-color: rgb(36, 200, 255); border-radius: 10px;\">\n    <center>\n    <p>\n    </p>\n    <h4>\n    与&nbsp;<ruby>\n    cungudafa&nbsp;<rp>\n    （</rp>\n    <rt>\n    真（ま）白（しろ）</rt>\n    <rp>\n    ）</rp>\n    </ruby>\n    对话中...</h4>\n    <p>\n    </p>\n    </center>\n    <bot-ui></botui>\n  </div>\n</div>\n<!--<script src=\"https://cungudafa.gitee.io/js/botui.js></script>-->\n<script src=\"/js/third-party/botui.js\"></script>\n<script>\nbot_ui_ini()\n</script>\n{% endraw %}\n","updated":"2022-10-12T02:50:25.546Z","path":"about/index.html","comments":1,"layout":"page","_id":"cl95206c500083no27a8p1ytg","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><!-- https://www.bootcdn.cn/botui/ -->\n<link href=\"https://cdn.bootcss.com/botui/0.3.9/botui-theme-default.css\" rel=\"stylesheet\">\n<link href=\"https://cdn.bootcss.com/botui/0.3.9/botui.min.css\" rel=\"stylesheet\">\n\n\n<!-- 因为vue和botui更新导至bug,现将对话移至js下的botui中配置 -->\n<div class=\"entry-content\">\n  <div class=\"moe-mashiro\" style=\"text-align:center; font-size: 50px; margin-bottom: 20px;\">[影风の小屋]</div>\n  <div id=\"hello-mashiro\" class=\"popcontainer\" style=\"min-height: 300px; padding: 2px 6px 4px; background-color: rgb(36, 200, 255); border-radius: 10px;\">\n    <center>\n    <p>\n    </p>\n    <h4>\n    与&nbsp;<ruby>\n    cungudafa&nbsp;<rp>\n    （</rp>\n    <rt>\n    真（ま）白（しろ）</rt>\n    <rp>\n    ）</rp>\n    </ruby>\n    对话中...</h4>\n    <p>\n    </p>\n    </center>\n    <bot-ui></botui>\n  </div>\n</div>\n<!--<script src=\"https://cungudafa.gitee.io/js/botui.js></script>-->\n<script src=\"/js/third-party/botui.js\"></script>\n<script>\nbot_ui_ini()\n</script>\n\n","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"","more":"<!-- https://www.bootcdn.cn/botui/ -->\n<link href=\"https://cdn.bootcss.com/botui/0.3.9/botui-theme-default.css\" rel=\"stylesheet\">\n<link href=\"https://cdn.bootcss.com/botui/0.3.9/botui.min.css\" rel=\"stylesheet\">\n\n\n<!-- 因为vue和botui更新导至bug,现将对话移至js下的botui中配置 -->\n<div class=\"entry-content\">\n  <div class=\"moe-mashiro\" style=\"text-align:center; font-size: 50px; margin-bottom: 20px;\">[影风の小屋]</div>\n  <div id=\"hello-mashiro\" class=\"popcontainer\" style=\"min-height: 300px; padding: 2px 6px 4px; background-color: rgb(36, 200, 255); border-radius: 10px;\">\n    <center>\n    <p>\n    </p>\n    <h4>\n    与&nbsp;<ruby>\n    cungudafa&nbsp;<rp>\n    （</rp>\n    <rt>\n    真（ま）白（しろ）</rt>\n    <rp>\n    ）</rp>\n    </ruby>\n    对话中...</h4>\n    <p>\n    </p>\n    </center>\n    <bot-ui></botui>\n  </div>\n</div>\n<!--<script src=\"https://cungudafa.gitee.io/js/botui.js></script>-->\n<script src=\"/js/third-party/botui.js\"></script>\n<script>\nbot_ui_ini()\n</script>\n\n"},{"title":"music","date":"2022-07-26T04:57:56.000Z","type":"music","_content":"\n\n\n\n\n\n\n","source":"music/index.md","raw":"---\ntitle: music\ndate: 2022-07-26 12:57:56\ntype: music\n---\n\n\n\n\n\n\n\n","updated":"2022-10-12T02:50:25.548Z","path":"music/index.html","comments":1,"layout":"page","_id":"cl95206c7000a3no2gm1k6k4u","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script>","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"","more":""},{"title":"Tags","date":"2022-07-26T04:52:28.000Z","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: Tags\ndate: 2022-07-26 12:52:28\ntype: tags\n---\n","updated":"2022-10-12T02:50:25.548Z","path":"tags/index.html","comments":1,"layout":"page","_id":"cl95206cb000f3no29cdfdr00","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script>","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"","more":""},{"title":"messageboard","date":"2022-07-26T05:03:51.000Z","type":"messageboard","_content":"","source":"messageboard/index.md","raw":"---\ntitle: messageboard\ndate: 2022-07-26 13:03:51\ntype: messageboard\n---\n","updated":"2022-10-12T02:50:25.547Z","path":"messageboard/index.html","comments":1,"layout":"page","_id":"cl95206cf000i3no27rhg4uxu","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script>","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"","more":""}],"Post":[{"title":"css弹窗动画","description":"css弹窗动画","date":"2022-07-30T16:00:00.000Z","cover":"https://urlify.cn/7fyyae","_content":"\n# css弹窗动画\n\n### 前言\n\n项目地址：[地址](https://github.com/kangkang123269/kate-demo/tree/main/css/css-animation-demo)\n\n### js操作css类\n\n1. 添加类名\n\n~~~js\ndocument.getElementById(\"myDiv\").classList.add('mystyle');\n~~~\n\n2. 删除类名\n\n~~~js\ndocument.getElementById(\"myDiv\").classList.remove('mystyle');\n~~~\n\n3. 检查是否含有某个css类：\n\n~~~js\nmyDiv.classList.contains('myCssClass');\n~~~\n\n> 注意：`document.querySelector('class').classList`是静态获取类名，不能操作类名\n\n\n### 导入css\n\n~~~css\n@import url('./fadeIn.css');\n@import url('./fadeleftIn.css');\n@import url('./fadelogIn.css');\n@import url('./popIn.css');\n~~~\n\n### 弹窗动画\n\n- 从上往下：\n\n~~~css\n.fadeIn {\n    -webkit-animation: fadeInDown .3s;\n    animation: fadeInDown .3s;\n}\n@keyframes fadeInDown {\n    0% {\n        -webkit-transform: translate3d(0, -20%, 0);\n        -webkit-transform: translate3d(0, -20%, 0);\n        transform: translate3d(0, -20%, 0);\n        transform: translate3d(0, -20%, 0);\n        opacity: 0;\n    }\n    100% {\n        -webkit-transform: none;\n        transform: none;\n        opacity: 1;\n    }\n}\n@-webkit-keyframes fadeInDown {\n    0% {\n        -webkit-transform: translate3d(0, -20%, 0);\n        opacity: 0;\n    }\n    100% {\n        -webkit-transform: none;\n        opacity: 1;\n    }\n}\n~~~\n\n- 从右往左：\n\n~~~css\n.fadelogIn {\n    -webkit-animation: fadelogIn .4s;\n    animation: fadelogIn .4s;\n}\n@keyframes fadelogIn {\n    0% {\n        -webkit-transform: translate3d(0, 100%, 0);\n        -webkit-transform: translate3d(0, 100%, 0);\n        transform: translate3d(0, 100%, 0);\n        transform: translate3d(0, 100%, 0);\n    }\n    100% {\n        -webkit-transform: none;\n        transform: none;\n    }\n}\n@-webkit-keyframes fadelogIn {\n    0% {\n        -webkit-transform: translate3d(0, 100%, 0);\n    }\n    100% {\n        -webkit-transform: none;\n    }\n}\n\n~~~\n\n- 从右往左：\n\n~~~css\n.fadeleftIn {\n    -webkit-animation: fadeleftIn .4s;\n    animation: fadeleftIn .4s;\n}\n@keyframes fadeleftIn {\n    0% {\n        -webkit-transform: translate3d(100%, 0, 0);\n        -webkit-transform: translate3d(100%, 0, 0);\n        transform: translate3d(100%, 0, 0);\n        transform: translate3d(100%, 0, 0);\n    }\n    100% {\n        -webkit-transform: none;\n        transform: none;\n    }\n}\n@-webkit-keyframes fadeleftIn {\n    0% {\n        -webkit-transform: translate3d(100%, 0, 0);\n    }\n    100% {\n        -webkit-transform: none;\n    }\n}\n~~~\n\n- 放大：\n\n~~~css\n.popIn {\n    -webkit-animation: fadeleftIn .4s;\n    animation: fadeleftIn .4s;\n    -webkit-animation-name: popIn;\n    animation-name: popIn;\n}\n@-webkit-keyframes popIn {\n    0% {\n        -webkit-transform: scale3d(0, 0, 0);\n        transform: scale3d(0.5, 0.5, 0.5);\n        opacity: 0;\n    }\n    50% {\n        -webkit-animation-timing-function: cubic-bezier(0.47, 0, 0.745, 0.715);\n        animation-timing-function: cubic-bezier(0.47, 0, 0.745, 0.715);\n    }\n    100% {\n        -webkit-transform: scale3d(1, 1, 1);\n        transform: scale3d(1, 1, 1);\n        -webkit-animation-timing-function: cubic-bezier(0.25, 0.46, 0.45, 0.94);\n        animation-timing-function: cubic-bezier(0.25, 0.46, 0.45, 0.94);\n        opacity: 1;\n    }\n}\n@keyframes popIn {\n    0% {\n        -webkit-transform: scale3d(0, 0, 0);\n        transform: scale3d(0.5, 0.5, 0.5);\n        opacity: 0;\n    }\n    50% {\n        -webkit-animation-timing-function: cubic-bezier(0.47, 0, 0.745, 0.715);\n        animation-timing-function: cubic-bezier(0.47, 0, 0.745, 0.715);\n    }\n    100% {\n        -webkit-transform: scale3d(1, 1, 1);\n        transform: scale3d(1, 1, 1);\n        -webkit-animation-timing-function: cubic-bezier(0.25, 0.46, 0.45, 0.94);\n        animation-timing-function: cubic-bezier(0.25, 0.46, 0.45, 0.94);\n        opacity: 1;\n    }\n}\n~~~","source":"_posts/css/css弹窗动画.md","raw":"---\ntitle: css弹窗动画\ntags: [前端]\ncategories: [css]\ndescription: css弹窗动画\ndate: 2022-07-31\ncover: https://urlify.cn/7fyyae\n---\n\n# css弹窗动画\n\n### 前言\n\n项目地址：[地址](https://github.com/kangkang123269/kate-demo/tree/main/css/css-animation-demo)\n\n### js操作css类\n\n1. 添加类名\n\n~~~js\ndocument.getElementById(\"myDiv\").classList.add('mystyle');\n~~~\n\n2. 删除类名\n\n~~~js\ndocument.getElementById(\"myDiv\").classList.remove('mystyle');\n~~~\n\n3. 检查是否含有某个css类：\n\n~~~js\nmyDiv.classList.contains('myCssClass');\n~~~\n\n> 注意：`document.querySelector('class').classList`是静态获取类名，不能操作类名\n\n\n### 导入css\n\n~~~css\n@import url('./fadeIn.css');\n@import url('./fadeleftIn.css');\n@import url('./fadelogIn.css');\n@import url('./popIn.css');\n~~~\n\n### 弹窗动画\n\n- 从上往下：\n\n~~~css\n.fadeIn {\n    -webkit-animation: fadeInDown .3s;\n    animation: fadeInDown .3s;\n}\n@keyframes fadeInDown {\n    0% {\n        -webkit-transform: translate3d(0, -20%, 0);\n        -webkit-transform: translate3d(0, -20%, 0);\n        transform: translate3d(0, -20%, 0);\n        transform: translate3d(0, -20%, 0);\n        opacity: 0;\n    }\n    100% {\n        -webkit-transform: none;\n        transform: none;\n        opacity: 1;\n    }\n}\n@-webkit-keyframes fadeInDown {\n    0% {\n        -webkit-transform: translate3d(0, -20%, 0);\n        opacity: 0;\n    }\n    100% {\n        -webkit-transform: none;\n        opacity: 1;\n    }\n}\n~~~\n\n- 从右往左：\n\n~~~css\n.fadelogIn {\n    -webkit-animation: fadelogIn .4s;\n    animation: fadelogIn .4s;\n}\n@keyframes fadelogIn {\n    0% {\n        -webkit-transform: translate3d(0, 100%, 0);\n        -webkit-transform: translate3d(0, 100%, 0);\n        transform: translate3d(0, 100%, 0);\n        transform: translate3d(0, 100%, 0);\n    }\n    100% {\n        -webkit-transform: none;\n        transform: none;\n    }\n}\n@-webkit-keyframes fadelogIn {\n    0% {\n        -webkit-transform: translate3d(0, 100%, 0);\n    }\n    100% {\n        -webkit-transform: none;\n    }\n}\n\n~~~\n\n- 从右往左：\n\n~~~css\n.fadeleftIn {\n    -webkit-animation: fadeleftIn .4s;\n    animation: fadeleftIn .4s;\n}\n@keyframes fadeleftIn {\n    0% {\n        -webkit-transform: translate3d(100%, 0, 0);\n        -webkit-transform: translate3d(100%, 0, 0);\n        transform: translate3d(100%, 0, 0);\n        transform: translate3d(100%, 0, 0);\n    }\n    100% {\n        -webkit-transform: none;\n        transform: none;\n    }\n}\n@-webkit-keyframes fadeleftIn {\n    0% {\n        -webkit-transform: translate3d(100%, 0, 0);\n    }\n    100% {\n        -webkit-transform: none;\n    }\n}\n~~~\n\n- 放大：\n\n~~~css\n.popIn {\n    -webkit-animation: fadeleftIn .4s;\n    animation: fadeleftIn .4s;\n    -webkit-animation-name: popIn;\n    animation-name: popIn;\n}\n@-webkit-keyframes popIn {\n    0% {\n        -webkit-transform: scale3d(0, 0, 0);\n        transform: scale3d(0.5, 0.5, 0.5);\n        opacity: 0;\n    }\n    50% {\n        -webkit-animation-timing-function: cubic-bezier(0.47, 0, 0.745, 0.715);\n        animation-timing-function: cubic-bezier(0.47, 0, 0.745, 0.715);\n    }\n    100% {\n        -webkit-transform: scale3d(1, 1, 1);\n        transform: scale3d(1, 1, 1);\n        -webkit-animation-timing-function: cubic-bezier(0.25, 0.46, 0.45, 0.94);\n        animation-timing-function: cubic-bezier(0.25, 0.46, 0.45, 0.94);\n        opacity: 1;\n    }\n}\n@keyframes popIn {\n    0% {\n        -webkit-transform: scale3d(0, 0, 0);\n        transform: scale3d(0.5, 0.5, 0.5);\n        opacity: 0;\n    }\n    50% {\n        -webkit-animation-timing-function: cubic-bezier(0.47, 0, 0.745, 0.715);\n        animation-timing-function: cubic-bezier(0.47, 0, 0.745, 0.715);\n    }\n    100% {\n        -webkit-transform: scale3d(1, 1, 1);\n        transform: scale3d(1, 1, 1);\n        -webkit-animation-timing-function: cubic-bezier(0.25, 0.46, 0.45, 0.94);\n        animation-timing-function: cubic-bezier(0.25, 0.46, 0.45, 0.94);\n        opacity: 1;\n    }\n}\n~~~","slug":"css/css弹窗动画","published":1,"updated":"2022-10-12T02:50:25.543Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl95206bv00013no2cb5dboqb","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><h1 id=\"css弹窗动画\"><a href=\"#css弹窗动画\" class=\"headerlink\" title=\"css弹窗动画\"></a>css弹窗动画</h1><h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>项目地址：<a href=\"https://github.com/kangkang123269/kate-demo/tree/main/css/css-animation-demo\">地址</a></p>\n<h3 id=\"js操作css类\"><a href=\"#js操作css类\" class=\"headerlink\" title=\"js操作css类\"></a>js操作css类</h3><ol>\n<li>添加类名</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&quot;myDiv&quot;</span>).<span class=\"property\">classList</span>.<span class=\"title function_\">add</span>(<span class=\"string\">&#x27;mystyle&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>删除类名</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&quot;myDiv&quot;</span>).<span class=\"property\">classList</span>.<span class=\"title function_\">remove</span>(<span class=\"string\">&#x27;mystyle&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>检查是否含有某个css类：</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">myDiv.<span class=\"property\">classList</span>.<span class=\"title function_\">contains</span>(<span class=\"string\">&#x27;myCssClass&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>注意：<code>document.querySelector(&#39;class&#39;).classList</code>是静态获取类名，不能操作类名</p>\n</blockquote>\n<h3 id=\"导入css\"><a href=\"#导入css\" class=\"headerlink\" title=\"导入css\"></a>导入css</h3><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">@import</span> url(<span class=\"string\">&#x27;./fadeIn.css&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">@import</span> url(<span class=\"string\">&#x27;./fadeleftIn.css&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">@import</span> url(<span class=\"string\">&#x27;./fadelogIn.css&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">@import</span> url(<span class=\"string\">&#x27;./popIn.css&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"弹窗动画\"><a href=\"#弹窗动画\" class=\"headerlink\" title=\"弹窗动画\"></a>弹窗动画</h3><ul>\n<li>从上往下：</li>\n</ul>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.fadeIn</span> &#123;</span><br><span class=\"line\">    -webkit-<span class=\"attribute\">animation</span>: fadeInDown .<span class=\"number\">3s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">animation</span>: fadeInDown .<span class=\"number\">3s</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@keyframes</span> fadeInDown &#123;</span><br><span class=\"line\">    <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, -<span class=\"number\">20%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, -<span class=\"number\">20%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, -<span class=\"number\">20%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, -<span class=\"number\">20%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@-webkit-keyframes</span> fadeInDown &#123;</span><br><span class=\"line\">    <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, -<span class=\"number\">20%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>从右往左：</li>\n</ul>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.fadelogIn</span> &#123;</span><br><span class=\"line\">    -webkit-<span class=\"attribute\">animation</span>: fadelogIn .<span class=\"number\">4s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">animation</span>: fadelogIn .<span class=\"number\">4s</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@keyframes</span> fadelogIn &#123;</span><br><span class=\"line\">    <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, <span class=\"number\">100%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, <span class=\"number\">100%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, <span class=\"number\">100%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, <span class=\"number\">100%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@-webkit-keyframes</span> fadelogIn &#123;</span><br><span class=\"line\">    <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, <span class=\"number\">100%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>从右往左：</li>\n</ul>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.fadeleftIn</span> &#123;</span><br><span class=\"line\">    -webkit-<span class=\"attribute\">animation</span>: fadeleftIn .<span class=\"number\">4s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">animation</span>: fadeleftIn .<span class=\"number\">4s</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@keyframes</span> fadeleftIn &#123;</span><br><span class=\"line\">    <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">100%</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">100%</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">100%</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">100%</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@-webkit-keyframes</span> fadeleftIn &#123;</span><br><span class=\"line\">    <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">100%</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>放大：</li>\n</ul>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.popIn</span> &#123;</span><br><span class=\"line\">    -webkit-<span class=\"attribute\">animation</span>: fadeleftIn .<span class=\"number\">4s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">animation</span>: fadeleftIn .<span class=\"number\">4s</span>;</span><br><span class=\"line\">    -webkit-<span class=\"attribute\">animation-name</span>: popIn;</span><br><span class=\"line\">    <span class=\"attribute\">animation-name</span>: popIn;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@-webkit-keyframes</span> popIn &#123;</span><br><span class=\"line\">    <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">scale3d</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">scale3d</span>(<span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">50%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">animation-timing-function</span>: <span class=\"built_in\">cubic-bezier</span>(<span class=\"number\">0.47</span>, <span class=\"number\">0</span>, <span class=\"number\">0.745</span>, <span class=\"number\">0.715</span>);</span><br><span class=\"line\">        <span class=\"attribute\">animation-timing-function</span>: <span class=\"built_in\">cubic-bezier</span>(<span class=\"number\">0.47</span>, <span class=\"number\">0</span>, <span class=\"number\">0.745</span>, <span class=\"number\">0.715</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">scale3d</span>(<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">scale3d</span>(<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">animation-timing-function</span>: <span class=\"built_in\">cubic-bezier</span>(<span class=\"number\">0.25</span>, <span class=\"number\">0.46</span>, <span class=\"number\">0.45</span>, <span class=\"number\">0.94</span>);</span><br><span class=\"line\">        <span class=\"attribute\">animation-timing-function</span>: <span class=\"built_in\">cubic-bezier</span>(<span class=\"number\">0.25</span>, <span class=\"number\">0.46</span>, <span class=\"number\">0.45</span>, <span class=\"number\">0.94</span>);</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@keyframes</span> popIn &#123;</span><br><span class=\"line\">    <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">scale3d</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">scale3d</span>(<span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">50%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">animation-timing-function</span>: <span class=\"built_in\">cubic-bezier</span>(<span class=\"number\">0.47</span>, <span class=\"number\">0</span>, <span class=\"number\">0.745</span>, <span class=\"number\">0.715</span>);</span><br><span class=\"line\">        <span class=\"attribute\">animation-timing-function</span>: <span class=\"built_in\">cubic-bezier</span>(<span class=\"number\">0.47</span>, <span class=\"number\">0</span>, <span class=\"number\">0.745</span>, <span class=\"number\">0.715</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">scale3d</span>(<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">scale3d</span>(<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">animation-timing-function</span>: <span class=\"built_in\">cubic-bezier</span>(<span class=\"number\">0.25</span>, <span class=\"number\">0.46</span>, <span class=\"number\">0.45</span>, <span class=\"number\">0.94</span>);</span><br><span class=\"line\">        <span class=\"attribute\">animation-timing-function</span>: <span class=\"built_in\">cubic-bezier</span>(<span class=\"number\">0.25</span>, <span class=\"number\">0.46</span>, <span class=\"number\">0.45</span>, <span class=\"number\">0.94</span>);</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"css弹窗动画\"><a href=\"#css弹窗动画\" class=\"headerlink\" title=\"css弹窗动画\"></a>css弹窗动画</h1><h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>项目地址：<a href=\"https://github.com/kangkang123269/kate-demo/tree/main/css/css-animation-demo\">地址</a></p>\n<h3 id=\"js操作css类\"><a href=\"#js操作css类\" class=\"headerlink\" title=\"js操作css类\"></a>js操作css类</h3><ol>\n<li>添加类名</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&quot;myDiv&quot;</span>).<span class=\"property\">classList</span>.<span class=\"title function_\">add</span>(<span class=\"string\">&#x27;mystyle&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>删除类名</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&quot;myDiv&quot;</span>).<span class=\"property\">classList</span>.<span class=\"title function_\">remove</span>(<span class=\"string\">&#x27;mystyle&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>检查是否含有某个css类：</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">myDiv.<span class=\"property\">classList</span>.<span class=\"title function_\">contains</span>(<span class=\"string\">&#x27;myCssClass&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>注意：<code>document.querySelector(&#39;class&#39;).classList</code>是静态获取类名，不能操作类名</p>\n</blockquote>\n<h3 id=\"导入css\"><a href=\"#导入css\" class=\"headerlink\" title=\"导入css\"></a>导入css</h3><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">@import</span> url(<span class=\"string\">&#x27;./fadeIn.css&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">@import</span> url(<span class=\"string\">&#x27;./fadeleftIn.css&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">@import</span> url(<span class=\"string\">&#x27;./fadelogIn.css&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">@import</span> url(<span class=\"string\">&#x27;./popIn.css&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"弹窗动画\"><a href=\"#弹窗动画\" class=\"headerlink\" title=\"弹窗动画\"></a>弹窗动画</h3><ul>\n<li>从上往下：</li>\n</ul>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.fadeIn</span> &#123;</span><br><span class=\"line\">    -webkit-<span class=\"attribute\">animation</span>: fadeInDown .<span class=\"number\">3s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">animation</span>: fadeInDown .<span class=\"number\">3s</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@keyframes</span> fadeInDown &#123;</span><br><span class=\"line\">    <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, -<span class=\"number\">20%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, -<span class=\"number\">20%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, -<span class=\"number\">20%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, -<span class=\"number\">20%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@-webkit-keyframes</span> fadeInDown &#123;</span><br><span class=\"line\">    <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, -<span class=\"number\">20%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>从右往左：</li>\n</ul>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.fadelogIn</span> &#123;</span><br><span class=\"line\">    -webkit-<span class=\"attribute\">animation</span>: fadelogIn .<span class=\"number\">4s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">animation</span>: fadelogIn .<span class=\"number\">4s</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@keyframes</span> fadelogIn &#123;</span><br><span class=\"line\">    <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, <span class=\"number\">100%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, <span class=\"number\">100%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, <span class=\"number\">100%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, <span class=\"number\">100%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@-webkit-keyframes</span> fadelogIn &#123;</span><br><span class=\"line\">    <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">0</span>, <span class=\"number\">100%</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>从右往左：</li>\n</ul>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.fadeleftIn</span> &#123;</span><br><span class=\"line\">    -webkit-<span class=\"attribute\">animation</span>: fadeleftIn .<span class=\"number\">4s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">animation</span>: fadeleftIn .<span class=\"number\">4s</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@keyframes</span> fadeleftIn &#123;</span><br><span class=\"line\">    <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">100%</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">100%</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">100%</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">100%</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@-webkit-keyframes</span> fadeleftIn &#123;</span><br><span class=\"line\">    <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">translate3d</span>(<span class=\"number\">100%</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: none;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>放大：</li>\n</ul>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.popIn</span> &#123;</span><br><span class=\"line\">    -webkit-<span class=\"attribute\">animation</span>: fadeleftIn .<span class=\"number\">4s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">animation</span>: fadeleftIn .<span class=\"number\">4s</span>;</span><br><span class=\"line\">    -webkit-<span class=\"attribute\">animation-name</span>: popIn;</span><br><span class=\"line\">    <span class=\"attribute\">animation-name</span>: popIn;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@-webkit-keyframes</span> popIn &#123;</span><br><span class=\"line\">    <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">scale3d</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">scale3d</span>(<span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">50%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">animation-timing-function</span>: <span class=\"built_in\">cubic-bezier</span>(<span class=\"number\">0.47</span>, <span class=\"number\">0</span>, <span class=\"number\">0.745</span>, <span class=\"number\">0.715</span>);</span><br><span class=\"line\">        <span class=\"attribute\">animation-timing-function</span>: <span class=\"built_in\">cubic-bezier</span>(<span class=\"number\">0.47</span>, <span class=\"number\">0</span>, <span class=\"number\">0.745</span>, <span class=\"number\">0.715</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">scale3d</span>(<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">scale3d</span>(<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">animation-timing-function</span>: <span class=\"built_in\">cubic-bezier</span>(<span class=\"number\">0.25</span>, <span class=\"number\">0.46</span>, <span class=\"number\">0.45</span>, <span class=\"number\">0.94</span>);</span><br><span class=\"line\">        <span class=\"attribute\">animation-timing-function</span>: <span class=\"built_in\">cubic-bezier</span>(<span class=\"number\">0.25</span>, <span class=\"number\">0.46</span>, <span class=\"number\">0.45</span>, <span class=\"number\">0.94</span>);</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@keyframes</span> popIn &#123;</span><br><span class=\"line\">    <span class=\"number\">0%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">scale3d</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">scale3d</span>(<span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">50%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">animation-timing-function</span>: <span class=\"built_in\">cubic-bezier</span>(<span class=\"number\">0.47</span>, <span class=\"number\">0</span>, <span class=\"number\">0.745</span>, <span class=\"number\">0.715</span>);</span><br><span class=\"line\">        <span class=\"attribute\">animation-timing-function</span>: <span class=\"built_in\">cubic-bezier</span>(<span class=\"number\">0.47</span>, <span class=\"number\">0</span>, <span class=\"number\">0.745</span>, <span class=\"number\">0.715</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"number\">100%</span> &#123;</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">transform</span>: <span class=\"built_in\">scale3d</span>(<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"attribute\">transform</span>: <span class=\"built_in\">scale3d</span>(<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">        -webkit-<span class=\"attribute\">animation-timing-function</span>: <span class=\"built_in\">cubic-bezier</span>(<span class=\"number\">0.25</span>, <span class=\"number\">0.46</span>, <span class=\"number\">0.45</span>, <span class=\"number\">0.94</span>);</span><br><span class=\"line\">        <span class=\"attribute\">animation-timing-function</span>: <span class=\"built_in\">cubic-bezier</span>(<span class=\"number\">0.25</span>, <span class=\"number\">0.46</span>, <span class=\"number\">0.45</span>, <span class=\"number\">0.94</span>);</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"js实现拖拽功能","description":"js实现拖拽功能","date":"2022-07-27T16:00:00.000Z","cover":"https://urlify.cn/2Ev2Qz","_content":"\n# js实现拖拽功能\n\n### 分析\n\n- 能移动dom元素的位置，肯定与它的(x,y)坐标有关及改变dom元素的（left,top）的大小\n- 那怎么监听鼠标的（x,y）这里用的事件是鼠标移动事件`onmousemove`、按压事件`mousedown`及松开事件`onmouseup`\n- 那我们大胆的想一下接下来通过鼠标的怎么控制它移动的呢\n  - 元素肯定先绑定鼠标按压事件`mousedown`\n  - 在按压事件触发后，我们在监听鼠标移动事件`onmousemove`，鼠标移动的（x,y）貌似是dom元素位置(x,y)，这其实需要减去鼠标在dom元素的(x,y)才是\n  - 最后鼠标松开事件`onmouseup`清除所有事件，以免否则鼠标抬起后还可以继续拖拽方块\n\n### 初始化\n\n- 这里头部引入jQuery更好的dom操作\n\n~~~html\n<script src=\"https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js\"></script>\n~~~\n\n- 需要再页面中初始化drag的位置\n\n~~~html\n<!-- index.html -->\n <div class=\"drag\" style=\"left: 0; top: 0\">按住拖动</div>\n~~~\n\n- 初始化css\n\n~~~css\n// index.css\n.drag {\n    background-color: skyblue;\n    position: absolute;\n    line-height: 100px;\n    text-align: center;\n    width: 100px;\n    height: 100px;\n}\n~~~\n\n- 初始化js，获取dom原生\n\n~~~js\n// index.js\nlet dragDiv = document.getElementsByClassName('drag')[0];\n~~~\n\n### 绑定鼠标按下事件\n\n~~~js\ndragDiv.addEventListener('mousedown', putDown, false);\n~~~\n\n### 编写putDown里面的逻辑\n\n- 这里面就是计算dom元素的（left,top）\n- 之后清除所有事件\n\n~~~js\nlet putDown = function (event) {\n  dragDiv.style.cursor = 'pointer';\n  let offsetX = parseInt(dragDiv.style.left); // 获取当前的x轴距离\n  let offsetY = parseInt(dragDiv.style.top); // 获取当前的y轴距离\n  let innerX = event.clientX - offsetX; // 获取鼠标在方块内的x轴距\n  let innerY = event.clientY - offsetY; // 获取鼠标在方块内的y轴距\n  // 按住鼠标时为div添加一个border\n  dragDiv.style.borderStyle = 'solid';\n  dragDiv.style.borderColor = 'red';\n  dragDiv.style.borderWidth = '3px';\n  // 鼠标移动的时候不停的修改div的left和top值\n  document.onmousemove = function (event) {\n    dragDiv.style.left = event.clientX - innerX + 'px';\n    dragDiv.style.top = event.clientY - innerY + 'px';\n    // 边界判断\n    if (parseInt(dragDiv.style.left) <= 0) {\n      dragDiv.style.left = '0px';\n    }\n    if (parseInt(dragDiv.style.top) <= 0) {\n      dragDiv.style.top = '0px';\n    }\n    if (\n      parseInt(dragDiv.style.left) >=\n      window.innerWidth - parseInt(dragDiv.style.width)\n    ) {\n      dragDiv.style.left =\n        window.innerWidth - parseInt(dragDiv.style.width) + 'px';\n    }\n    if (\n      parseInt(dragDiv.style.top) >=\n      window.innerHeight - parseInt(dragDiv.style.height)\n    ) {\n      dragDiv.style.top =\n        window.innerHeight - parseInt(dragDiv.style.height) + 'px';\n    }\n  };\n  // 鼠标抬起时，清除绑定在文档上的mousemove和mouseup事件\n  // 否则鼠标抬起后还可以继续拖拽方块\n  document.onmouseup = function () {\n    document.onmousemove = null;\n    document.onmouseup = null;\n    // 清除border\n    dragDiv.style.borderStyle = '';\n    dragDiv.style.borderColor = '';\n    dragDiv.style.borderWidth = '';\n  };\n};\n~~~\n\n项目地址在这：[实现拖拽的demo](https://github.com/kangkang123269/kate-demo/tree/main/jQuery)","source":"_posts/javascript/js实现拖拽.md","raw":"---\ntitle: js实现拖拽功能\ntags: [前端,JavaScript]\ncategories: [JavaScript,demo]\ndescription: js实现拖拽功能\ndate: 2022-07-28\ncover: https://urlify.cn/2Ev2Qz\n---\n\n# js实现拖拽功能\n\n### 分析\n\n- 能移动dom元素的位置，肯定与它的(x,y)坐标有关及改变dom元素的（left,top）的大小\n- 那怎么监听鼠标的（x,y）这里用的事件是鼠标移动事件`onmousemove`、按压事件`mousedown`及松开事件`onmouseup`\n- 那我们大胆的想一下接下来通过鼠标的怎么控制它移动的呢\n  - 元素肯定先绑定鼠标按压事件`mousedown`\n  - 在按压事件触发后，我们在监听鼠标移动事件`onmousemove`，鼠标移动的（x,y）貌似是dom元素位置(x,y)，这其实需要减去鼠标在dom元素的(x,y)才是\n  - 最后鼠标松开事件`onmouseup`清除所有事件，以免否则鼠标抬起后还可以继续拖拽方块\n\n### 初始化\n\n- 这里头部引入jQuery更好的dom操作\n\n~~~html\n<script src=\"https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js\"></script>\n~~~\n\n- 需要再页面中初始化drag的位置\n\n~~~html\n<!-- index.html -->\n <div class=\"drag\" style=\"left: 0; top: 0\">按住拖动</div>\n~~~\n\n- 初始化css\n\n~~~css\n// index.css\n.drag {\n    background-color: skyblue;\n    position: absolute;\n    line-height: 100px;\n    text-align: center;\n    width: 100px;\n    height: 100px;\n}\n~~~\n\n- 初始化js，获取dom原生\n\n~~~js\n// index.js\nlet dragDiv = document.getElementsByClassName('drag')[0];\n~~~\n\n### 绑定鼠标按下事件\n\n~~~js\ndragDiv.addEventListener('mousedown', putDown, false);\n~~~\n\n### 编写putDown里面的逻辑\n\n- 这里面就是计算dom元素的（left,top）\n- 之后清除所有事件\n\n~~~js\nlet putDown = function (event) {\n  dragDiv.style.cursor = 'pointer';\n  let offsetX = parseInt(dragDiv.style.left); // 获取当前的x轴距离\n  let offsetY = parseInt(dragDiv.style.top); // 获取当前的y轴距离\n  let innerX = event.clientX - offsetX; // 获取鼠标在方块内的x轴距\n  let innerY = event.clientY - offsetY; // 获取鼠标在方块内的y轴距\n  // 按住鼠标时为div添加一个border\n  dragDiv.style.borderStyle = 'solid';\n  dragDiv.style.borderColor = 'red';\n  dragDiv.style.borderWidth = '3px';\n  // 鼠标移动的时候不停的修改div的left和top值\n  document.onmousemove = function (event) {\n    dragDiv.style.left = event.clientX - innerX + 'px';\n    dragDiv.style.top = event.clientY - innerY + 'px';\n    // 边界判断\n    if (parseInt(dragDiv.style.left) <= 0) {\n      dragDiv.style.left = '0px';\n    }\n    if (parseInt(dragDiv.style.top) <= 0) {\n      dragDiv.style.top = '0px';\n    }\n    if (\n      parseInt(dragDiv.style.left) >=\n      window.innerWidth - parseInt(dragDiv.style.width)\n    ) {\n      dragDiv.style.left =\n        window.innerWidth - parseInt(dragDiv.style.width) + 'px';\n    }\n    if (\n      parseInt(dragDiv.style.top) >=\n      window.innerHeight - parseInt(dragDiv.style.height)\n    ) {\n      dragDiv.style.top =\n        window.innerHeight - parseInt(dragDiv.style.height) + 'px';\n    }\n  };\n  // 鼠标抬起时，清除绑定在文档上的mousemove和mouseup事件\n  // 否则鼠标抬起后还可以继续拖拽方块\n  document.onmouseup = function () {\n    document.onmousemove = null;\n    document.onmouseup = null;\n    // 清除border\n    dragDiv.style.borderStyle = '';\n    dragDiv.style.borderColor = '';\n    dragDiv.style.borderWidth = '';\n  };\n};\n~~~\n\n项目地址在这：[实现拖拽的demo](https://github.com/kangkang123269/kate-demo/tree/main/jQuery)","slug":"javascript/js实现拖拽","published":1,"updated":"2022-10-12T02:50:25.544Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl95206bz00033no2ccw01daf","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><h1 id=\"js实现拖拽功能\"><a href=\"#js实现拖拽功能\" class=\"headerlink\" title=\"js实现拖拽功能\"></a>js实现拖拽功能</h1><h3 id=\"分析\"><a href=\"#分析\" class=\"headerlink\" title=\"分析\"></a>分析</h3><ul>\n<li>能移动dom元素的位置，肯定与它的(x,y)坐标有关及改变dom元素的（left,top）的大小</li>\n<li>那怎么监听鼠标的（x,y）这里用的事件是鼠标移动事件<code>onmousemove</code>、按压事件<code>mousedown</code>及松开事件<code>onmouseup</code></li>\n<li>那我们大胆的想一下接下来通过鼠标的怎么控制它移动的呢<ul>\n<li>元素肯定先绑定鼠标按压事件<code>mousedown</code></li>\n<li>在按压事件触发后，我们在监听鼠标移动事件<code>onmousemove</code>，鼠标移动的（x,y）貌似是dom元素位置(x,y)，这其实需要减去鼠标在dom元素的(x,y)才是</li>\n<li>最后鼠标松开事件<code>onmouseup</code>清除所有事件，以免否则鼠标抬起后还可以继续拖拽方块</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"初始化\"><a href=\"#初始化\" class=\"headerlink\" title=\"初始化\"></a>初始化</h3><ul>\n<li>这里头部引入jQuery更好的dom操作</li>\n</ul>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>需要再页面中初始化drag的位置</li>\n</ul>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- index.html --&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;drag&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;left: 0; top: 0&quot;</span>&gt;</span>按住拖动<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>初始化css</li>\n</ul>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// index<span class=\"selector-class\">.css</span></span><br><span class=\"line\"><span class=\"selector-class\">.drag</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: skyblue;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">    <span class=\"attribute\">line-height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>初始化js，获取dom原生</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// index.js</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> dragDiv = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementsByClassName</span>(<span class=\"string\">&#x27;drag&#x27;</span>)[<span class=\"number\">0</span>];</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"绑定鼠标按下事件\"><a href=\"#绑定鼠标按下事件\" class=\"headerlink\" title=\"绑定鼠标按下事件\"></a>绑定鼠标按下事件</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dragDiv.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;mousedown&#x27;</span>, putDown, <span class=\"literal\">false</span>);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"编写putDown里面的逻辑\"><a href=\"#编写putDown里面的逻辑\" class=\"headerlink\" title=\"编写putDown里面的逻辑\"></a>编写putDown里面的逻辑</h3><ul>\n<li>这里面就是计算dom元素的（left,top）</li>\n<li>之后清除所有事件</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> putDown = <span class=\"keyword\">function</span> (<span class=\"params\">event</span>) &#123;</span><br><span class=\"line\">  dragDiv.<span class=\"property\">style</span>.<span class=\"property\">cursor</span> = <span class=\"string\">&#x27;pointer&#x27;</span>;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> offsetX = <span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">left</span>); <span class=\"comment\">// 获取当前的x轴距离</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> offsetY = <span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">top</span>); <span class=\"comment\">// 获取当前的y轴距离</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> innerX = event.<span class=\"property\">clientX</span> - offsetX; <span class=\"comment\">// 获取鼠标在方块内的x轴距</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> innerY = event.<span class=\"property\">clientY</span> - offsetY; <span class=\"comment\">// 获取鼠标在方块内的y轴距</span></span><br><span class=\"line\">  <span class=\"comment\">// 按住鼠标时为div添加一个border</span></span><br><span class=\"line\">  dragDiv.<span class=\"property\">style</span>.<span class=\"property\">borderStyle</span> = <span class=\"string\">&#x27;solid&#x27;</span>;</span><br><span class=\"line\">  dragDiv.<span class=\"property\">style</span>.<span class=\"property\">borderColor</span> = <span class=\"string\">&#x27;red&#x27;</span>;</span><br><span class=\"line\">  dragDiv.<span class=\"property\">style</span>.<span class=\"property\">borderWidth</span> = <span class=\"string\">&#x27;3px&#x27;</span>;</span><br><span class=\"line\">  <span class=\"comment\">// 鼠标移动的时候不停的修改div的left和top值</span></span><br><span class=\"line\">  <span class=\"variable language_\">document</span>.<span class=\"property\">onmousemove</span> = <span class=\"keyword\">function</span> (<span class=\"params\">event</span>) &#123;</span><br><span class=\"line\">    dragDiv.<span class=\"property\">style</span>.<span class=\"property\">left</span> = event.<span class=\"property\">clientX</span> - innerX + <span class=\"string\">&#x27;px&#x27;</span>;</span><br><span class=\"line\">    dragDiv.<span class=\"property\">style</span>.<span class=\"property\">top</span> = event.<span class=\"property\">clientY</span> - innerY + <span class=\"string\">&#x27;px&#x27;</span>;</span><br><span class=\"line\">    <span class=\"comment\">// 边界判断</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">left</span>) &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">      dragDiv.<span class=\"property\">style</span>.<span class=\"property\">left</span> = <span class=\"string\">&#x27;0px&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">top</span>) &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">      dragDiv.<span class=\"property\">style</span>.<span class=\"property\">top</span> = <span class=\"string\">&#x27;0px&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (</span><br><span class=\"line\">      <span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">left</span>) &gt;=</span><br><span class=\"line\">      <span class=\"variable language_\">window</span>.<span class=\"property\">innerWidth</span> - <span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">width</span>)</span><br><span class=\"line\">    ) &#123;</span><br><span class=\"line\">      dragDiv.<span class=\"property\">style</span>.<span class=\"property\">left</span> =</span><br><span class=\"line\">        <span class=\"variable language_\">window</span>.<span class=\"property\">innerWidth</span> - <span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">width</span>) + <span class=\"string\">&#x27;px&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (</span><br><span class=\"line\">      <span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">top</span>) &gt;=</span><br><span class=\"line\">      <span class=\"variable language_\">window</span>.<span class=\"property\">innerHeight</span> - <span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">height</span>)</span><br><span class=\"line\">    ) &#123;</span><br><span class=\"line\">      dragDiv.<span class=\"property\">style</span>.<span class=\"property\">top</span> =</span><br><span class=\"line\">        <span class=\"variable language_\">window</span>.<span class=\"property\">innerHeight</span> - <span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">height</span>) + <span class=\"string\">&#x27;px&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  <span class=\"comment\">// 鼠标抬起时，清除绑定在文档上的mousemove和mouseup事件</span></span><br><span class=\"line\">  <span class=\"comment\">// 否则鼠标抬起后还可以继续拖拽方块</span></span><br><span class=\"line\">  <span class=\"variable language_\">document</span>.<span class=\"property\">onmouseup</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">onmousemove</span> = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">onmouseup</span> = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\">// 清除border</span></span><br><span class=\"line\">    dragDiv.<span class=\"property\">style</span>.<span class=\"property\">borderStyle</span> = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">    dragDiv.<span class=\"property\">style</span>.<span class=\"property\">borderColor</span> = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">    dragDiv.<span class=\"property\">style</span>.<span class=\"property\">borderWidth</span> = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>项目地址在这：<a href=\"https://github.com/kangkang123269/kate-demo/tree/main/jQuery\">实现拖拽的demo</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"js实现拖拽功能\"><a href=\"#js实现拖拽功能\" class=\"headerlink\" title=\"js实现拖拽功能\"></a>js实现拖拽功能</h1><h3 id=\"分析\"><a href=\"#分析\" class=\"headerlink\" title=\"分析\"></a>分析</h3><ul>\n<li>能移动dom元素的位置，肯定与它的(x,y)坐标有关及改变dom元素的（left,top）的大小</li>\n<li>那怎么监听鼠标的（x,y）这里用的事件是鼠标移动事件<code>onmousemove</code>、按压事件<code>mousedown</code>及松开事件<code>onmouseup</code></li>\n<li>那我们大胆的想一下接下来通过鼠标的怎么控制它移动的呢<ul>\n<li>元素肯定先绑定鼠标按压事件<code>mousedown</code></li>\n<li>在按压事件触发后，我们在监听鼠标移动事件<code>onmousemove</code>，鼠标移动的（x,y）貌似是dom元素位置(x,y)，这其实需要减去鼠标在dom元素的(x,y)才是</li>\n<li>最后鼠标松开事件<code>onmouseup</code>清除所有事件，以免否则鼠标抬起后还可以继续拖拽方块</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"初始化\"><a href=\"#初始化\" class=\"headerlink\" title=\"初始化\"></a>初始化</h3><ul>\n<li>这里头部引入jQuery更好的dom操作</li>\n</ul>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>需要再页面中初始化drag的位置</li>\n</ul>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- index.html --&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;drag&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;left: 0; top: 0&quot;</span>&gt;</span>按住拖动<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>初始化css</li>\n</ul>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// index<span class=\"selector-class\">.css</span></span><br><span class=\"line\"><span class=\"selector-class\">.drag</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: skyblue;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">    <span class=\"attribute\">line-height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>初始化js，获取dom原生</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// index.js</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> dragDiv = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementsByClassName</span>(<span class=\"string\">&#x27;drag&#x27;</span>)[<span class=\"number\">0</span>];</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"绑定鼠标按下事件\"><a href=\"#绑定鼠标按下事件\" class=\"headerlink\" title=\"绑定鼠标按下事件\"></a>绑定鼠标按下事件</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dragDiv.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;mousedown&#x27;</span>, putDown, <span class=\"literal\">false</span>);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"编写putDown里面的逻辑\"><a href=\"#编写putDown里面的逻辑\" class=\"headerlink\" title=\"编写putDown里面的逻辑\"></a>编写putDown里面的逻辑</h3><ul>\n<li>这里面就是计算dom元素的（left,top）</li>\n<li>之后清除所有事件</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> putDown = <span class=\"keyword\">function</span> (<span class=\"params\">event</span>) &#123;</span><br><span class=\"line\">  dragDiv.<span class=\"property\">style</span>.<span class=\"property\">cursor</span> = <span class=\"string\">&#x27;pointer&#x27;</span>;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> offsetX = <span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">left</span>); <span class=\"comment\">// 获取当前的x轴距离</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> offsetY = <span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">top</span>); <span class=\"comment\">// 获取当前的y轴距离</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> innerX = event.<span class=\"property\">clientX</span> - offsetX; <span class=\"comment\">// 获取鼠标在方块内的x轴距</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> innerY = event.<span class=\"property\">clientY</span> - offsetY; <span class=\"comment\">// 获取鼠标在方块内的y轴距</span></span><br><span class=\"line\">  <span class=\"comment\">// 按住鼠标时为div添加一个border</span></span><br><span class=\"line\">  dragDiv.<span class=\"property\">style</span>.<span class=\"property\">borderStyle</span> = <span class=\"string\">&#x27;solid&#x27;</span>;</span><br><span class=\"line\">  dragDiv.<span class=\"property\">style</span>.<span class=\"property\">borderColor</span> = <span class=\"string\">&#x27;red&#x27;</span>;</span><br><span class=\"line\">  dragDiv.<span class=\"property\">style</span>.<span class=\"property\">borderWidth</span> = <span class=\"string\">&#x27;3px&#x27;</span>;</span><br><span class=\"line\">  <span class=\"comment\">// 鼠标移动的时候不停的修改div的left和top值</span></span><br><span class=\"line\">  <span class=\"variable language_\">document</span>.<span class=\"property\">onmousemove</span> = <span class=\"keyword\">function</span> (<span class=\"params\">event</span>) &#123;</span><br><span class=\"line\">    dragDiv.<span class=\"property\">style</span>.<span class=\"property\">left</span> = event.<span class=\"property\">clientX</span> - innerX + <span class=\"string\">&#x27;px&#x27;</span>;</span><br><span class=\"line\">    dragDiv.<span class=\"property\">style</span>.<span class=\"property\">top</span> = event.<span class=\"property\">clientY</span> - innerY + <span class=\"string\">&#x27;px&#x27;</span>;</span><br><span class=\"line\">    <span class=\"comment\">// 边界判断</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">left</span>) &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">      dragDiv.<span class=\"property\">style</span>.<span class=\"property\">left</span> = <span class=\"string\">&#x27;0px&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">top</span>) &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">      dragDiv.<span class=\"property\">style</span>.<span class=\"property\">top</span> = <span class=\"string\">&#x27;0px&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (</span><br><span class=\"line\">      <span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">left</span>) &gt;=</span><br><span class=\"line\">      <span class=\"variable language_\">window</span>.<span class=\"property\">innerWidth</span> - <span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">width</span>)</span><br><span class=\"line\">    ) &#123;</span><br><span class=\"line\">      dragDiv.<span class=\"property\">style</span>.<span class=\"property\">left</span> =</span><br><span class=\"line\">        <span class=\"variable language_\">window</span>.<span class=\"property\">innerWidth</span> - <span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">width</span>) + <span class=\"string\">&#x27;px&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (</span><br><span class=\"line\">      <span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">top</span>) &gt;=</span><br><span class=\"line\">      <span class=\"variable language_\">window</span>.<span class=\"property\">innerHeight</span> - <span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">height</span>)</span><br><span class=\"line\">    ) &#123;</span><br><span class=\"line\">      dragDiv.<span class=\"property\">style</span>.<span class=\"property\">top</span> =</span><br><span class=\"line\">        <span class=\"variable language_\">window</span>.<span class=\"property\">innerHeight</span> - <span class=\"built_in\">parseInt</span>(dragDiv.<span class=\"property\">style</span>.<span class=\"property\">height</span>) + <span class=\"string\">&#x27;px&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  <span class=\"comment\">// 鼠标抬起时，清除绑定在文档上的mousemove和mouseup事件</span></span><br><span class=\"line\">  <span class=\"comment\">// 否则鼠标抬起后还可以继续拖拽方块</span></span><br><span class=\"line\">  <span class=\"variable language_\">document</span>.<span class=\"property\">onmouseup</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">onmousemove</span> = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">onmouseup</span> = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\">// 清除border</span></span><br><span class=\"line\">    dragDiv.<span class=\"property\">style</span>.<span class=\"property\">borderStyle</span> = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">    dragDiv.<span class=\"property\">style</span>.<span class=\"property\">borderColor</span> = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">    dragDiv.<span class=\"property\">style</span>.<span class=\"property\">borderWidth</span> = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>项目地址在这：<a href=\"https://github.com/kangkang123269/kate-demo/tree/main/jQuery\">实现拖拽的demo</a></p>\n"},{"title":"封装class一次性解决实现全屏功能","description":"封装class一次性解决实现全屏功能","date":"2022-07-30T16:00:00.000Z","cover":"https://urlify.cn/zuyyUz","_content":"\n# 封装class一次性解决实现全屏功能\n\n\n### 前言\n\n这里先给项目地址：[地址](https://github.com/kangkang123269/kate-demo/tree/main/html5/fullScreen-demo)\n\n### 支持全屏的api\n\n1. 浏览器是否支持全屏模式：`document.fullscreenEnabled`\n2. 使元素进入全屏模式：`Element.requestFullscreen()`\n3. 退出全屏：`document.exitFullscreen()`\n4. 检查当前是否有节点处于全屏状态：`document.fullscreenElement`\n5. 进入全屏/离开全屏，触发事件：`document.fullscreenchange`\n6. 无法进入全屏时触发: `document.fullscreenerror`\n\n### 浏览器前缀：\n\n目前并不是所有的浏览器都实现了API的无前缀版本，所以我们需要针对不同浏览器，做一下API的兼容:\n\n我们需要写成类的形式：\n\n~~~js\n/**\n * @description: 是否支持全屏+判断浏览器前缀\n * @param {Function} fn 不支持全屏的回调函数 这里设了一个默认值\n */\nisFullscreen(fn) {\n  let fullscreenEnabled;\n  // 判断浏览器前缀\n  if (document.fullscreenEnabled) {\n    fullscreenEnabled = document.fullscreenEnabled;\n  } else if (document.webkitFullscreenEnabled) {\n    fullscreenEnabled = document.webkitFullscreenEnabled;\n    this.prefixName = 'webkit';\n  } else if (document.mozFullScreenEnabled) {\n    fullscreenEnabled = document.mozFullScreenEnabled;\n    this.prefixName = 'moz';\n  } else if (document.msFullscreenEnabled) {\n    fullscreenEnabled = document.msFullscreenEnabled;\n    this.prefixName = 'ms';\n  }\n  if (!fullscreenEnabled) {\n    if (fn !== undefined) fn(); // 执行不支持全屏的回调\n    this.isFullscreenData = false;\n  }\n}\n~~~\n\n### 1. 浏览器是否支持全屏模式：document.fullscreenEnabled\n\n`document.fullscreenEnabled`属性返回一个布尔值，表示当前文档是否可以切换到全屏状态。\n\n### 2. 使元素进入全屏模式：Element.requestFullscreen()\n\n~~~js\n/**\n * @description: 将传进来的元素全屏\n * @param {String} domName 要全屏的dom名称\n */\nFullscreen(domName) {\n  const element = document.querySelector(domName); // 获取dom\n  const methodName =\n    this.prefixName === ''\n      ? 'requestFullscreen'\n      : `${this.prefixName}RequestFullScreen`; // API前缀\n  element[methodName](); // 调用全屏\n}\n~~~\n\n### 3. 退出全屏：document.exitFullscreen()\n\n~~~js\nexitFullscreen() {\n  const methodName =\n    this.prefixName === ''\n      ? 'exitFullscreen'\n      : `${this.prefixName}ExitFullscreen`; // API 前缀\n  document[methodName](); // 调用\n}\n~~~\n\n### 4. 检查当前是否有节点处于全屏状态：document.fullscreenElement\n\n~~~js\n/**\n * @description: 检测有没有元素处于全屏状态\n * @return 布尔值\n */\nisElementFullScreen() {\n  const fullscreenElement =\n    document.fullscreenElement ||\n    document.msFullscreenElement ||\n    document.mozFullScreenElement ||\n    document.webkitFullscreenElement; // 有前缀的f是大写，没前缀是小写\n  if (fullscreenElement === null) {\n    return false; // 当前没有元素在全屏状态\n  } else {\n    return true; // 有元素在全屏状态\n  }\n}\n~~~\n\n事实上，还有一个属性`document.fullscreen`，返回一个布尔值，表示文档是否处于全屏模式。\n\n两个方法效果是一样，但因为IE不支持这个属性，所以这里用的是`document.fullscreenElement`.\n\n### 5. 进入全屏/离开全屏，触发事件：document.fullscreenchange\n\n当我们进入全屏和离开全屏的时候，都会触发一个`fullscreenchange`事件。\n\n> 注意：此事件不会提供任何信息，表明是进入全屏或退出全屏。\n\n~~~js\n/**\n * @description: 监听进入/离开全屏\n * @param {Function} enter 进入全屏的回调\n *  @param {Function} quit 离开全屏的回调\n */\nscreenChange(enter,quit) {\n  if (!this.isFullscreenData) return;\n  const methodName = `on${this.prefixName}fullscreenchange`;\n  document[methodName] = e => {\n    if (this.isElementFullScreen()) {\n      enter && enter(e); // 进入全屏回调\n    } else {\n      quit && quit(e); // 离开全屏的回调\n    }\n  };\n}\n~~~\n\n**注意：多层全屏的情况**\n\n1. 先进入左边全屏(进入全屏回调)，再进入红色全屏(进入全屏回调)\n2. 退出全屏,此时退出红色全屏，左边仍是全屏(触发进入全屏回调)\n3. 出现这种情况，可以在点击按钮的时候，做一些状态限制。或者根据全屏事件返回的dom信息来进行判断。\n\n\n### 6. 无法进入全屏时触发: document.fullscreenerror\n\n比如全屏请求不是在事件处理函数中调用,会在这里拦截到错误:\n\n~~~js\n/**\n * @description: 浏览器无法进入全屏时触发\n * @param {Function} enterErrorFn 回调\n */\nscreenError(enterErrorFn) {\n  const methodName = `on${this.prefixName}fullscreenerror`;\n  document[methodName] = e => {\n    enterErrorFn && enterErrorFn(e)\n  };\n}\n~~~\n\n### Css： 全屏模式下的样式\n\n1. 默认设置黑色背景\n\n~~~css\n:not(:root):-webkit-full-screen::backdrop {\n  position: fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  background: black; // 会将背景设为黑色的 如果你没为你的dom设置背景的话，全屏下会为黑色\n}\n~~~\n\n2. 默认样式：\n\n~~~css\n:not(:root):-webkit-full-screen {\n  object-fit: contain;\n  position: fixed !important;\n  top: 0px !important;\n  right: 0px !important;\n  bottom: 0px !important;\n  left: 0px !important;\n  box-sizing: border-box !important;\n  min-width: 0px !important;\n  max-width: none !important;\n  min-height: 0px !important;\n  max-height: none !important;\n  width: 100% !important;\n  height: 100% !important;\n  transform: none !important;\n  margin: 0px !important;\n}\n~~~\n\n### 全屏状态的CSS：\n\n全屏状态下，大多数浏览器的CSS支持:full-screen伪类，只有IE11支持:fullscreen伪类。使用这个伪类，可以对全屏状态设置单独的CSS属性。\n\n~~~css\n/* 针对dom的全屏设置 */\n.div:-webkit-full-screen {\n  background: #fff;\n}\n/* 全屏属性 */\n:-webkit-full-screen {}\n:-moz-full-screen {}\n:-ms-fullscreen {}\n/* 全屏伪类 当前chrome:70 不支持 */\n:full-screen {\n}\n:fullscreen {\n  /* IE11支持 */\n}\n~~~\n\n参考资料：阮一峰老师的[Fullscreen API：全屏操作](https://javascript.ruanyifeng.com/htmlapi/fullscreen.html#toc0)\n\n\n\n这里是一条华丽的分割线，讲完原理开始实战\n\n---\n\n\n\n### 项目的html\n\nindex.html：\n\n~~~html\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n  <link rel=\"stylesheet\" href=\"./index.css\" />\n  <title>Document</title>\n</head>\n\n<body>\n  <iframe src=\"https://codesandbox.io/s/\" id=\"iframe-one\" name=\"iframe-one\n      width=\" 100%\" height=\"200\" scrolling=\"no\" frameborder=\"0\"></iframe>\n  <img src=\"vscode.svg\" onclick=\"iframeScreen()\" id=\"vscode\" width=\"100\" height=\"100\" alt=\"\">\n  <script src=\"./index.js\"></script>\n</body>\n\n</html>\n~~~\n\n### 项目中的css\n\nindex.css：\n\n~~~css\n#iframe-one {  // 随便是什么元素，一开始不展示元素\n  display: none;\n}\n/* 针对dom的全屏设置 */\n.left:-webkit-full-screen {\n  background: #fff;\n}\n/* 全屏属性 */\n:-webkit-full-screen {\n}\n:-moz-full-screen {\n\n}\n:-ms-fullscreen {\n}\n/* 全屏伪类 当前chrome:70 不支持 */\n:full-screen {\n\n}\n:fullscreen {\n  /* IE11支持 */\n}\n\n~~~\n\n### 封装完成的js文件\n\n以后无论遇到什么全屏问题都可以用改封装得class\n\nindex.js：\n\n~~~js\nclass fullScreen {\n  constructor(fn) {\n    // fn是失败的回调函数\n    this.prefixName = ''; // 浏览器前缀\n    this.isFullscreenData = true; // 浏览器支持全屏\n    this.isFullscreen(fn);\n  }\n  /**\n   * @description: 是否支持全屏+判断浏览器前缀\n   * @param {Function} fn 不支持全屏的回调函数 这里设了一个默认值\n   */\n  isFullscreen(fn) {\n    let fullscreenEnabled; // 是否支持全屏\n    // 判断浏览器前缀\n    if (document.fullscreenEnabled) {\n      fullscreenEnabled = document.fullscreenEnabled;\n    } else if (document.webkitFullscreenEnabled) {\n      fullscreenEnabled = document.webkitFullscreenEnabled;\n      this.prefixName = 'webkit';\n    } else if (document.mozFullScreenEnabled) {\n      fullscreenEnabled = document.mozFullScreenEnabled;\n      this.prefixName = 'moz';\n    } else if (document.msFullscreenEnabled) {\n      fullscreenEnabled = document.msFullscreenEnabled;\n      this.prefixName = 'ms';\n    }\n    if (!fullscreenEnabled) {\n      if (fn !== undefined) fn(); // 执行不支持全屏的回调\n      this.isFullscreenData = false;\n    }\n  }\n\n  /**\n   * @description: 将传进来的元素全屏\n   * @param {String} domName 要全屏的dom名称\n   */\n  Fullscreen(element) {\n    const methodName =\n      this.prefixName === ''\n        ? 'requestFullscreen'\n        : `${this.prefixName}RequestFullScreen`; // API前缀\n    element[methodName](); // 调用全屏\n  }\n\n  // 退出全屏\n  exitFullscreen() {\n    const methodName =\n      this.prefixName === ''\n        ? 'exitFullscreen'\n        : `${this.prefixName}ExitFullscreen`; // API 前缀\n    document[methodName](); // 调用\n  }\n\n  /**\n   * @description: 检测有没有元素处于全屏状态\n   * @return 布尔值\n   */\n  isElementFullScreen() {\n    const fullscreenElement =\n      document.fullscreenElement ||\n      document.msFullscreenElement ||\n      document.mozFullScreenElement ||\n      document.webkitFullscreenElement; // 有前缀的f是大写，没前缀是小写\n    if (fullscreenElement === null) {\n      return false; // 当前没有元素在全屏状态\n    } else {\n      return true; // 有元素在全屏状态\n    }\n  }\n\n  /**\n   * @description: 监听进入/离开全屏\n   * @param {Function} enter 进入全屏的回调\n   *  @param {Function} quit 离开全屏的回调\n   */\n  screenChange(enter, quit) {\n    if (!this.isFullscreenData) return;\n    const methodName = `on${this.prefixName}fullscreenchange`;\n    document[methodName] = (e) => {\n      console.log(e);\n      if (this.isElementFullScreen()) {\n        enter && enter(); // 进入全屏回调\n      } else {\n        quit && quit(); // 离开全屏的回调\n      }\n    };\n  }\n\n  /**\n   * @description: 浏览器无法进入全屏时触发\n   * @param {Function} enterErrorFn 回调\n   */\n  screenError(enterErrorFn) {\n    const methodName = `on${this.prefixName}fullscreenerror`;\n    document[methodName] = (e) => {\n      enterErrorFn && enterErrorFn(e);\n    };\n  }\n}\n~~~\n\n### 对元素一开始显示或者隐藏处理\n\n这里可以这样处理调用`screenChange`方法，里面执行进入屏幕的回调和离开屏幕的回调，既进入显示，离开隐藏\n\nindex.js：\n\n~~~js\nlet full = new fullScreen(() => {\n  console.log('不支持');\n});\n\nconst iframe = {\n  enter: function (element) {\n    // 显示\n    element.style.display = 'block';\n  },\n  quit: function (element) {\n    // 隐藏\n    element.style.display = 'none';\n  },\n};\n\nfunction iframeScreen() {\n  const element = document.querySelector('#iframe-one');\n  full.Fullscreen(element);\n  full.screenChange(\n    () => iframe.enter(element),\n    () => iframe.quit(element)\n  );\n}\n~~~\n\n","source":"_posts/html5/实现全屏功能.md","raw":"---\ntitle: 封装class一次性解决实现全屏功能\ntags: [前端]\ncategories: [html]\ndescription: 封装class一次性解决实现全屏功能\ndate: 2022-07-31\ncover: https://urlify.cn/zuyyUz\n---\n\n# 封装class一次性解决实现全屏功能\n\n\n### 前言\n\n这里先给项目地址：[地址](https://github.com/kangkang123269/kate-demo/tree/main/html5/fullScreen-demo)\n\n### 支持全屏的api\n\n1. 浏览器是否支持全屏模式：`document.fullscreenEnabled`\n2. 使元素进入全屏模式：`Element.requestFullscreen()`\n3. 退出全屏：`document.exitFullscreen()`\n4. 检查当前是否有节点处于全屏状态：`document.fullscreenElement`\n5. 进入全屏/离开全屏，触发事件：`document.fullscreenchange`\n6. 无法进入全屏时触发: `document.fullscreenerror`\n\n### 浏览器前缀：\n\n目前并不是所有的浏览器都实现了API的无前缀版本，所以我们需要针对不同浏览器，做一下API的兼容:\n\n我们需要写成类的形式：\n\n~~~js\n/**\n * @description: 是否支持全屏+判断浏览器前缀\n * @param {Function} fn 不支持全屏的回调函数 这里设了一个默认值\n */\nisFullscreen(fn) {\n  let fullscreenEnabled;\n  // 判断浏览器前缀\n  if (document.fullscreenEnabled) {\n    fullscreenEnabled = document.fullscreenEnabled;\n  } else if (document.webkitFullscreenEnabled) {\n    fullscreenEnabled = document.webkitFullscreenEnabled;\n    this.prefixName = 'webkit';\n  } else if (document.mozFullScreenEnabled) {\n    fullscreenEnabled = document.mozFullScreenEnabled;\n    this.prefixName = 'moz';\n  } else if (document.msFullscreenEnabled) {\n    fullscreenEnabled = document.msFullscreenEnabled;\n    this.prefixName = 'ms';\n  }\n  if (!fullscreenEnabled) {\n    if (fn !== undefined) fn(); // 执行不支持全屏的回调\n    this.isFullscreenData = false;\n  }\n}\n~~~\n\n### 1. 浏览器是否支持全屏模式：document.fullscreenEnabled\n\n`document.fullscreenEnabled`属性返回一个布尔值，表示当前文档是否可以切换到全屏状态。\n\n### 2. 使元素进入全屏模式：Element.requestFullscreen()\n\n~~~js\n/**\n * @description: 将传进来的元素全屏\n * @param {String} domName 要全屏的dom名称\n */\nFullscreen(domName) {\n  const element = document.querySelector(domName); // 获取dom\n  const methodName =\n    this.prefixName === ''\n      ? 'requestFullscreen'\n      : `${this.prefixName}RequestFullScreen`; // API前缀\n  element[methodName](); // 调用全屏\n}\n~~~\n\n### 3. 退出全屏：document.exitFullscreen()\n\n~~~js\nexitFullscreen() {\n  const methodName =\n    this.prefixName === ''\n      ? 'exitFullscreen'\n      : `${this.prefixName}ExitFullscreen`; // API 前缀\n  document[methodName](); // 调用\n}\n~~~\n\n### 4. 检查当前是否有节点处于全屏状态：document.fullscreenElement\n\n~~~js\n/**\n * @description: 检测有没有元素处于全屏状态\n * @return 布尔值\n */\nisElementFullScreen() {\n  const fullscreenElement =\n    document.fullscreenElement ||\n    document.msFullscreenElement ||\n    document.mozFullScreenElement ||\n    document.webkitFullscreenElement; // 有前缀的f是大写，没前缀是小写\n  if (fullscreenElement === null) {\n    return false; // 当前没有元素在全屏状态\n  } else {\n    return true; // 有元素在全屏状态\n  }\n}\n~~~\n\n事实上，还有一个属性`document.fullscreen`，返回一个布尔值，表示文档是否处于全屏模式。\n\n两个方法效果是一样，但因为IE不支持这个属性，所以这里用的是`document.fullscreenElement`.\n\n### 5. 进入全屏/离开全屏，触发事件：document.fullscreenchange\n\n当我们进入全屏和离开全屏的时候，都会触发一个`fullscreenchange`事件。\n\n> 注意：此事件不会提供任何信息，表明是进入全屏或退出全屏。\n\n~~~js\n/**\n * @description: 监听进入/离开全屏\n * @param {Function} enter 进入全屏的回调\n *  @param {Function} quit 离开全屏的回调\n */\nscreenChange(enter,quit) {\n  if (!this.isFullscreenData) return;\n  const methodName = `on${this.prefixName}fullscreenchange`;\n  document[methodName] = e => {\n    if (this.isElementFullScreen()) {\n      enter && enter(e); // 进入全屏回调\n    } else {\n      quit && quit(e); // 离开全屏的回调\n    }\n  };\n}\n~~~\n\n**注意：多层全屏的情况**\n\n1. 先进入左边全屏(进入全屏回调)，再进入红色全屏(进入全屏回调)\n2. 退出全屏,此时退出红色全屏，左边仍是全屏(触发进入全屏回调)\n3. 出现这种情况，可以在点击按钮的时候，做一些状态限制。或者根据全屏事件返回的dom信息来进行判断。\n\n\n### 6. 无法进入全屏时触发: document.fullscreenerror\n\n比如全屏请求不是在事件处理函数中调用,会在这里拦截到错误:\n\n~~~js\n/**\n * @description: 浏览器无法进入全屏时触发\n * @param {Function} enterErrorFn 回调\n */\nscreenError(enterErrorFn) {\n  const methodName = `on${this.prefixName}fullscreenerror`;\n  document[methodName] = e => {\n    enterErrorFn && enterErrorFn(e)\n  };\n}\n~~~\n\n### Css： 全屏模式下的样式\n\n1. 默认设置黑色背景\n\n~~~css\n:not(:root):-webkit-full-screen::backdrop {\n  position: fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  background: black; // 会将背景设为黑色的 如果你没为你的dom设置背景的话，全屏下会为黑色\n}\n~~~\n\n2. 默认样式：\n\n~~~css\n:not(:root):-webkit-full-screen {\n  object-fit: contain;\n  position: fixed !important;\n  top: 0px !important;\n  right: 0px !important;\n  bottom: 0px !important;\n  left: 0px !important;\n  box-sizing: border-box !important;\n  min-width: 0px !important;\n  max-width: none !important;\n  min-height: 0px !important;\n  max-height: none !important;\n  width: 100% !important;\n  height: 100% !important;\n  transform: none !important;\n  margin: 0px !important;\n}\n~~~\n\n### 全屏状态的CSS：\n\n全屏状态下，大多数浏览器的CSS支持:full-screen伪类，只有IE11支持:fullscreen伪类。使用这个伪类，可以对全屏状态设置单独的CSS属性。\n\n~~~css\n/* 针对dom的全屏设置 */\n.div:-webkit-full-screen {\n  background: #fff;\n}\n/* 全屏属性 */\n:-webkit-full-screen {}\n:-moz-full-screen {}\n:-ms-fullscreen {}\n/* 全屏伪类 当前chrome:70 不支持 */\n:full-screen {\n}\n:fullscreen {\n  /* IE11支持 */\n}\n~~~\n\n参考资料：阮一峰老师的[Fullscreen API：全屏操作](https://javascript.ruanyifeng.com/htmlapi/fullscreen.html#toc0)\n\n\n\n这里是一条华丽的分割线，讲完原理开始实战\n\n---\n\n\n\n### 项目的html\n\nindex.html：\n\n~~~html\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n  <link rel=\"stylesheet\" href=\"./index.css\" />\n  <title>Document</title>\n</head>\n\n<body>\n  <iframe src=\"https://codesandbox.io/s/\" id=\"iframe-one\" name=\"iframe-one\n      width=\" 100%\" height=\"200\" scrolling=\"no\" frameborder=\"0\"></iframe>\n  <img src=\"vscode.svg\" onclick=\"iframeScreen()\" id=\"vscode\" width=\"100\" height=\"100\" alt=\"\">\n  <script src=\"./index.js\"></script>\n</body>\n\n</html>\n~~~\n\n### 项目中的css\n\nindex.css：\n\n~~~css\n#iframe-one {  // 随便是什么元素，一开始不展示元素\n  display: none;\n}\n/* 针对dom的全屏设置 */\n.left:-webkit-full-screen {\n  background: #fff;\n}\n/* 全屏属性 */\n:-webkit-full-screen {\n}\n:-moz-full-screen {\n\n}\n:-ms-fullscreen {\n}\n/* 全屏伪类 当前chrome:70 不支持 */\n:full-screen {\n\n}\n:fullscreen {\n  /* IE11支持 */\n}\n\n~~~\n\n### 封装完成的js文件\n\n以后无论遇到什么全屏问题都可以用改封装得class\n\nindex.js：\n\n~~~js\nclass fullScreen {\n  constructor(fn) {\n    // fn是失败的回调函数\n    this.prefixName = ''; // 浏览器前缀\n    this.isFullscreenData = true; // 浏览器支持全屏\n    this.isFullscreen(fn);\n  }\n  /**\n   * @description: 是否支持全屏+判断浏览器前缀\n   * @param {Function} fn 不支持全屏的回调函数 这里设了一个默认值\n   */\n  isFullscreen(fn) {\n    let fullscreenEnabled; // 是否支持全屏\n    // 判断浏览器前缀\n    if (document.fullscreenEnabled) {\n      fullscreenEnabled = document.fullscreenEnabled;\n    } else if (document.webkitFullscreenEnabled) {\n      fullscreenEnabled = document.webkitFullscreenEnabled;\n      this.prefixName = 'webkit';\n    } else if (document.mozFullScreenEnabled) {\n      fullscreenEnabled = document.mozFullScreenEnabled;\n      this.prefixName = 'moz';\n    } else if (document.msFullscreenEnabled) {\n      fullscreenEnabled = document.msFullscreenEnabled;\n      this.prefixName = 'ms';\n    }\n    if (!fullscreenEnabled) {\n      if (fn !== undefined) fn(); // 执行不支持全屏的回调\n      this.isFullscreenData = false;\n    }\n  }\n\n  /**\n   * @description: 将传进来的元素全屏\n   * @param {String} domName 要全屏的dom名称\n   */\n  Fullscreen(element) {\n    const methodName =\n      this.prefixName === ''\n        ? 'requestFullscreen'\n        : `${this.prefixName}RequestFullScreen`; // API前缀\n    element[methodName](); // 调用全屏\n  }\n\n  // 退出全屏\n  exitFullscreen() {\n    const methodName =\n      this.prefixName === ''\n        ? 'exitFullscreen'\n        : `${this.prefixName}ExitFullscreen`; // API 前缀\n    document[methodName](); // 调用\n  }\n\n  /**\n   * @description: 检测有没有元素处于全屏状态\n   * @return 布尔值\n   */\n  isElementFullScreen() {\n    const fullscreenElement =\n      document.fullscreenElement ||\n      document.msFullscreenElement ||\n      document.mozFullScreenElement ||\n      document.webkitFullscreenElement; // 有前缀的f是大写，没前缀是小写\n    if (fullscreenElement === null) {\n      return false; // 当前没有元素在全屏状态\n    } else {\n      return true; // 有元素在全屏状态\n    }\n  }\n\n  /**\n   * @description: 监听进入/离开全屏\n   * @param {Function} enter 进入全屏的回调\n   *  @param {Function} quit 离开全屏的回调\n   */\n  screenChange(enter, quit) {\n    if (!this.isFullscreenData) return;\n    const methodName = `on${this.prefixName}fullscreenchange`;\n    document[methodName] = (e) => {\n      console.log(e);\n      if (this.isElementFullScreen()) {\n        enter && enter(); // 进入全屏回调\n      } else {\n        quit && quit(); // 离开全屏的回调\n      }\n    };\n  }\n\n  /**\n   * @description: 浏览器无法进入全屏时触发\n   * @param {Function} enterErrorFn 回调\n   */\n  screenError(enterErrorFn) {\n    const methodName = `on${this.prefixName}fullscreenerror`;\n    document[methodName] = (e) => {\n      enterErrorFn && enterErrorFn(e);\n    };\n  }\n}\n~~~\n\n### 对元素一开始显示或者隐藏处理\n\n这里可以这样处理调用`screenChange`方法，里面执行进入屏幕的回调和离开屏幕的回调，既进入显示，离开隐藏\n\nindex.js：\n\n~~~js\nlet full = new fullScreen(() => {\n  console.log('不支持');\n});\n\nconst iframe = {\n  enter: function (element) {\n    // 显示\n    element.style.display = 'block';\n  },\n  quit: function (element) {\n    // 隐藏\n    element.style.display = 'none';\n  },\n};\n\nfunction iframeScreen() {\n  const element = document.querySelector('#iframe-one');\n  full.Fullscreen(element);\n  full.screenChange(\n    () => iframe.enter(element),\n    () => iframe.quit(element)\n  );\n}\n~~~\n\n","slug":"html5/实现全屏功能","published":1,"updated":"2022-10-12T02:50:25.544Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl95206c400073no27h1vduop","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><h1 id=\"封装class一次性解决实现全屏功能\"><a href=\"#封装class一次性解决实现全屏功能\" class=\"headerlink\" title=\"封装class一次性解决实现全屏功能\"></a>封装class一次性解决实现全屏功能</h1><h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>这里先给项目地址：<a href=\"https://github.com/kangkang123269/kate-demo/tree/main/html5/fullScreen-demo\">地址</a></p>\n<h3 id=\"支持全屏的api\"><a href=\"#支持全屏的api\" class=\"headerlink\" title=\"支持全屏的api\"></a>支持全屏的api</h3><ol>\n<li>浏览器是否支持全屏模式：<code>document.fullscreenEnabled</code></li>\n<li>使元素进入全屏模式：<code>Element.requestFullscreen()</code></li>\n<li>退出全屏：<code>document.exitFullscreen()</code></li>\n<li>检查当前是否有节点处于全屏状态：<code>document.fullscreenElement</code></li>\n<li>进入全屏&#x2F;离开全屏，触发事件：<code>document.fullscreenchange</code></li>\n<li>无法进入全屏时触发: <code>document.fullscreenerror</code></li>\n</ol>\n<h3 id=\"浏览器前缀：\"><a href=\"#浏览器前缀：\" class=\"headerlink\" title=\"浏览器前缀：\"></a>浏览器前缀：</h3><p>目前并不是所有的浏览器都实现了API的无前缀版本，所以我们需要针对不同浏览器，做一下API的兼容:</p>\n<p>我们需要写成类的形式：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: 是否支持全屏+判断浏览器前缀</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; fn 不支持全屏的回调函数 这里设了一个默认值</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"title function_\">isFullscreen</span>(<span class=\"params\">fn</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> fullscreenEnabled;</span><br><span class=\"line\">  <span class=\"comment\">// 判断浏览器前缀</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">fullscreenEnabled</span>) &#123;</span><br><span class=\"line\">    fullscreenEnabled = <span class=\"variable language_\">document</span>.<span class=\"property\">fullscreenEnabled</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">webkitFullscreenEnabled</span>) &#123;</span><br><span class=\"line\">    fullscreenEnabled = <span class=\"variable language_\">document</span>.<span class=\"property\">webkitFullscreenEnabled</span>;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> = <span class=\"string\">&#x27;webkit&#x27;</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">mozFullScreenEnabled</span>) &#123;</span><br><span class=\"line\">    fullscreenEnabled = <span class=\"variable language_\">document</span>.<span class=\"property\">mozFullScreenEnabled</span>;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> = <span class=\"string\">&#x27;moz&#x27;</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">msFullscreenEnabled</span>) &#123;</span><br><span class=\"line\">    fullscreenEnabled = <span class=\"variable language_\">document</span>.<span class=\"property\">msFullscreenEnabled</span>;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> = <span class=\"string\">&#x27;ms&#x27;</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!fullscreenEnabled) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fn !== <span class=\"literal\">undefined</span>) <span class=\"title function_\">fn</span>(); <span class=\"comment\">// 执行不支持全屏的回调</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">isFullscreenData</span> = <span class=\"literal\">false</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"1-浏览器是否支持全屏模式：document-fullscreenEnabled\"><a href=\"#1-浏览器是否支持全屏模式：document-fullscreenEnabled\" class=\"headerlink\" title=\"1. 浏览器是否支持全屏模式：document.fullscreenEnabled\"></a>1. 浏览器是否支持全屏模式：document.fullscreenEnabled</h3><p><code>document.fullscreenEnabled</code>属性返回一个布尔值，表示当前文档是否可以切换到全屏状态。</p>\n<h3 id=\"2-使元素进入全屏模式：Element-requestFullscreen\"><a href=\"#2-使元素进入全屏模式：Element-requestFullscreen\" class=\"headerlink\" title=\"2. 使元素进入全屏模式：Element.requestFullscreen()\"></a>2. 使元素进入全屏模式：Element.requestFullscreen()</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: 将传进来的元素全屏</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">String</span>&#125; domName 要全屏的dom名称</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"title class_\">Fullscreen</span>(domName) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> element = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(domName); <span class=\"comment\">// 获取dom</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> methodName =</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> === <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">      ? <span class=\"string\">&#x27;requestFullscreen&#x27;</span></span><br><span class=\"line\">      : <span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.prefixName&#125;</span>RequestFullScreen`</span>; <span class=\"comment\">// API前缀</span></span><br><span class=\"line\">  element[methodName](); <span class=\"comment\">// 调用全屏</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-退出全屏：document-exitFullscreen\"><a href=\"#3-退出全屏：document-exitFullscreen\" class=\"headerlink\" title=\"3. 退出全屏：document.exitFullscreen()\"></a>3. 退出全屏：document.exitFullscreen()</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">exitFullscreen</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> methodName =</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> === <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">      ? <span class=\"string\">&#x27;exitFullscreen&#x27;</span></span><br><span class=\"line\">      : <span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.prefixName&#125;</span>ExitFullscreen`</span>; <span class=\"comment\">// API 前缀</span></span><br><span class=\"line\">  <span class=\"variable language_\">document</span>[methodName](); <span class=\"comment\">// 调用</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-检查当前是否有节点处于全屏状态：document-fullscreenElement\"><a href=\"#4-检查当前是否有节点处于全屏状态：document-fullscreenElement\" class=\"headerlink\" title=\"4. 检查当前是否有节点处于全屏状态：document.fullscreenElement\"></a>4. 检查当前是否有节点处于全屏状态：document.fullscreenElement</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: 检测有没有元素处于全屏状态</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> 布尔值</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"title function_\">isElementFullScreen</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> fullscreenElement =</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">fullscreenElement</span> ||</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">msFullscreenElement</span> ||</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">mozFullScreenElement</span> ||</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">webkitFullscreenElement</span>; <span class=\"comment\">// 有前缀的f是大写，没前缀是小写</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (fullscreenElement === <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>; <span class=\"comment\">// 当前没有元素在全屏状态</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>; <span class=\"comment\">// 有元素在全屏状态</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>事实上，还有一个属性<code>document.fullscreen</code>，返回一个布尔值，表示文档是否处于全屏模式。</p>\n<p>两个方法效果是一样，但因为IE不支持这个属性，所以这里用的是<code>document.fullscreenElement</code>.</p>\n<h3 id=\"5-进入全屏-x2F-离开全屏，触发事件：document-fullscreenchange\"><a href=\"#5-进入全屏-x2F-离开全屏，触发事件：document-fullscreenchange\" class=\"headerlink\" title=\"5. 进入全屏&#x2F;离开全屏，触发事件：document.fullscreenchange\"></a>5. 进入全屏&#x2F;离开全屏，触发事件：document.fullscreenchange</h3><p>当我们进入全屏和离开全屏的时候，都会触发一个<code>fullscreenchange</code>事件。</p>\n<blockquote>\n<p>注意：此事件不会提供任何信息，表明是进入全屏或退出全屏。</p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: 监听进入/离开全屏</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; enter 进入全屏的回调</span></span><br><span class=\"line\"><span class=\"comment\"> *  <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; quit 离开全屏的回调</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"title function_\">screenChange</span>(<span class=\"params\">enter,quit</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!<span class=\"variable language_\">this</span>.<span class=\"property\">isFullscreenData</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> methodName = <span class=\"string\">`on<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.prefixName&#125;</span>fullscreenchange`</span>;</span><br><span class=\"line\">  <span class=\"variable language_\">document</span>[methodName] = <span class=\"function\"><span class=\"params\">e</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"title function_\">isElementFullScreen</span>()) &#123;</span><br><span class=\"line\">      enter &amp;&amp; <span class=\"title function_\">enter</span>(e); <span class=\"comment\">// 进入全屏回调</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      quit &amp;&amp; <span class=\"title function_\">quit</span>(e); <span class=\"comment\">// 离开全屏的回调</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：多层全屏的情况</strong></p>\n<ol>\n<li>先进入左边全屏(进入全屏回调)，再进入红色全屏(进入全屏回调)</li>\n<li>退出全屏,此时退出红色全屏，左边仍是全屏(触发进入全屏回调)</li>\n<li>出现这种情况，可以在点击按钮的时候，做一些状态限制。或者根据全屏事件返回的dom信息来进行判断。</li>\n</ol>\n<h3 id=\"6-无法进入全屏时触发-document-fullscreenerror\"><a href=\"#6-无法进入全屏时触发-document-fullscreenerror\" class=\"headerlink\" title=\"6. 无法进入全屏时触发: document.fullscreenerror\"></a>6. 无法进入全屏时触发: document.fullscreenerror</h3><p>比如全屏请求不是在事件处理函数中调用,会在这里拦截到错误:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: 浏览器无法进入全屏时触发</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; enterErrorFn 回调</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"title function_\">screenError</span>(<span class=\"params\">enterErrorFn</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> methodName = <span class=\"string\">`on<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.prefixName&#125;</span>fullscreenerror`</span>;</span><br><span class=\"line\">  <span class=\"variable language_\">document</span>[methodName] = <span class=\"function\"><span class=\"params\">e</span> =&gt;</span> &#123;</span><br><span class=\"line\">    enterErrorFn &amp;&amp; <span class=\"title function_\">enterErrorFn</span>(e)</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Css：-全屏模式下的样式\"><a href=\"#Css：-全屏模式下的样式\" class=\"headerlink\" title=\"Css： 全屏模式下的样式\"></a>Css： 全屏模式下的样式</h3><ol>\n<li>默认设置黑色背景</li>\n</ol>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-pseudo\">:not</span>(<span class=\"selector-pseudo\">:root</span>):-webkit-full-screen::backdrop &#123;</span><br><span class=\"line\">  <span class=\"attribute\">position</span>: fixed;</span><br><span class=\"line\">  <span class=\"attribute\">top</span>: <span class=\"number\">0px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">right</span>: <span class=\"number\">0px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">bottom</span>: <span class=\"number\">0px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">left</span>: <span class=\"number\">0px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: black; // 会将背景设为黑色的 如果你没为你的dom设置背景的话，全屏下会为黑色</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>默认样式：</li>\n</ol>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-pseudo\">:not</span>(<span class=\"selector-pseudo\">:root</span>):-webkit-full-screen &#123;</span><br><span class=\"line\">  <span class=\"attribute\">object-fit</span>: contain;</span><br><span class=\"line\">  <span class=\"attribute\">position</span>: fixed <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">top</span>: <span class=\"number\">0px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">right</span>: <span class=\"number\">0px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">bottom</span>: <span class=\"number\">0px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">left</span>: <span class=\"number\">0px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">box-sizing</span>: border-box <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">min-width</span>: <span class=\"number\">0px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">max-width</span>: none <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">min-height</span>: <span class=\"number\">0px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">max-height</span>: none <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">100%</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">100%</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">transform</span>: none <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">0px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"全屏状态的CSS：\"><a href=\"#全屏状态的CSS：\" class=\"headerlink\" title=\"全屏状态的CSS：\"></a>全屏状态的CSS：</h3><p>全屏状态下，大多数浏览器的CSS支持:full-screen伪类，只有IE11支持:fullscreen伪类。使用这个伪类，可以对全屏状态设置单独的CSS属性。</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 针对dom的全屏设置 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.div</span>:-webkit-full-screen &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/* 全屏属性 */</span></span><br><span class=\"line\">:-webkit-full-screen &#123;&#125;</span><br><span class=\"line\">:-moz-full-screen &#123;&#125;</span><br><span class=\"line\">:-ms-fullscreen &#123;&#125;</span><br><span class=\"line\"><span class=\"comment\">/* 全屏伪类 当前chrome:70 不支持 */</span></span><br><span class=\"line\">:full-screen &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-pseudo\">:fullscreen</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">/* IE11支持 */</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>参考资料：阮一峰老师的<a href=\"https://javascript.ruanyifeng.com/htmlapi/fullscreen.html#toc0\">Fullscreen API：全屏操作</a></p>\n<p>这里是一条华丽的分割线，讲完原理开始实战</p>\n<hr>\n<h3 id=\"项目的html\"><a href=\"#项目的html\" class=\"headerlink\" title=\"项目的html\"></a>项目的html</h3><p>index.html：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">&quot;X-UA-Compatible&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;viewport&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">&quot;stylesheet&quot;</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;./index.css&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Document<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">iframe</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://codesandbox.io/s/&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;iframe-one&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;iframe-one</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">      width=&quot;</span> <span class=\"attr\">100</span>%&quot; <span class=\"attr\">height</span>=<span class=\"string\">&quot;200&quot;</span> <span class=\"attr\">scrolling</span>=<span class=\"string\">&quot;no&quot;</span> <span class=\"attr\">frameborder</span>=<span class=\"string\">&quot;0&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">iframe</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;vscode.svg&quot;</span> <span class=\"attr\">onclick</span>=<span class=\"string\">&quot;iframeScreen()&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;vscode&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;100&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;100&quot;</span> <span class=\"attr\">alt</span>=<span class=\"string\">&quot;&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;./index.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"项目中的css\"><a href=\"#项目中的css\" class=\"headerlink\" title=\"项目中的css\"></a>项目中的css</h3><p>index.css：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-id\">#iframe-one</span> &#123;  // 随便是什么元素，一开始不展示元素</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/* 针对dom的全屏设置 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.left</span>:-webkit-full-screen &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/* 全屏属性 */</span></span><br><span class=\"line\">:-webkit-full-screen &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">:-moz-full-screen &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">:-ms-fullscreen &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/* 全屏伪类 当前chrome:70 不支持 */</span></span><br><span class=\"line\">:full-screen &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-pseudo\">:fullscreen</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">/* IE11支持 */</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"封装完成的js文件\"><a href=\"#封装完成的js文件\" class=\"headerlink\" title=\"封装完成的js文件\"></a>封装完成的js文件</h3><p>以后无论遇到什么全屏问题都可以用改封装得class</p>\n<p>index.js：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">fullScreen</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">constructor</span>(<span class=\"params\">fn</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// fn是失败的回调函数</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> = <span class=\"string\">&#x27;&#x27;</span>; <span class=\"comment\">// 浏览器前缀</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">isFullscreenData</span> = <span class=\"literal\">true</span>; <span class=\"comment\">// 浏览器支持全屏</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"title function_\">isFullscreen</span>(fn);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@description</span>: 是否支持全屏+判断浏览器前缀</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; fn 不支持全屏的回调函数 这里设了一个默认值</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"title function_\">isFullscreen</span>(<span class=\"params\">fn</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> fullscreenEnabled; <span class=\"comment\">// 是否支持全屏</span></span><br><span class=\"line\">    <span class=\"comment\">// 判断浏览器前缀</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">fullscreenEnabled</span>) &#123;</span><br><span class=\"line\">      fullscreenEnabled = <span class=\"variable language_\">document</span>.<span class=\"property\">fullscreenEnabled</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">webkitFullscreenEnabled</span>) &#123;</span><br><span class=\"line\">      fullscreenEnabled = <span class=\"variable language_\">document</span>.<span class=\"property\">webkitFullscreenEnabled</span>;</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> = <span class=\"string\">&#x27;webkit&#x27;</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">mozFullScreenEnabled</span>) &#123;</span><br><span class=\"line\">      fullscreenEnabled = <span class=\"variable language_\">document</span>.<span class=\"property\">mozFullScreenEnabled</span>;</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> = <span class=\"string\">&#x27;moz&#x27;</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">msFullscreenEnabled</span>) &#123;</span><br><span class=\"line\">      fullscreenEnabled = <span class=\"variable language_\">document</span>.<span class=\"property\">msFullscreenEnabled</span>;</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> = <span class=\"string\">&#x27;ms&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!fullscreenEnabled) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (fn !== <span class=\"literal\">undefined</span>) <span class=\"title function_\">fn</span>(); <span class=\"comment\">// 执行不支持全屏的回调</span></span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">isFullscreenData</span> = <span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@description</span>: 将传进来的元素全屏</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">String</span>&#125; domName 要全屏的dom名称</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"title class_\">Fullscreen</span>(element) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> methodName =</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> === <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">        ? <span class=\"string\">&#x27;requestFullscreen&#x27;</span></span><br><span class=\"line\">        : <span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.prefixName&#125;</span>RequestFullScreen`</span>; <span class=\"comment\">// API前缀</span></span><br><span class=\"line\">    element[methodName](); <span class=\"comment\">// 调用全屏</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 退出全屏</span></span><br><span class=\"line\">  <span class=\"title function_\">exitFullscreen</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> methodName =</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> === <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">        ? <span class=\"string\">&#x27;exitFullscreen&#x27;</span></span><br><span class=\"line\">        : <span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.prefixName&#125;</span>ExitFullscreen`</span>; <span class=\"comment\">// API 前缀</span></span><br><span class=\"line\">    <span class=\"variable language_\">document</span>[methodName](); <span class=\"comment\">// 调用</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@description</span>: 检测有没有元素处于全屏状态</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@return</span> 布尔值</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"title function_\">isElementFullScreen</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> fullscreenElement =</span><br><span class=\"line\">      <span class=\"variable language_\">document</span>.<span class=\"property\">fullscreenElement</span> ||</span><br><span class=\"line\">      <span class=\"variable language_\">document</span>.<span class=\"property\">msFullscreenElement</span> ||</span><br><span class=\"line\">      <span class=\"variable language_\">document</span>.<span class=\"property\">mozFullScreenElement</span> ||</span><br><span class=\"line\">      <span class=\"variable language_\">document</span>.<span class=\"property\">webkitFullscreenElement</span>; <span class=\"comment\">// 有前缀的f是大写，没前缀是小写</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fullscreenElement === <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">false</span>; <span class=\"comment\">// 当前没有元素在全屏状态</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">true</span>; <span class=\"comment\">// 有元素在全屏状态</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@description</span>: 监听进入/离开全屏</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; enter 进入全屏的回调</span></span><br><span class=\"line\"><span class=\"comment\">   *  <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; quit 离开全屏的回调</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"title function_\">screenChange</span>(<span class=\"params\">enter, quit</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"variable language_\">this</span>.<span class=\"property\">isFullscreenData</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> methodName = <span class=\"string\">`on<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.prefixName&#125;</span>fullscreenchange`</span>;</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>[methodName] = <span class=\"function\">(<span class=\"params\">e</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(e);</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"title function_\">isElementFullScreen</span>()) &#123;</span><br><span class=\"line\">        enter &amp;&amp; <span class=\"title function_\">enter</span>(); <span class=\"comment\">// 进入全屏回调</span></span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        quit &amp;&amp; <span class=\"title function_\">quit</span>(); <span class=\"comment\">// 离开全屏的回调</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@description</span>: 浏览器无法进入全屏时触发</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; enterErrorFn 回调</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"title function_\">screenError</span>(<span class=\"params\">enterErrorFn</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> methodName = <span class=\"string\">`on<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.prefixName&#125;</span>fullscreenerror`</span>;</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>[methodName] = <span class=\"function\">(<span class=\"params\">e</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      enterErrorFn &amp;&amp; <span class=\"title function_\">enterErrorFn</span>(e);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"对元素一开始显示或者隐藏处理\"><a href=\"#对元素一开始显示或者隐藏处理\" class=\"headerlink\" title=\"对元素一开始显示或者隐藏处理\"></a>对元素一开始显示或者隐藏处理</h3><p>这里可以这样处理调用<code>screenChange</code>方法，里面执行进入屏幕的回调和离开屏幕的回调，既进入显示，离开隐藏</p>\n<p>index.js：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> full = <span class=\"keyword\">new</span> <span class=\"title function_\">fullScreen</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;不支持&#x27;</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> iframe = &#123;</span><br><span class=\"line\">  <span class=\"attr\">enter</span>: <span class=\"keyword\">function</span> (<span class=\"params\">element</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 显示</span></span><br><span class=\"line\">    element.<span class=\"property\">style</span>.<span class=\"property\">display</span> = <span class=\"string\">&#x27;block&#x27;</span>;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">quit</span>: <span class=\"keyword\">function</span> (<span class=\"params\">element</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 隐藏</span></span><br><span class=\"line\">    element.<span class=\"property\">style</span>.<span class=\"property\">display</span> = <span class=\"string\">&#x27;none&#x27;</span>;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">iframeScreen</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> element = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;#iframe-one&#x27;</span>);</span><br><span class=\"line\">  full.<span class=\"title class_\">Fullscreen</span>(element);</span><br><span class=\"line\">  full.<span class=\"title function_\">screenChange</span>(</span><br><span class=\"line\">    <span class=\"function\">() =&gt;</span> iframe.<span class=\"title function_\">enter</span>(element),</span><br><span class=\"line\">    <span class=\"function\">() =&gt;</span> iframe.<span class=\"title function_\">quit</span>(element)</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"封装class一次性解决实现全屏功能\"><a href=\"#封装class一次性解决实现全屏功能\" class=\"headerlink\" title=\"封装class一次性解决实现全屏功能\"></a>封装class一次性解决实现全屏功能</h1><h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>这里先给项目地址：<a href=\"https://github.com/kangkang123269/kate-demo/tree/main/html5/fullScreen-demo\">地址</a></p>\n<h3 id=\"支持全屏的api\"><a href=\"#支持全屏的api\" class=\"headerlink\" title=\"支持全屏的api\"></a>支持全屏的api</h3><ol>\n<li>浏览器是否支持全屏模式：<code>document.fullscreenEnabled</code></li>\n<li>使元素进入全屏模式：<code>Element.requestFullscreen()</code></li>\n<li>退出全屏：<code>document.exitFullscreen()</code></li>\n<li>检查当前是否有节点处于全屏状态：<code>document.fullscreenElement</code></li>\n<li>进入全屏&#x2F;离开全屏，触发事件：<code>document.fullscreenchange</code></li>\n<li>无法进入全屏时触发: <code>document.fullscreenerror</code></li>\n</ol>\n<h3 id=\"浏览器前缀：\"><a href=\"#浏览器前缀：\" class=\"headerlink\" title=\"浏览器前缀：\"></a>浏览器前缀：</h3><p>目前并不是所有的浏览器都实现了API的无前缀版本，所以我们需要针对不同浏览器，做一下API的兼容:</p>\n<p>我们需要写成类的形式：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: 是否支持全屏+判断浏览器前缀</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; fn 不支持全屏的回调函数 这里设了一个默认值</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"title function_\">isFullscreen</span>(<span class=\"params\">fn</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> fullscreenEnabled;</span><br><span class=\"line\">  <span class=\"comment\">// 判断浏览器前缀</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">fullscreenEnabled</span>) &#123;</span><br><span class=\"line\">    fullscreenEnabled = <span class=\"variable language_\">document</span>.<span class=\"property\">fullscreenEnabled</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">webkitFullscreenEnabled</span>) &#123;</span><br><span class=\"line\">    fullscreenEnabled = <span class=\"variable language_\">document</span>.<span class=\"property\">webkitFullscreenEnabled</span>;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> = <span class=\"string\">&#x27;webkit&#x27;</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">mozFullScreenEnabled</span>) &#123;</span><br><span class=\"line\">    fullscreenEnabled = <span class=\"variable language_\">document</span>.<span class=\"property\">mozFullScreenEnabled</span>;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> = <span class=\"string\">&#x27;moz&#x27;</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">msFullscreenEnabled</span>) &#123;</span><br><span class=\"line\">    fullscreenEnabled = <span class=\"variable language_\">document</span>.<span class=\"property\">msFullscreenEnabled</span>;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> = <span class=\"string\">&#x27;ms&#x27;</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!fullscreenEnabled) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fn !== <span class=\"literal\">undefined</span>) <span class=\"title function_\">fn</span>(); <span class=\"comment\">// 执行不支持全屏的回调</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">isFullscreenData</span> = <span class=\"literal\">false</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"1-浏览器是否支持全屏模式：document-fullscreenEnabled\"><a href=\"#1-浏览器是否支持全屏模式：document-fullscreenEnabled\" class=\"headerlink\" title=\"1. 浏览器是否支持全屏模式：document.fullscreenEnabled\"></a>1. 浏览器是否支持全屏模式：document.fullscreenEnabled</h3><p><code>document.fullscreenEnabled</code>属性返回一个布尔值，表示当前文档是否可以切换到全屏状态。</p>\n<h3 id=\"2-使元素进入全屏模式：Element-requestFullscreen\"><a href=\"#2-使元素进入全屏模式：Element-requestFullscreen\" class=\"headerlink\" title=\"2. 使元素进入全屏模式：Element.requestFullscreen()\"></a>2. 使元素进入全屏模式：Element.requestFullscreen()</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: 将传进来的元素全屏</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">String</span>&#125; domName 要全屏的dom名称</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"title class_\">Fullscreen</span>(domName) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> element = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(domName); <span class=\"comment\">// 获取dom</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> methodName =</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> === <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">      ? <span class=\"string\">&#x27;requestFullscreen&#x27;</span></span><br><span class=\"line\">      : <span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.prefixName&#125;</span>RequestFullScreen`</span>; <span class=\"comment\">// API前缀</span></span><br><span class=\"line\">  element[methodName](); <span class=\"comment\">// 调用全屏</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-退出全屏：document-exitFullscreen\"><a href=\"#3-退出全屏：document-exitFullscreen\" class=\"headerlink\" title=\"3. 退出全屏：document.exitFullscreen()\"></a>3. 退出全屏：document.exitFullscreen()</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">exitFullscreen</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> methodName =</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> === <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">      ? <span class=\"string\">&#x27;exitFullscreen&#x27;</span></span><br><span class=\"line\">      : <span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.prefixName&#125;</span>ExitFullscreen`</span>; <span class=\"comment\">// API 前缀</span></span><br><span class=\"line\">  <span class=\"variable language_\">document</span>[methodName](); <span class=\"comment\">// 调用</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-检查当前是否有节点处于全屏状态：document-fullscreenElement\"><a href=\"#4-检查当前是否有节点处于全屏状态：document-fullscreenElement\" class=\"headerlink\" title=\"4. 检查当前是否有节点处于全屏状态：document.fullscreenElement\"></a>4. 检查当前是否有节点处于全屏状态：document.fullscreenElement</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: 检测有没有元素处于全屏状态</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> 布尔值</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"title function_\">isElementFullScreen</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> fullscreenElement =</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">fullscreenElement</span> ||</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">msFullscreenElement</span> ||</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">mozFullScreenElement</span> ||</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">webkitFullscreenElement</span>; <span class=\"comment\">// 有前缀的f是大写，没前缀是小写</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (fullscreenElement === <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>; <span class=\"comment\">// 当前没有元素在全屏状态</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>; <span class=\"comment\">// 有元素在全屏状态</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>事实上，还有一个属性<code>document.fullscreen</code>，返回一个布尔值，表示文档是否处于全屏模式。</p>\n<p>两个方法效果是一样，但因为IE不支持这个属性，所以这里用的是<code>document.fullscreenElement</code>.</p>\n<h3 id=\"5-进入全屏-x2F-离开全屏，触发事件：document-fullscreenchange\"><a href=\"#5-进入全屏-x2F-离开全屏，触发事件：document-fullscreenchange\" class=\"headerlink\" title=\"5. 进入全屏&#x2F;离开全屏，触发事件：document.fullscreenchange\"></a>5. 进入全屏&#x2F;离开全屏，触发事件：document.fullscreenchange</h3><p>当我们进入全屏和离开全屏的时候，都会触发一个<code>fullscreenchange</code>事件。</p>\n<blockquote>\n<p>注意：此事件不会提供任何信息，表明是进入全屏或退出全屏。</p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: 监听进入/离开全屏</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; enter 进入全屏的回调</span></span><br><span class=\"line\"><span class=\"comment\"> *  <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; quit 离开全屏的回调</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"title function_\">screenChange</span>(<span class=\"params\">enter,quit</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!<span class=\"variable language_\">this</span>.<span class=\"property\">isFullscreenData</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> methodName = <span class=\"string\">`on<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.prefixName&#125;</span>fullscreenchange`</span>;</span><br><span class=\"line\">  <span class=\"variable language_\">document</span>[methodName] = <span class=\"function\"><span class=\"params\">e</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"title function_\">isElementFullScreen</span>()) &#123;</span><br><span class=\"line\">      enter &amp;&amp; <span class=\"title function_\">enter</span>(e); <span class=\"comment\">// 进入全屏回调</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      quit &amp;&amp; <span class=\"title function_\">quit</span>(e); <span class=\"comment\">// 离开全屏的回调</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：多层全屏的情况</strong></p>\n<ol>\n<li>先进入左边全屏(进入全屏回调)，再进入红色全屏(进入全屏回调)</li>\n<li>退出全屏,此时退出红色全屏，左边仍是全屏(触发进入全屏回调)</li>\n<li>出现这种情况，可以在点击按钮的时候，做一些状态限制。或者根据全屏事件返回的dom信息来进行判断。</li>\n</ol>\n<h3 id=\"6-无法进入全屏时触发-document-fullscreenerror\"><a href=\"#6-无法进入全屏时触发-document-fullscreenerror\" class=\"headerlink\" title=\"6. 无法进入全屏时触发: document.fullscreenerror\"></a>6. 无法进入全屏时触发: document.fullscreenerror</h3><p>比如全屏请求不是在事件处理函数中调用,会在这里拦截到错误:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: 浏览器无法进入全屏时触发</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; enterErrorFn 回调</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"title function_\">screenError</span>(<span class=\"params\">enterErrorFn</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> methodName = <span class=\"string\">`on<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.prefixName&#125;</span>fullscreenerror`</span>;</span><br><span class=\"line\">  <span class=\"variable language_\">document</span>[methodName] = <span class=\"function\"><span class=\"params\">e</span> =&gt;</span> &#123;</span><br><span class=\"line\">    enterErrorFn &amp;&amp; <span class=\"title function_\">enterErrorFn</span>(e)</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Css：-全屏模式下的样式\"><a href=\"#Css：-全屏模式下的样式\" class=\"headerlink\" title=\"Css： 全屏模式下的样式\"></a>Css： 全屏模式下的样式</h3><ol>\n<li>默认设置黑色背景</li>\n</ol>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-pseudo\">:not</span>(<span class=\"selector-pseudo\">:root</span>):-webkit-full-screen::backdrop &#123;</span><br><span class=\"line\">  <span class=\"attribute\">position</span>: fixed;</span><br><span class=\"line\">  <span class=\"attribute\">top</span>: <span class=\"number\">0px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">right</span>: <span class=\"number\">0px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">bottom</span>: <span class=\"number\">0px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">left</span>: <span class=\"number\">0px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: black; // 会将背景设为黑色的 如果你没为你的dom设置背景的话，全屏下会为黑色</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>默认样式：</li>\n</ol>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-pseudo\">:not</span>(<span class=\"selector-pseudo\">:root</span>):-webkit-full-screen &#123;</span><br><span class=\"line\">  <span class=\"attribute\">object-fit</span>: contain;</span><br><span class=\"line\">  <span class=\"attribute\">position</span>: fixed <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">top</span>: <span class=\"number\">0px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">right</span>: <span class=\"number\">0px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">bottom</span>: <span class=\"number\">0px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">left</span>: <span class=\"number\">0px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">box-sizing</span>: border-box <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">min-width</span>: <span class=\"number\">0px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">max-width</span>: none <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">min-height</span>: <span class=\"number\">0px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">max-height</span>: none <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">100%</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">100%</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">transform</span>: none <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">0px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"全屏状态的CSS：\"><a href=\"#全屏状态的CSS：\" class=\"headerlink\" title=\"全屏状态的CSS：\"></a>全屏状态的CSS：</h3><p>全屏状态下，大多数浏览器的CSS支持:full-screen伪类，只有IE11支持:fullscreen伪类。使用这个伪类，可以对全屏状态设置单独的CSS属性。</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 针对dom的全屏设置 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.div</span>:-webkit-full-screen &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/* 全屏属性 */</span></span><br><span class=\"line\">:-webkit-full-screen &#123;&#125;</span><br><span class=\"line\">:-moz-full-screen &#123;&#125;</span><br><span class=\"line\">:-ms-fullscreen &#123;&#125;</span><br><span class=\"line\"><span class=\"comment\">/* 全屏伪类 当前chrome:70 不支持 */</span></span><br><span class=\"line\">:full-screen &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-pseudo\">:fullscreen</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">/* IE11支持 */</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>参考资料：阮一峰老师的<a href=\"https://javascript.ruanyifeng.com/htmlapi/fullscreen.html#toc0\">Fullscreen API：全屏操作</a></p>\n<p>这里是一条华丽的分割线，讲完原理开始实战</p>\n<hr>\n<h3 id=\"项目的html\"><a href=\"#项目的html\" class=\"headerlink\" title=\"项目的html\"></a>项目的html</h3><p>index.html：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">&quot;X-UA-Compatible&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;viewport&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">&quot;stylesheet&quot;</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;./index.css&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Document<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">iframe</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://codesandbox.io/s/&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;iframe-one&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;iframe-one</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">      width=&quot;</span> <span class=\"attr\">100</span>%&quot; <span class=\"attr\">height</span>=<span class=\"string\">&quot;200&quot;</span> <span class=\"attr\">scrolling</span>=<span class=\"string\">&quot;no&quot;</span> <span class=\"attr\">frameborder</span>=<span class=\"string\">&quot;0&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">iframe</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;vscode.svg&quot;</span> <span class=\"attr\">onclick</span>=<span class=\"string\">&quot;iframeScreen()&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;vscode&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;100&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;100&quot;</span> <span class=\"attr\">alt</span>=<span class=\"string\">&quot;&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;./index.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"项目中的css\"><a href=\"#项目中的css\" class=\"headerlink\" title=\"项目中的css\"></a>项目中的css</h3><p>index.css：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-id\">#iframe-one</span> &#123;  // 随便是什么元素，一开始不展示元素</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/* 针对dom的全屏设置 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.left</span>:-webkit-full-screen &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/* 全屏属性 */</span></span><br><span class=\"line\">:-webkit-full-screen &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">:-moz-full-screen &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">:-ms-fullscreen &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/* 全屏伪类 当前chrome:70 不支持 */</span></span><br><span class=\"line\">:full-screen &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-pseudo\">:fullscreen</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">/* IE11支持 */</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"封装完成的js文件\"><a href=\"#封装完成的js文件\" class=\"headerlink\" title=\"封装完成的js文件\"></a>封装完成的js文件</h3><p>以后无论遇到什么全屏问题都可以用改封装得class</p>\n<p>index.js：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">fullScreen</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">constructor</span>(<span class=\"params\">fn</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// fn是失败的回调函数</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> = <span class=\"string\">&#x27;&#x27;</span>; <span class=\"comment\">// 浏览器前缀</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">isFullscreenData</span> = <span class=\"literal\">true</span>; <span class=\"comment\">// 浏览器支持全屏</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"title function_\">isFullscreen</span>(fn);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@description</span>: 是否支持全屏+判断浏览器前缀</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; fn 不支持全屏的回调函数 这里设了一个默认值</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"title function_\">isFullscreen</span>(<span class=\"params\">fn</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> fullscreenEnabled; <span class=\"comment\">// 是否支持全屏</span></span><br><span class=\"line\">    <span class=\"comment\">// 判断浏览器前缀</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">fullscreenEnabled</span>) &#123;</span><br><span class=\"line\">      fullscreenEnabled = <span class=\"variable language_\">document</span>.<span class=\"property\">fullscreenEnabled</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">webkitFullscreenEnabled</span>) &#123;</span><br><span class=\"line\">      fullscreenEnabled = <span class=\"variable language_\">document</span>.<span class=\"property\">webkitFullscreenEnabled</span>;</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> = <span class=\"string\">&#x27;webkit&#x27;</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">mozFullScreenEnabled</span>) &#123;</span><br><span class=\"line\">      fullscreenEnabled = <span class=\"variable language_\">document</span>.<span class=\"property\">mozFullScreenEnabled</span>;</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> = <span class=\"string\">&#x27;moz&#x27;</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">msFullscreenEnabled</span>) &#123;</span><br><span class=\"line\">      fullscreenEnabled = <span class=\"variable language_\">document</span>.<span class=\"property\">msFullscreenEnabled</span>;</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> = <span class=\"string\">&#x27;ms&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!fullscreenEnabled) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (fn !== <span class=\"literal\">undefined</span>) <span class=\"title function_\">fn</span>(); <span class=\"comment\">// 执行不支持全屏的回调</span></span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">isFullscreenData</span> = <span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@description</span>: 将传进来的元素全屏</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">String</span>&#125; domName 要全屏的dom名称</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"title class_\">Fullscreen</span>(element) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> methodName =</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> === <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">        ? <span class=\"string\">&#x27;requestFullscreen&#x27;</span></span><br><span class=\"line\">        : <span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.prefixName&#125;</span>RequestFullScreen`</span>; <span class=\"comment\">// API前缀</span></span><br><span class=\"line\">    element[methodName](); <span class=\"comment\">// 调用全屏</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 退出全屏</span></span><br><span class=\"line\">  <span class=\"title function_\">exitFullscreen</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> methodName =</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">prefixName</span> === <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">        ? <span class=\"string\">&#x27;exitFullscreen&#x27;</span></span><br><span class=\"line\">        : <span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.prefixName&#125;</span>ExitFullscreen`</span>; <span class=\"comment\">// API 前缀</span></span><br><span class=\"line\">    <span class=\"variable language_\">document</span>[methodName](); <span class=\"comment\">// 调用</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@description</span>: 检测有没有元素处于全屏状态</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@return</span> 布尔值</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"title function_\">isElementFullScreen</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> fullscreenElement =</span><br><span class=\"line\">      <span class=\"variable language_\">document</span>.<span class=\"property\">fullscreenElement</span> ||</span><br><span class=\"line\">      <span class=\"variable language_\">document</span>.<span class=\"property\">msFullscreenElement</span> ||</span><br><span class=\"line\">      <span class=\"variable language_\">document</span>.<span class=\"property\">mozFullScreenElement</span> ||</span><br><span class=\"line\">      <span class=\"variable language_\">document</span>.<span class=\"property\">webkitFullscreenElement</span>; <span class=\"comment\">// 有前缀的f是大写，没前缀是小写</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fullscreenElement === <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">false</span>; <span class=\"comment\">// 当前没有元素在全屏状态</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">true</span>; <span class=\"comment\">// 有元素在全屏状态</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@description</span>: 监听进入/离开全屏</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; enter 进入全屏的回调</span></span><br><span class=\"line\"><span class=\"comment\">   *  <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; quit 离开全屏的回调</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"title function_\">screenChange</span>(<span class=\"params\">enter, quit</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"variable language_\">this</span>.<span class=\"property\">isFullscreenData</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> methodName = <span class=\"string\">`on<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.prefixName&#125;</span>fullscreenchange`</span>;</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>[methodName] = <span class=\"function\">(<span class=\"params\">e</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(e);</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"title function_\">isElementFullScreen</span>()) &#123;</span><br><span class=\"line\">        enter &amp;&amp; <span class=\"title function_\">enter</span>(); <span class=\"comment\">// 进入全屏回调</span></span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        quit &amp;&amp; <span class=\"title function_\">quit</span>(); <span class=\"comment\">// 离开全屏的回调</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@description</span>: 浏览器无法进入全屏时触发</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; enterErrorFn 回调</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"title function_\">screenError</span>(<span class=\"params\">enterErrorFn</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> methodName = <span class=\"string\">`on<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.prefixName&#125;</span>fullscreenerror`</span>;</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>[methodName] = <span class=\"function\">(<span class=\"params\">e</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      enterErrorFn &amp;&amp; <span class=\"title function_\">enterErrorFn</span>(e);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"对元素一开始显示或者隐藏处理\"><a href=\"#对元素一开始显示或者隐藏处理\" class=\"headerlink\" title=\"对元素一开始显示或者隐藏处理\"></a>对元素一开始显示或者隐藏处理</h3><p>这里可以这样处理调用<code>screenChange</code>方法，里面执行进入屏幕的回调和离开屏幕的回调，既进入显示，离开隐藏</p>\n<p>index.js：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> full = <span class=\"keyword\">new</span> <span class=\"title function_\">fullScreen</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;不支持&#x27;</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> iframe = &#123;</span><br><span class=\"line\">  <span class=\"attr\">enter</span>: <span class=\"keyword\">function</span> (<span class=\"params\">element</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 显示</span></span><br><span class=\"line\">    element.<span class=\"property\">style</span>.<span class=\"property\">display</span> = <span class=\"string\">&#x27;block&#x27;</span>;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">quit</span>: <span class=\"keyword\">function</span> (<span class=\"params\">element</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 隐藏</span></span><br><span class=\"line\">    element.<span class=\"property\">style</span>.<span class=\"property\">display</span> = <span class=\"string\">&#x27;none&#x27;</span>;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">iframeScreen</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> element = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;#iframe-one&#x27;</span>);</span><br><span class=\"line\">  full.<span class=\"title class_\">Fullscreen</span>(element);</span><br><span class=\"line\">  full.<span class=\"title function_\">screenChange</span>(</span><br><span class=\"line\">    <span class=\"function\">() =&gt;</span> iframe.<span class=\"title function_\">enter</span>(element),</span><br><span class=\"line\">    <span class=\"function\">() =&gt;</span> iframe.<span class=\"title function_\">quit</span>(element)</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n"},{"title":"生成任意文件","description":"生成任意文件","date":"2022-08-27T16:00:00.000Z","cover":"https://urlify.cn/zuyyUz","_content":"\n# 生成任意文件\n\n**思路**：\n\n- 用Blob对象生成任意格式数据\n- Blob对象通过createObjectURL方法生成链接\n- 用a标签下载任意格式数据\n- 释放相对于的链接\n\n**核心代码**：\n~~~js\n// 要保存的字符串\nconst stringData = '# 一级标题\\n## 二级标题'\n// stringData 表示要转换的字符串数据，type 表示要转换的数据格式\nconst blob = new Blob([stringData], {\n    type: 'text/markdown'\n})\n// 根据 blob生成 url链接\nconst objectURL = URL.createObjectURL(blob)\n\n// 创建一个 a 标签Tag\nconst aTag = document.createElement('a')\n// 设置文件的下载地址\naTag.href = objectURL\n// 设置保存后的文件名称\naTag.download = \"markdown文件.md\"\n// 给 a 标签添加点击事件\naTag.click()\n// 释放一个之前已经存在的、通过调用 URL.createObjectURL() 创建的 URL 对象。\n// 当你结束使用某个 URL 对象之后，应该通过调用这个方法来让浏览器知道不用在内存中继续保留对这个文件的引用了。\nURL.revokeObjectURL(objectURL)\n~~~\n\n**demo实例**：\n~~~html\n<!DOCTYPE html>\n<html>\n    <head>\n        <meta charset=\"utf-8\">\n        <title>保存文件</title>\n    </head>\n    <body>\n        <button type=\"button\" id=\"button\"> 保存文件</button>\n\n        <script type=\"text/javascript\">\n            window.onload = function(event) {\n                main()\n            }\n            function main() {\n                // 获取按钮\n                const button = document.getElementById('button')\n                // 给按钮添加点击事件\n                button.onclick = () => {\n                    // 要保存的字符串\n                    const stringData = '# 一级标题\\n## 二级标题'\n                    // dada 表示要转换的字符串数据，type 表示要转换的数据格式\n                    const blob = new Blob([stringData], {\n                        type: 'text/markdown'\n                    })\n                    // 根据 blob生成 url链接\n                    const objectURL = URL.createObjectURL(blob)\n\n                    // 创建一个 a 标签Tag\n                    const aTag = document.createElement('a')\n                    // 设置文件的下载地址\n                    aTag.href = objectURL\n                    // 设置保存后的文件名称\n                    aTag.download = \"markdown文件.md\"\n                    // 给 a 标签添加点击事件\n                    aTag.click()\n                    // 释放一个之前已经存在的、通过调用 URL.createObjectURL() 创建的 URL 对象。\n                    // 当你结束使用某个 URL 对象之后，应该通过调用这个方法来让浏览器知道不用在内存中继续保留对这个文件的引用了。\n                    URL.revokeObjectURL(objectURL)\n                }\n            }\n        </script>\n    </body>\n</html>\n~~~","source":"_posts/html5/生成任意文件.md","raw":"\n---\ntitle: 生成任意文件\ntags: [前端]\ncategories: [html]\ndescription: 生成任意文件\ndate: 2022-08-28\ncover: https://urlify.cn/zuyyUz\n---\n\n# 生成任意文件\n\n**思路**：\n\n- 用Blob对象生成任意格式数据\n- Blob对象通过createObjectURL方法生成链接\n- 用a标签下载任意格式数据\n- 释放相对于的链接\n\n**核心代码**：\n~~~js\n// 要保存的字符串\nconst stringData = '# 一级标题\\n## 二级标题'\n// stringData 表示要转换的字符串数据，type 表示要转换的数据格式\nconst blob = new Blob([stringData], {\n    type: 'text/markdown'\n})\n// 根据 blob生成 url链接\nconst objectURL = URL.createObjectURL(blob)\n\n// 创建一个 a 标签Tag\nconst aTag = document.createElement('a')\n// 设置文件的下载地址\naTag.href = objectURL\n// 设置保存后的文件名称\naTag.download = \"markdown文件.md\"\n// 给 a 标签添加点击事件\naTag.click()\n// 释放一个之前已经存在的、通过调用 URL.createObjectURL() 创建的 URL 对象。\n// 当你结束使用某个 URL 对象之后，应该通过调用这个方法来让浏览器知道不用在内存中继续保留对这个文件的引用了。\nURL.revokeObjectURL(objectURL)\n~~~\n\n**demo实例**：\n~~~html\n<!DOCTYPE html>\n<html>\n    <head>\n        <meta charset=\"utf-8\">\n        <title>保存文件</title>\n    </head>\n    <body>\n        <button type=\"button\" id=\"button\"> 保存文件</button>\n\n        <script type=\"text/javascript\">\n            window.onload = function(event) {\n                main()\n            }\n            function main() {\n                // 获取按钮\n                const button = document.getElementById('button')\n                // 给按钮添加点击事件\n                button.onclick = () => {\n                    // 要保存的字符串\n                    const stringData = '# 一级标题\\n## 二级标题'\n                    // dada 表示要转换的字符串数据，type 表示要转换的数据格式\n                    const blob = new Blob([stringData], {\n                        type: 'text/markdown'\n                    })\n                    // 根据 blob生成 url链接\n                    const objectURL = URL.createObjectURL(blob)\n\n                    // 创建一个 a 标签Tag\n                    const aTag = document.createElement('a')\n                    // 设置文件的下载地址\n                    aTag.href = objectURL\n                    // 设置保存后的文件名称\n                    aTag.download = \"markdown文件.md\"\n                    // 给 a 标签添加点击事件\n                    aTag.click()\n                    // 释放一个之前已经存在的、通过调用 URL.createObjectURL() 创建的 URL 对象。\n                    // 当你结束使用某个 URL 对象之后，应该通过调用这个方法来让浏览器知道不用在内存中继续保留对这个文件的引用了。\n                    URL.revokeObjectURL(objectURL)\n                }\n            }\n        </script>\n    </body>\n</html>\n~~~","slug":"html5/生成任意文件","published":1,"updated":"2022-10-12T02:50:25.544Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl95206c600093no245k7eh5o","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><h1 id=\"生成任意文件\"><a href=\"#生成任意文件\" class=\"headerlink\" title=\"生成任意文件\"></a>生成任意文件</h1><p><strong>思路</strong>：</p>\n<ul>\n<li>用Blob对象生成任意格式数据</li>\n<li>Blob对象通过createObjectURL方法生成链接</li>\n<li>用a标签下载任意格式数据</li>\n<li>释放相对于的链接</li>\n</ul>\n<p><strong>核心代码</strong>：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 要保存的字符串</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> stringData = <span class=\"string\">&#x27;# 一级标题\\n## 二级标题&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// stringData 表示要转换的字符串数据，type 表示要转换的数据格式</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> blob = <span class=\"keyword\">new</span> <span class=\"title class_\">Blob</span>([stringData], &#123;</span><br><span class=\"line\">    <span class=\"attr\">type</span>: <span class=\"string\">&#x27;text/markdown&#x27;</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"comment\">// 根据 blob生成 url链接</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> objectURL = <span class=\"variable constant_\">URL</span>.<span class=\"title function_\">createObjectURL</span>(blob)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 创建一个 a 标签Tag</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> aTag = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;a&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">// 设置文件的下载地址</span></span><br><span class=\"line\">aTag.<span class=\"property\">href</span> = objectURL</span><br><span class=\"line\"><span class=\"comment\">// 设置保存后的文件名称</span></span><br><span class=\"line\">aTag.<span class=\"property\">download</span> = <span class=\"string\">&quot;markdown文件.md&quot;</span></span><br><span class=\"line\"><span class=\"comment\">// 给 a 标签添加点击事件</span></span><br><span class=\"line\">aTag.<span class=\"title function_\">click</span>()</span><br><span class=\"line\"><span class=\"comment\">// 释放一个之前已经存在的、通过调用 URL.createObjectURL() 创建的 URL 对象。</span></span><br><span class=\"line\"><span class=\"comment\">// 当你结束使用某个 URL 对象之后，应该通过调用这个方法来让浏览器知道不用在内存中继续保留对这个文件的引用了。</span></span><br><span class=\"line\"><span class=\"variable constant_\">URL</span>.<span class=\"title function_\">revokeObjectURL</span>(objectURL)</span><br></pre></td></tr></table></figure>\n\n<p><strong>demo实例</strong>：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;utf-8&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>保存文件<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;button&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;button&quot;</span>&gt;</span> 保存文件<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/javascript&quot;</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"variable language_\">window</span>.<span class=\"property\">onload</span> = <span class=\"keyword\">function</span>(<span class=\"params\">event</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"title function_\">main</span>()</span></span><br><span class=\"line\"><span class=\"language-javascript\">            &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">function</span> <span class=\"title function_\">main</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"comment\">// 获取按钮</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">const</span> button = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&#x27;button&#x27;</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"comment\">// 给按钮添加点击事件</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                button.<span class=\"property\">onclick</span> = <span class=\"function\">() =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// 要保存的字符串</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"keyword\">const</span> stringData = <span class=\"string\">&#x27;# 一级标题\\n## 二级标题&#x27;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// dada 表示要转换的字符串数据，type 表示要转换的数据格式</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"keyword\">const</span> blob = <span class=\"keyword\">new</span> <span class=\"title class_\">Blob</span>([stringData], &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;text/markdown&#x27;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    &#125;)</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// 根据 blob生成 url链接</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"keyword\">const</span> objectURL = <span class=\"variable constant_\">URL</span>.<span class=\"title function_\">createObjectURL</span>(blob)</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// 创建一个 a 标签Tag</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"keyword\">const</span> aTag = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;a&#x27;</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// 设置文件的下载地址</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    aTag.<span class=\"property\">href</span> = objectURL</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// 设置保存后的文件名称</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    aTag.<span class=\"property\">download</span> = <span class=\"string\">&quot;markdown文件.md&quot;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// 给 a 标签添加点击事件</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    aTag.<span class=\"title function_\">click</span>()</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// 释放一个之前已经存在的、通过调用 URL.createObjectURL() 创建的 URL 对象。</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// 当你结束使用某个 URL 对象之后，应该通过调用这个方法来让浏览器知道不用在内存中继续保留对这个文件的引用了。</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"variable constant_\">URL</span>.<span class=\"title function_\">revokeObjectURL</span>(objectURL)</span></span><br><span class=\"line\"><span class=\"language-javascript\">                &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"生成任意文件\"><a href=\"#生成任意文件\" class=\"headerlink\" title=\"生成任意文件\"></a>生成任意文件</h1><p><strong>思路</strong>：</p>\n<ul>\n<li>用Blob对象生成任意格式数据</li>\n<li>Blob对象通过createObjectURL方法生成链接</li>\n<li>用a标签下载任意格式数据</li>\n<li>释放相对于的链接</li>\n</ul>\n<p><strong>核心代码</strong>：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 要保存的字符串</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> stringData = <span class=\"string\">&#x27;# 一级标题\\n## 二级标题&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// stringData 表示要转换的字符串数据，type 表示要转换的数据格式</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> blob = <span class=\"keyword\">new</span> <span class=\"title class_\">Blob</span>([stringData], &#123;</span><br><span class=\"line\">    <span class=\"attr\">type</span>: <span class=\"string\">&#x27;text/markdown&#x27;</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"comment\">// 根据 blob生成 url链接</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> objectURL = <span class=\"variable constant_\">URL</span>.<span class=\"title function_\">createObjectURL</span>(blob)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 创建一个 a 标签Tag</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> aTag = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;a&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">// 设置文件的下载地址</span></span><br><span class=\"line\">aTag.<span class=\"property\">href</span> = objectURL</span><br><span class=\"line\"><span class=\"comment\">// 设置保存后的文件名称</span></span><br><span class=\"line\">aTag.<span class=\"property\">download</span> = <span class=\"string\">&quot;markdown文件.md&quot;</span></span><br><span class=\"line\"><span class=\"comment\">// 给 a 标签添加点击事件</span></span><br><span class=\"line\">aTag.<span class=\"title function_\">click</span>()</span><br><span class=\"line\"><span class=\"comment\">// 释放一个之前已经存在的、通过调用 URL.createObjectURL() 创建的 URL 对象。</span></span><br><span class=\"line\"><span class=\"comment\">// 当你结束使用某个 URL 对象之后，应该通过调用这个方法来让浏览器知道不用在内存中继续保留对这个文件的引用了。</span></span><br><span class=\"line\"><span class=\"variable constant_\">URL</span>.<span class=\"title function_\">revokeObjectURL</span>(objectURL)</span><br></pre></td></tr></table></figure>\n\n<p><strong>demo实例</strong>：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;utf-8&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>保存文件<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;button&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;button&quot;</span>&gt;</span> 保存文件<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/javascript&quot;</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"variable language_\">window</span>.<span class=\"property\">onload</span> = <span class=\"keyword\">function</span>(<span class=\"params\">event</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"title function_\">main</span>()</span></span><br><span class=\"line\"><span class=\"language-javascript\">            &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">function</span> <span class=\"title function_\">main</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"comment\">// 获取按钮</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">const</span> button = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&#x27;button&#x27;</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"comment\">// 给按钮添加点击事件</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                button.<span class=\"property\">onclick</span> = <span class=\"function\">() =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// 要保存的字符串</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"keyword\">const</span> stringData = <span class=\"string\">&#x27;# 一级标题\\n## 二级标题&#x27;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// dada 表示要转换的字符串数据，type 表示要转换的数据格式</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"keyword\">const</span> blob = <span class=\"keyword\">new</span> <span class=\"title class_\">Blob</span>([stringData], &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;text/markdown&#x27;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    &#125;)</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// 根据 blob生成 url链接</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"keyword\">const</span> objectURL = <span class=\"variable constant_\">URL</span>.<span class=\"title function_\">createObjectURL</span>(blob)</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// 创建一个 a 标签Tag</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"keyword\">const</span> aTag = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;a&#x27;</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// 设置文件的下载地址</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    aTag.<span class=\"property\">href</span> = objectURL</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// 设置保存后的文件名称</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    aTag.<span class=\"property\">download</span> = <span class=\"string\">&quot;markdown文件.md&quot;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// 给 a 标签添加点击事件</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    aTag.<span class=\"title function_\">click</span>()</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// 释放一个之前已经存在的、通过调用 URL.createObjectURL() 创建的 URL 对象。</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"comment\">// 当你结束使用某个 URL 对象之后，应该通过调用这个方法来让浏览器知道不用在内存中继续保留对这个文件的引用了。</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"variable constant_\">URL</span>.<span class=\"title function_\">revokeObjectURL</span>(objectURL)</span></span><br><span class=\"line\"><span class=\"language-javascript\">                &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>"},{"title":"学习React-dnd","date":"2022-07-26T16:00:00.000Z","description":"学习React-dnd, 写了一个例子和一个demo.","cover":"https://urlify.cn/B3uiUv","_content":"# 用 React Hooks 的方式使用 react-dnd\n\n## 一、用 DndProvider 将根节点包裹起来\n\n想要使用 react-dnd 进行拖拽操作，需要用 DndProvider 标签将根节点包裹起来，并传入一个 backend 参数： index.tsx 文件\n\n~~~tsx\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { DndProvider } from 'react-dnd';\nimport HTMLBackend from 'react-dnd-html5-backend'\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n    <DndProvider backend={ HTMLBackend }>\n        <App />\n    </DndProvider>,\n    document.getElementById('root'));\n~~~\n\n## 二、让元素可以动起来\n\n1. 创建 Box 组件\n2. 让 Box 组件动起来\n\n就简单创建一个BOX组件，这里我们需要用到react-dnd的useDrag方法， 这里通过把第二参数赋值给ref，Box组件就能动起来，至于为什么，以后会给讲\n源码\n\n~~~tsx\nimport React, { CSSProperties } from 'react';\nimport { useDrag } from 'react-dnd';\nconst style: CSSProperties = {\n  width: 200,\n  height: 50,\n  lineHeight: '50px',\n  background: 'pink',\n  margin: '30px auto',\n};\n\nconst Box = () => {\n    const [, drager] = useDrag({\n        type: 'Box'\n    })\n  return (<div ref={drager} style={style}>可拖拽组件 Box</div>);\n};\n\nexport default Box;\n~~~\n\n## 三、创建 Dustbin 组件用来接收 drag 组件\n\n~~~tsx\nimport React, { CSSProperties } from 'react';\nimport { useDrop, DropTargetMonitor } from 'react-dnd';\n\nconst style: CSSProperties = {\n    width: 400,\n    height: 400,\n    margin: '100px auto',\n    lineHeight: '60px',\n    border: '1px dashed black'\n}\n\nconst Dustbin = () => {\n    // 第一个参数是 collect 方法返回的对象，第二个参数是一个 ref 值，赋值给 drop 元素\n    const [collectProps, droper] = useDrop({\n        // accept 是一个标识，需要和对应的 drag 元素中 item 的 type 值一致，否则不能感应\n        accept: 'Box',\n        // collect 函数，返回的对象会成为 useDrop 的第一个参数，可以在组件中直接进行使用\n        collect: (minoter: DropTargetMonitor) => ({\n            isOver: minoter.isOver()\n        })\n    })\n    const bg = collectProps.isOver ? 'deeppink' : 'white';\n    const content = collectProps.isOver ? '快松开，放到碗里来' : '将 Box 组件拖动到这里'\n    return (\n        // 将 droper 赋值给对应元素的 ref\n        <div ref={ droper } style={{ ...style, background: bg }}>{ content }</div>\n    )\n}\n\nexport default Dustbin;\n~~~\n\n## 四、效果图\n\n![image-20220727143704700](/img/react-dnd/image-20220727143704700.png)\n\n## 五、其它一些api\n\n- drag 组件常用的属性：\n  - item：是一个对象，必须要有一个 type 属性\n  - begin(mintor: DragSourceMonitor)：组件开始拖拽，必须返回一个对象包含 type 属性，会覆盖 item 属性返回的对象，会被传入 drop 组件 hover 和 drop 方法的第一个参数\n  - end(item, mintor: DragSourceMonitor)： 组件停止拖拽时触发，item 是 drop 组件在 drop 方法执行时返回的对象，等同于 mintor.getDropResult() 的值\n\n\n\n\n- drop 组件常用的属性\n  - accept：字符串，必须和对应 drag 组件的 item 属性中的 type 值一致\n  - hover(item, minoter: DropTargetMonitor)：drag 组件在 drop 组件上方 hove 时触发\n  - drop(item, minoter: DropTargetMonitor)：drag 组件拖拽结束后，放到 drop 组件时触发，返回的值会作为参数传递给 drag 组件 end 方法的第一个参数\n\n\n- 让组件既可以被拖拽也可以接收拖拽元素\n\n~~~tsx\nimport React, { useRef } from 'react';\nimport { useDrag, useDrop } from 'react-dnd';\n\nconst Card = () => {\n  const ref = useRef<HTMLDivElement>(null);\n\n  const [, drop] = useDrop({\n    accept: 'Card',\n    drop(item) {\n      console.log(item);\n    },\n  });\n\n  const [, drag] = useDrag({\n    type: 'Card',\n    item: { id: '1' },\n    end(draggedItem, monitor) {\n      console.log(draggedItem, monitor);\n    },\n  });\n\n  // 使用 drag 和 drop 包装 ref\n  drag(drop(ref));\n\n  // 将变量 ref 传给元素的 ref 即可\n  return <div ref={ref}>既可以被拖动也可以接收拖动组件</div>;\n};\n\nexport default Card;\n\n~~~\n\n## 一个更复杂的 Demo 演示\n\n![demo](/img/react-dnd/%E6%8B%96%E6%8B%BD%E5%B9%B6%E6%8E%92%E5%BA%8F%E9%A2%84%E8%A7%88.gif)\n\nDemo 地址\n\n[react-dnd-hooks-demo](https://github.com/kangkang123269/kate-demo/tree/main/react-dnd-hooks-demo)","source":"_posts/react/学习react-dnd.md","raw":"---\ntitle: 学习React-dnd\ntags: [前端,react-dnd]\ncategories: [react]\ndate: 2022-07-27\ndescription: 学习React-dnd, 写了一个例子和一个demo.\ncover: https://urlify.cn/B3uiUv\n---\n# 用 React Hooks 的方式使用 react-dnd\n\n## 一、用 DndProvider 将根节点包裹起来\n\n想要使用 react-dnd 进行拖拽操作，需要用 DndProvider 标签将根节点包裹起来，并传入一个 backend 参数： index.tsx 文件\n\n~~~tsx\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { DndProvider } from 'react-dnd';\nimport HTMLBackend from 'react-dnd-html5-backend'\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n    <DndProvider backend={ HTMLBackend }>\n        <App />\n    </DndProvider>,\n    document.getElementById('root'));\n~~~\n\n## 二、让元素可以动起来\n\n1. 创建 Box 组件\n2. 让 Box 组件动起来\n\n就简单创建一个BOX组件，这里我们需要用到react-dnd的useDrag方法， 这里通过把第二参数赋值给ref，Box组件就能动起来，至于为什么，以后会给讲\n源码\n\n~~~tsx\nimport React, { CSSProperties } from 'react';\nimport { useDrag } from 'react-dnd';\nconst style: CSSProperties = {\n  width: 200,\n  height: 50,\n  lineHeight: '50px',\n  background: 'pink',\n  margin: '30px auto',\n};\n\nconst Box = () => {\n    const [, drager] = useDrag({\n        type: 'Box'\n    })\n  return (<div ref={drager} style={style}>可拖拽组件 Box</div>);\n};\n\nexport default Box;\n~~~\n\n## 三、创建 Dustbin 组件用来接收 drag 组件\n\n~~~tsx\nimport React, { CSSProperties } from 'react';\nimport { useDrop, DropTargetMonitor } from 'react-dnd';\n\nconst style: CSSProperties = {\n    width: 400,\n    height: 400,\n    margin: '100px auto',\n    lineHeight: '60px',\n    border: '1px dashed black'\n}\n\nconst Dustbin = () => {\n    // 第一个参数是 collect 方法返回的对象，第二个参数是一个 ref 值，赋值给 drop 元素\n    const [collectProps, droper] = useDrop({\n        // accept 是一个标识，需要和对应的 drag 元素中 item 的 type 值一致，否则不能感应\n        accept: 'Box',\n        // collect 函数，返回的对象会成为 useDrop 的第一个参数，可以在组件中直接进行使用\n        collect: (minoter: DropTargetMonitor) => ({\n            isOver: minoter.isOver()\n        })\n    })\n    const bg = collectProps.isOver ? 'deeppink' : 'white';\n    const content = collectProps.isOver ? '快松开，放到碗里来' : '将 Box 组件拖动到这里'\n    return (\n        // 将 droper 赋值给对应元素的 ref\n        <div ref={ droper } style={{ ...style, background: bg }}>{ content }</div>\n    )\n}\n\nexport default Dustbin;\n~~~\n\n## 四、效果图\n\n![image-20220727143704700](/img/react-dnd/image-20220727143704700.png)\n\n## 五、其它一些api\n\n- drag 组件常用的属性：\n  - item：是一个对象，必须要有一个 type 属性\n  - begin(mintor: DragSourceMonitor)：组件开始拖拽，必须返回一个对象包含 type 属性，会覆盖 item 属性返回的对象，会被传入 drop 组件 hover 和 drop 方法的第一个参数\n  - end(item, mintor: DragSourceMonitor)： 组件停止拖拽时触发，item 是 drop 组件在 drop 方法执行时返回的对象，等同于 mintor.getDropResult() 的值\n\n\n\n\n- drop 组件常用的属性\n  - accept：字符串，必须和对应 drag 组件的 item 属性中的 type 值一致\n  - hover(item, minoter: DropTargetMonitor)：drag 组件在 drop 组件上方 hove 时触发\n  - drop(item, minoter: DropTargetMonitor)：drag 组件拖拽结束后，放到 drop 组件时触发，返回的值会作为参数传递给 drag 组件 end 方法的第一个参数\n\n\n- 让组件既可以被拖拽也可以接收拖拽元素\n\n~~~tsx\nimport React, { useRef } from 'react';\nimport { useDrag, useDrop } from 'react-dnd';\n\nconst Card = () => {\n  const ref = useRef<HTMLDivElement>(null);\n\n  const [, drop] = useDrop({\n    accept: 'Card',\n    drop(item) {\n      console.log(item);\n    },\n  });\n\n  const [, drag] = useDrag({\n    type: 'Card',\n    item: { id: '1' },\n    end(draggedItem, monitor) {\n      console.log(draggedItem, monitor);\n    },\n  });\n\n  // 使用 drag 和 drop 包装 ref\n  drag(drop(ref));\n\n  // 将变量 ref 传给元素的 ref 即可\n  return <div ref={ref}>既可以被拖动也可以接收拖动组件</div>;\n};\n\nexport default Card;\n\n~~~\n\n## 一个更复杂的 Demo 演示\n\n![demo](/img/react-dnd/%E6%8B%96%E6%8B%BD%E5%B9%B6%E6%8E%92%E5%BA%8F%E9%A2%84%E8%A7%88.gif)\n\nDemo 地址\n\n[react-dnd-hooks-demo](https://github.com/kangkang123269/kate-demo/tree/main/react-dnd-hooks-demo)","slug":"react/学习react-dnd","published":1,"updated":"2022-10-12T02:50:25.545Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl95206c8000b3no2a95qg30y","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><h1 id=\"用-React-Hooks-的方式使用-react-dnd\"><a href=\"#用-React-Hooks-的方式使用-react-dnd\" class=\"headerlink\" title=\"用 React Hooks 的方式使用 react-dnd\"></a>用 React Hooks 的方式使用 react-dnd</h1><h2 id=\"一、用-DndProvider-将根节点包裹起来\"><a href=\"#一、用-DndProvider-将根节点包裹起来\" class=\"headerlink\" title=\"一、用 DndProvider 将根节点包裹起来\"></a>一、用 DndProvider 将根节点包裹起来</h2><p>想要使用 react-dnd 进行拖拽操作，需要用 DndProvider 标签将根节点包裹起来，并传入一个 backend 参数： index.tsx 文件</p>\n<figure class=\"highlight tsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">ReactDOM</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-dom&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">DndProvider</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-dnd&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">HTMLBackend</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-dnd-html5-backend&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">&#x27;./index.css&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">App</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./App&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title class_\">ReactDOM</span>.<span class=\"title function_\">render</span>(</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">DndProvider</span> <span class=\"attr\">backend</span>=<span class=\"string\">&#123;</span> <span class=\"attr\">HTMLBackend</span> &#125;&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">App</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">DndProvider</span>&gt;</span></span>,</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&#x27;root&#x27;</span>));</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"二、让元素可以动起来\"><a href=\"#二、让元素可以动起来\" class=\"headerlink\" title=\"二、让元素可以动起来\"></a>二、让元素可以动起来</h2><ol>\n<li>创建 Box 组件</li>\n<li>让 Box 组件动起来</li>\n</ol>\n<p>就简单创建一个BOX组件，这里我们需要用到react-dnd的useDrag方法， 这里通过把第二参数赋值给ref，Box组件就能动起来，至于为什么，以后会给讲<br>源码</p>\n<figure class=\"highlight tsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span>, &#123; <span class=\"title class_\">CSSProperties</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; useDrag &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-dnd&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"attr\">style</span>: <span class=\"title class_\">CSSProperties</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">width</span>: <span class=\"number\">200</span>,</span><br><span class=\"line\">  <span class=\"attr\">height</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">  <span class=\"attr\">lineHeight</span>: <span class=\"string\">&#x27;50px&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">background</span>: <span class=\"string\">&#x27;pink&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">margin</span>: <span class=\"string\">&#x27;30px auto&#x27;</span>,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">Box</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> [, drager] = <span class=\"title function_\">useDrag</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;Box&#x27;</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (<span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">ref</span>=<span class=\"string\">&#123;drager&#125;</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;style&#125;</span>&gt;</span>可拖拽组件 Box<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span>);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title class_\">Box</span>;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"三、创建-Dustbin-组件用来接收-drag-组件\"><a href=\"#三、创建-Dustbin-组件用来接收-drag-组件\" class=\"headerlink\" title=\"三、创建 Dustbin 组件用来接收 drag 组件\"></a>三、创建 Dustbin 组件用来接收 drag 组件</h2><figure class=\"highlight tsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span>, &#123; <span class=\"title class_\">CSSProperties</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; useDrop, <span class=\"title class_\">DropTargetMonitor</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-dnd&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"attr\">style</span>: <span class=\"title class_\">CSSProperties</span> = &#123;</span><br><span class=\"line\">    <span class=\"attr\">width</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">    <span class=\"attr\">height</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">    <span class=\"attr\">margin</span>: <span class=\"string\">&#x27;100px auto&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">lineHeight</span>: <span class=\"string\">&#x27;60px&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">border</span>: <span class=\"string\">&#x27;1px dashed black&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">Dustbin</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 第一个参数是 collect 方法返回的对象，第二个参数是一个 ref 值，赋值给 drop 元素</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> [collectProps, droper] = <span class=\"title function_\">useDrop</span>(&#123;</span><br><span class=\"line\">        <span class=\"comment\">// accept 是一个标识，需要和对应的 drag 元素中 item 的 type 值一致，否则不能感应</span></span><br><span class=\"line\">        <span class=\"attr\">accept</span>: <span class=\"string\">&#x27;Box&#x27;</span>,</span><br><span class=\"line\">        <span class=\"comment\">// collect 函数，返回的对象会成为 useDrop 的第一个参数，可以在组件中直接进行使用</span></span><br><span class=\"line\">        <span class=\"attr\">collect</span>: <span class=\"function\">(<span class=\"params\">minoter: DropTargetMonitor</span>) =&gt;</span> (&#123;</span><br><span class=\"line\">            <span class=\"attr\">isOver</span>: minoter.<span class=\"title function_\">isOver</span>()</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    <span class=\"keyword\">const</span> bg = collectProps.<span class=\"property\">isOver</span> ? <span class=\"string\">&#x27;deeppink&#x27;</span> : <span class=\"string\">&#x27;white&#x27;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> content = collectProps.<span class=\"property\">isOver</span> ? <span class=\"string\">&#x27;快松开，放到碗里来&#x27;</span> : <span class=\"string\">&#x27;将 Box 组件拖动到这里&#x27;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">        <span class=\"comment\">// 将 droper 赋值给对应元素的 ref</span></span><br><span class=\"line\">        <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">ref</span>=<span class=\"string\">&#123;</span> <span class=\"attr\">droper</span> &#125; <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;</span> <span class=\"attr\">...style</span>, <span class=\"attr\">background:</span> <span class=\"attr\">bg</span> &#125;&#125;&gt;</span>&#123; content &#125;<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">    )</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title class_\">Dustbin</span>;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"四、效果图\"><a href=\"#四、效果图\" class=\"headerlink\" title=\"四、效果图\"></a>四、效果图</h2><p><img src=\"/img/react-dnd/image-20220727143704700.png\" alt=\"image-20220727143704700\"></p>\n<h2 id=\"五、其它一些api\"><a href=\"#五、其它一些api\" class=\"headerlink\" title=\"五、其它一些api\"></a>五、其它一些api</h2><ul>\n<li><p>drag 组件常用的属性：</p>\n<ul>\n<li>item：是一个对象，必须要有一个 type 属性</li>\n<li>begin(mintor: DragSourceMonitor)：组件开始拖拽，必须返回一个对象包含 type 属性，会覆盖 item 属性返回的对象，会被传入 drop 组件 hover 和 drop 方法的第一个参数</li>\n<li>end(item, mintor: DragSourceMonitor)： 组件停止拖拽时触发，item 是 drop 组件在 drop 方法执行时返回的对象，等同于 mintor.getDropResult() 的值</li>\n</ul>\n</li>\n<li><p>drop 组件常用的属性</p>\n<ul>\n<li>accept：字符串，必须和对应 drag 组件的 item 属性中的 type 值一致</li>\n<li>hover(item, minoter: DropTargetMonitor)：drag 组件在 drop 组件上方 hove 时触发</li>\n<li>drop(item, minoter: DropTargetMonitor)：drag 组件拖拽结束后，放到 drop 组件时触发，返回的值会作为参数传递给 drag 组件 end 方法的第一个参数</li>\n</ul>\n</li>\n<li><p>让组件既可以被拖拽也可以接收拖拽元素</p>\n</li>\n</ul>\n<figure class=\"highlight tsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span>, &#123; useRef &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; useDrag, useDrop &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-dnd&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">Card</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> ref = useRef&lt;<span class=\"title class_\">HTMLDivElement</span>&gt;(<span class=\"literal\">null</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">const</span> [, drop] = <span class=\"title function_\">useDrop</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">accept</span>: <span class=\"string\">&#x27;Card&#x27;</span>,</span><br><span class=\"line\">    <span class=\"title function_\">drop</span>(<span class=\"params\">item</span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(item);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">const</span> [, drag] = <span class=\"title function_\">useDrag</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">type</span>: <span class=\"string\">&#x27;Card&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">item</span>: &#123; <span class=\"attr\">id</span>: <span class=\"string\">&#x27;1&#x27;</span> &#125;,</span><br><span class=\"line\">    <span class=\"title function_\">end</span>(<span class=\"params\">draggedItem, monitor</span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(draggedItem, monitor);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 使用 drag 和 drop 包装 ref</span></span><br><span class=\"line\">  <span class=\"title function_\">drag</span>(<span class=\"title function_\">drop</span>(ref));</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 将变量 ref 传给元素的 ref 即可</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">ref</span>=<span class=\"string\">&#123;ref&#125;</span>&gt;</span>既可以被拖动也可以接收拖动组件<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title class_\">Card</span>;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"一个更复杂的-Demo-演示\"><a href=\"#一个更复杂的-Demo-演示\" class=\"headerlink\" title=\"一个更复杂的 Demo 演示\"></a>一个更复杂的 Demo 演示</h2><p><img src=\"/img/react-dnd/%E6%8B%96%E6%8B%BD%E5%B9%B6%E6%8E%92%E5%BA%8F%E9%A2%84%E8%A7%88.gif\" alt=\"demo\"></p>\n<p>Demo 地址</p>\n<p><a href=\"https://github.com/kangkang123269/kate-demo/tree/main/react-dnd-hooks-demo\">react-dnd-hooks-demo</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"用-React-Hooks-的方式使用-react-dnd\"><a href=\"#用-React-Hooks-的方式使用-react-dnd\" class=\"headerlink\" title=\"用 React Hooks 的方式使用 react-dnd\"></a>用 React Hooks 的方式使用 react-dnd</h1><h2 id=\"一、用-DndProvider-将根节点包裹起来\"><a href=\"#一、用-DndProvider-将根节点包裹起来\" class=\"headerlink\" title=\"一、用 DndProvider 将根节点包裹起来\"></a>一、用 DndProvider 将根节点包裹起来</h2><p>想要使用 react-dnd 进行拖拽操作，需要用 DndProvider 标签将根节点包裹起来，并传入一个 backend 参数： index.tsx 文件</p>\n<figure class=\"highlight tsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">ReactDOM</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-dom&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">DndProvider</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-dnd&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">HTMLBackend</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-dnd-html5-backend&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">&#x27;./index.css&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">App</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./App&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title class_\">ReactDOM</span>.<span class=\"title function_\">render</span>(</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">DndProvider</span> <span class=\"attr\">backend</span>=<span class=\"string\">&#123;</span> <span class=\"attr\">HTMLBackend</span> &#125;&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">App</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">DndProvider</span>&gt;</span></span>,</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&#x27;root&#x27;</span>));</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"二、让元素可以动起来\"><a href=\"#二、让元素可以动起来\" class=\"headerlink\" title=\"二、让元素可以动起来\"></a>二、让元素可以动起来</h2><ol>\n<li>创建 Box 组件</li>\n<li>让 Box 组件动起来</li>\n</ol>\n<p>就简单创建一个BOX组件，这里我们需要用到react-dnd的useDrag方法， 这里通过把第二参数赋值给ref，Box组件就能动起来，至于为什么，以后会给讲<br>源码</p>\n<figure class=\"highlight tsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span>, &#123; <span class=\"title class_\">CSSProperties</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; useDrag &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-dnd&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"attr\">style</span>: <span class=\"title class_\">CSSProperties</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">width</span>: <span class=\"number\">200</span>,</span><br><span class=\"line\">  <span class=\"attr\">height</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">  <span class=\"attr\">lineHeight</span>: <span class=\"string\">&#x27;50px&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">background</span>: <span class=\"string\">&#x27;pink&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">margin</span>: <span class=\"string\">&#x27;30px auto&#x27;</span>,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">Box</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> [, drager] = <span class=\"title function_\">useDrag</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;Box&#x27;</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (<span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">ref</span>=<span class=\"string\">&#123;drager&#125;</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;style&#125;</span>&gt;</span>可拖拽组件 Box<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span>);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title class_\">Box</span>;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"三、创建-Dustbin-组件用来接收-drag-组件\"><a href=\"#三、创建-Dustbin-组件用来接收-drag-组件\" class=\"headerlink\" title=\"三、创建 Dustbin 组件用来接收 drag 组件\"></a>三、创建 Dustbin 组件用来接收 drag 组件</h2><figure class=\"highlight tsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span>, &#123; <span class=\"title class_\">CSSProperties</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; useDrop, <span class=\"title class_\">DropTargetMonitor</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-dnd&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"attr\">style</span>: <span class=\"title class_\">CSSProperties</span> = &#123;</span><br><span class=\"line\">    <span class=\"attr\">width</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">    <span class=\"attr\">height</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">    <span class=\"attr\">margin</span>: <span class=\"string\">&#x27;100px auto&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">lineHeight</span>: <span class=\"string\">&#x27;60px&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">border</span>: <span class=\"string\">&#x27;1px dashed black&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">Dustbin</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 第一个参数是 collect 方法返回的对象，第二个参数是一个 ref 值，赋值给 drop 元素</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> [collectProps, droper] = <span class=\"title function_\">useDrop</span>(&#123;</span><br><span class=\"line\">        <span class=\"comment\">// accept 是一个标识，需要和对应的 drag 元素中 item 的 type 值一致，否则不能感应</span></span><br><span class=\"line\">        <span class=\"attr\">accept</span>: <span class=\"string\">&#x27;Box&#x27;</span>,</span><br><span class=\"line\">        <span class=\"comment\">// collect 函数，返回的对象会成为 useDrop 的第一个参数，可以在组件中直接进行使用</span></span><br><span class=\"line\">        <span class=\"attr\">collect</span>: <span class=\"function\">(<span class=\"params\">minoter: DropTargetMonitor</span>) =&gt;</span> (&#123;</span><br><span class=\"line\">            <span class=\"attr\">isOver</span>: minoter.<span class=\"title function_\">isOver</span>()</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    <span class=\"keyword\">const</span> bg = collectProps.<span class=\"property\">isOver</span> ? <span class=\"string\">&#x27;deeppink&#x27;</span> : <span class=\"string\">&#x27;white&#x27;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> content = collectProps.<span class=\"property\">isOver</span> ? <span class=\"string\">&#x27;快松开，放到碗里来&#x27;</span> : <span class=\"string\">&#x27;将 Box 组件拖动到这里&#x27;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">        <span class=\"comment\">// 将 droper 赋值给对应元素的 ref</span></span><br><span class=\"line\">        <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">ref</span>=<span class=\"string\">&#123;</span> <span class=\"attr\">droper</span> &#125; <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;</span> <span class=\"attr\">...style</span>, <span class=\"attr\">background:</span> <span class=\"attr\">bg</span> &#125;&#125;&gt;</span>&#123; content &#125;<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">    )</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title class_\">Dustbin</span>;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"四、效果图\"><a href=\"#四、效果图\" class=\"headerlink\" title=\"四、效果图\"></a>四、效果图</h2><p><img src=\"/img/react-dnd/image-20220727143704700.png\" alt=\"image-20220727143704700\"></p>\n<h2 id=\"五、其它一些api\"><a href=\"#五、其它一些api\" class=\"headerlink\" title=\"五、其它一些api\"></a>五、其它一些api</h2><ul>\n<li><p>drag 组件常用的属性：</p>\n<ul>\n<li>item：是一个对象，必须要有一个 type 属性</li>\n<li>begin(mintor: DragSourceMonitor)：组件开始拖拽，必须返回一个对象包含 type 属性，会覆盖 item 属性返回的对象，会被传入 drop 组件 hover 和 drop 方法的第一个参数</li>\n<li>end(item, mintor: DragSourceMonitor)： 组件停止拖拽时触发，item 是 drop 组件在 drop 方法执行时返回的对象，等同于 mintor.getDropResult() 的值</li>\n</ul>\n</li>\n<li><p>drop 组件常用的属性</p>\n<ul>\n<li>accept：字符串，必须和对应 drag 组件的 item 属性中的 type 值一致</li>\n<li>hover(item, minoter: DropTargetMonitor)：drag 组件在 drop 组件上方 hove 时触发</li>\n<li>drop(item, minoter: DropTargetMonitor)：drag 组件拖拽结束后，放到 drop 组件时触发，返回的值会作为参数传递给 drag 组件 end 方法的第一个参数</li>\n</ul>\n</li>\n<li><p>让组件既可以被拖拽也可以接收拖拽元素</p>\n</li>\n</ul>\n<figure class=\"highlight tsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span>, &#123; useRef &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; useDrag, useDrop &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react-dnd&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">Card</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> ref = useRef&lt;<span class=\"title class_\">HTMLDivElement</span>&gt;(<span class=\"literal\">null</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">const</span> [, drop] = <span class=\"title function_\">useDrop</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">accept</span>: <span class=\"string\">&#x27;Card&#x27;</span>,</span><br><span class=\"line\">    <span class=\"title function_\">drop</span>(<span class=\"params\">item</span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(item);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">const</span> [, drag] = <span class=\"title function_\">useDrag</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">type</span>: <span class=\"string\">&#x27;Card&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">item</span>: &#123; <span class=\"attr\">id</span>: <span class=\"string\">&#x27;1&#x27;</span> &#125;,</span><br><span class=\"line\">    <span class=\"title function_\">end</span>(<span class=\"params\">draggedItem, monitor</span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(draggedItem, monitor);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 使用 drag 和 drop 包装 ref</span></span><br><span class=\"line\">  <span class=\"title function_\">drag</span>(<span class=\"title function_\">drop</span>(ref));</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 将变量 ref 传给元素的 ref 即可</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">ref</span>=<span class=\"string\">&#123;ref&#125;</span>&gt;</span>既可以被拖动也可以接收拖动组件<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title class_\">Card</span>;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"一个更复杂的-Demo-演示\"><a href=\"#一个更复杂的-Demo-演示\" class=\"headerlink\" title=\"一个更复杂的 Demo 演示\"></a>一个更复杂的 Demo 演示</h2><p><img src=\"/img/react-dnd/%E6%8B%96%E6%8B%BD%E5%B9%B6%E6%8E%92%E5%BA%8F%E9%A2%84%E8%A7%88.gif\" alt=\"demo\"></p>\n<p>Demo 地址</p>\n<p><a href=\"https://github.com/kangkang123269/kate-demo/tree/main/react-dnd-hooks-demo\">react-dnd-hooks-demo</a></p>\n"},{"title":"js操作时间的应用","description":"js操作时间的应用","date":"2022-07-31T16:00:00.000Z","cover":"https://urlify.cn/6ZVzIj","_content":"\n\n# js操作时间的应用\n\n1. 获取时间格式化为YY-MM-DD HH:MM:SS\n\n~~~js\nfunction getNowFormatDate() {\n    var date = new Date();\n     \n    var year = date.getFullYear();\n    var month = date.getMonth() + 1;\n    var d = date.getDate();\n    var hour = date.getHours();\n    var minute = date.getMinutes();\n    var second = date.getSeconds();\n     \n    if(month<10){\n        month = \"0\" + month;\n    }\n     \n    if(d<10){\n        d = \"0\" + d;\n    }\n     \n    if(hour<10){\n        hour = \"0\" + hour;\n    }\n     \n    if(minute<10){\n        minute = \"0\" + hour;\n    }\n     \n    if(second<10){\n        second = \"0\" + second;\n    }\n    \n    return year + \"-\" + month + \"-\" + d + \" \" +hour + \":\" + minute + \":\" + second;\n}\n~~~\n\n2. 随机获取订单号\n\n~~~js\n/**\n * @desc 0\n * @param falg代表是否是赠送卡片和收卡界面\n */\n\nfunction getNowFormatDate(flag) {\n    var date = new Date();\n     \n    var year = date.getFullYear();\n    var month = date.getMonth() + 1;\n    var d = date.getDate();\n    var hour = date.getHours();\n    var minute = date.getMinutes();\n    var second = date.getSeconds();\n     \n    if(month<10){\n        month = \"0\" + month;\n    }\n     \n    if(d<10){\n        d = \"0\" + d;\n    }\n     \n    if(hour<10){\n        hour = \"0\" + hour;\n    }\n     \n    if(minute<10){\n        minute = \"0\" + hour;\n    }\n     \n    if(second<10){\n        second = \"0\" + second;\n    }\n    \n    return year + \"-\" + month + \"-\" + d + (flag ? \" \" +hour + \":\" + minute + \":\" + second : \"\");\n}\n~~~\n\n","source":"_posts/skill/js时间操作的应用.md","raw":"---\ntitle: js操作时间的应用\ntags: [前端,JavaScript,skill]\ncategories: [JavaScript]\ndescription: js操作时间的应用\ndate: 2022-08-01\ncover: https://urlify.cn/6ZVzIj\n---\n\n\n# js操作时间的应用\n\n1. 获取时间格式化为YY-MM-DD HH:MM:SS\n\n~~~js\nfunction getNowFormatDate() {\n    var date = new Date();\n     \n    var year = date.getFullYear();\n    var month = date.getMonth() + 1;\n    var d = date.getDate();\n    var hour = date.getHours();\n    var minute = date.getMinutes();\n    var second = date.getSeconds();\n     \n    if(month<10){\n        month = \"0\" + month;\n    }\n     \n    if(d<10){\n        d = \"0\" + d;\n    }\n     \n    if(hour<10){\n        hour = \"0\" + hour;\n    }\n     \n    if(minute<10){\n        minute = \"0\" + hour;\n    }\n     \n    if(second<10){\n        second = \"0\" + second;\n    }\n    \n    return year + \"-\" + month + \"-\" + d + \" \" +hour + \":\" + minute + \":\" + second;\n}\n~~~\n\n2. 随机获取订单号\n\n~~~js\n/**\n * @desc 0\n * @param falg代表是否是赠送卡片和收卡界面\n */\n\nfunction getNowFormatDate(flag) {\n    var date = new Date();\n     \n    var year = date.getFullYear();\n    var month = date.getMonth() + 1;\n    var d = date.getDate();\n    var hour = date.getHours();\n    var minute = date.getMinutes();\n    var second = date.getSeconds();\n     \n    if(month<10){\n        month = \"0\" + month;\n    }\n     \n    if(d<10){\n        d = \"0\" + d;\n    }\n     \n    if(hour<10){\n        hour = \"0\" + hour;\n    }\n     \n    if(minute<10){\n        minute = \"0\" + hour;\n    }\n     \n    if(second<10){\n        second = \"0\" + second;\n    }\n    \n    return year + \"-\" + month + \"-\" + d + (flag ? \" \" +hour + \":\" + minute + \":\" + second : \"\");\n}\n~~~\n\n","slug":"skill/js时间操作的应用","published":1,"updated":"2022-10-12T02:50:25.545Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl95206cc000g3no216y51asw","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><h1 id=\"js操作时间的应用\"><a href=\"#js操作时间的应用\" class=\"headerlink\" title=\"js操作时间的应用\"></a>js操作时间的应用</h1><ol>\n<li>获取时间格式化为YY-MM-DD HH:MM:SS</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">getNowFormatDate</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> date = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>();</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">var</span> year = date.<span class=\"title function_\">getFullYear</span>();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> month = date.<span class=\"title function_\">getMonth</span>() + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> d = date.<span class=\"title function_\">getDate</span>();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> hour = date.<span class=\"title function_\">getHours</span>();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minute = date.<span class=\"title function_\">getMinutes</span>();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> second = date.<span class=\"title function_\">getSeconds</span>();</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(month&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        month = <span class=\"string\">&quot;0&quot;</span> + month;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(d&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        d = <span class=\"string\">&quot;0&quot;</span> + d;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(hour&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        hour = <span class=\"string\">&quot;0&quot;</span> + hour;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(minute&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        minute = <span class=\"string\">&quot;0&quot;</span> + hour;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(second&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        second = <span class=\"string\">&quot;0&quot;</span> + second;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> year + <span class=\"string\">&quot;-&quot;</span> + month + <span class=\"string\">&quot;-&quot;</span> + d + <span class=\"string\">&quot; &quot;</span> +hour + <span class=\"string\">&quot;:&quot;</span> + minute + <span class=\"string\">&quot;:&quot;</span> + second;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>随机获取订单号</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@desc</span> 0</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> falg代表是否是赠送卡片和收卡界面</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">getNowFormatDate</span>(<span class=\"params\">flag</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> date = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>();</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">var</span> year = date.<span class=\"title function_\">getFullYear</span>();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> month = date.<span class=\"title function_\">getMonth</span>() + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> d = date.<span class=\"title function_\">getDate</span>();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> hour = date.<span class=\"title function_\">getHours</span>();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minute = date.<span class=\"title function_\">getMinutes</span>();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> second = date.<span class=\"title function_\">getSeconds</span>();</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(month&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        month = <span class=\"string\">&quot;0&quot;</span> + month;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(d&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        d = <span class=\"string\">&quot;0&quot;</span> + d;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(hour&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        hour = <span class=\"string\">&quot;0&quot;</span> + hour;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(minute&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        minute = <span class=\"string\">&quot;0&quot;</span> + hour;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(second&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        second = <span class=\"string\">&quot;0&quot;</span> + second;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> year + <span class=\"string\">&quot;-&quot;</span> + month + <span class=\"string\">&quot;-&quot;</span> + d + (flag ? <span class=\"string\">&quot; &quot;</span> +hour + <span class=\"string\">&quot;:&quot;</span> + minute + <span class=\"string\">&quot;:&quot;</span> + second : <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"js操作时间的应用\"><a href=\"#js操作时间的应用\" class=\"headerlink\" title=\"js操作时间的应用\"></a>js操作时间的应用</h1><ol>\n<li>获取时间格式化为YY-MM-DD HH:MM:SS</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">getNowFormatDate</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> date = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>();</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">var</span> year = date.<span class=\"title function_\">getFullYear</span>();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> month = date.<span class=\"title function_\">getMonth</span>() + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> d = date.<span class=\"title function_\">getDate</span>();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> hour = date.<span class=\"title function_\">getHours</span>();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minute = date.<span class=\"title function_\">getMinutes</span>();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> second = date.<span class=\"title function_\">getSeconds</span>();</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(month&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        month = <span class=\"string\">&quot;0&quot;</span> + month;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(d&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        d = <span class=\"string\">&quot;0&quot;</span> + d;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(hour&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        hour = <span class=\"string\">&quot;0&quot;</span> + hour;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(minute&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        minute = <span class=\"string\">&quot;0&quot;</span> + hour;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(second&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        second = <span class=\"string\">&quot;0&quot;</span> + second;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> year + <span class=\"string\">&quot;-&quot;</span> + month + <span class=\"string\">&quot;-&quot;</span> + d + <span class=\"string\">&quot; &quot;</span> +hour + <span class=\"string\">&quot;:&quot;</span> + minute + <span class=\"string\">&quot;:&quot;</span> + second;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>随机获取订单号</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@desc</span> 0</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> falg代表是否是赠送卡片和收卡界面</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">getNowFormatDate</span>(<span class=\"params\">flag</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> date = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>();</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">var</span> year = date.<span class=\"title function_\">getFullYear</span>();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> month = date.<span class=\"title function_\">getMonth</span>() + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> d = date.<span class=\"title function_\">getDate</span>();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> hour = date.<span class=\"title function_\">getHours</span>();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minute = date.<span class=\"title function_\">getMinutes</span>();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> second = date.<span class=\"title function_\">getSeconds</span>();</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(month&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        month = <span class=\"string\">&quot;0&quot;</span> + month;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(d&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        d = <span class=\"string\">&quot;0&quot;</span> + d;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(hour&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        hour = <span class=\"string\">&quot;0&quot;</span> + hour;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(minute&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        minute = <span class=\"string\">&quot;0&quot;</span> + hour;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(second&lt;<span class=\"number\">10</span>)&#123;</span><br><span class=\"line\">        second = <span class=\"string\">&quot;0&quot;</span> + second;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> year + <span class=\"string\">&quot;-&quot;</span> + month + <span class=\"string\">&quot;-&quot;</span> + d + (flag ? <span class=\"string\">&quot; &quot;</span> +hour + <span class=\"string\">&quot;:&quot;</span> + minute + <span class=\"string\">&quot;:&quot;</span> + second : <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n"},{"title":"一行代码的JavaScript","description":"一行代码的JavaScript","date":"2022-07-26T16:00:00.000Z","cover":"https://urlify.cn/6ZVzIj","_content":"\n# 一行代码的JavaScript\n\n### 1、获取字符串中的字符数\n\n~~~js\nconst characterCount = (str, char) => str.split(char).length - 1\n~~~\n\n### 2、检查对象是否为空\n\n~~~js\nconst isEmpty = obj => Reflect.ownKeys(obj).length === 0 && obj.constructor === Object\n~~~\n\n### 3、等待一段时间再执行\n\n~~~js\nconst wait = async (milliseconds) => new Promise((resolve) => setTimeout(resolve, milliseconds));\n~~~\n\n### 4、 获取两个日期之间的日差\n\n~~~js\nconst daysBetween = (date1, date2) => Math.ceil(Math.abs(date1 - date2) / (1000 * 60 * 60 * 24))\n~~~\n\n### 5、重定向到另一个 URL\n\n~~~js\nconst redirect = url => location.href = url\n~~~\n\n### 6、检查设备上的触摸支持\n~~~js\nconst touchSupported = () => ('ontouchstart' in window || DocumentTouch && document instanceof DocumentTouch)\n~~~\n\n### 7、 在元素后插入 HTML 字符串\n\n~~~js\nconst insertHTMLAfter = (html, el) => el.insertAdjacentHTML('afterend', html)\n~~~\n\n### 8、随机排列数组\n\n~~~js\nconst shuffle = arr => arr.sort(() => 0.5 - Math.random())\n~~~\n\n### 9、在网页上获取选定的文本\n\n~~~js\nconst getSelectedText = () => window.getSelection().toString()\n~~~\n\n### 10、获取随机布尔值\n\n~~~js\nconst getRandomBoolean = () => Math.random() >= 0.5\n~~~\n\n### 11、计算数组的平均值\n\n~~~js\nconst average = (arr) => arr.reduce((a, b) => a + b) / arr.length\n~~~\n\n\n### 12、数组扁平化\n\n~~~js\nconst flat = arr => arr.reduce((pre,cur) => pre.concat(Array.isArray(cur)? flat(cur): cur), [])\n~~~","source":"_posts/skill/一行代码的JavaScript.md","raw":"---\ntitle: 一行代码的JavaScript\ntags: [前端,JavaScript,skill]\ncategories: [JavaScript]\ndescription: 一行代码的JavaScript\ndate: 2022-07-27\ncover: https://urlify.cn/6ZVzIj\n---\n\n# 一行代码的JavaScript\n\n### 1、获取字符串中的字符数\n\n~~~js\nconst characterCount = (str, char) => str.split(char).length - 1\n~~~\n\n### 2、检查对象是否为空\n\n~~~js\nconst isEmpty = obj => Reflect.ownKeys(obj).length === 0 && obj.constructor === Object\n~~~\n\n### 3、等待一段时间再执行\n\n~~~js\nconst wait = async (milliseconds) => new Promise((resolve) => setTimeout(resolve, milliseconds));\n~~~\n\n### 4、 获取两个日期之间的日差\n\n~~~js\nconst daysBetween = (date1, date2) => Math.ceil(Math.abs(date1 - date2) / (1000 * 60 * 60 * 24))\n~~~\n\n### 5、重定向到另一个 URL\n\n~~~js\nconst redirect = url => location.href = url\n~~~\n\n### 6、检查设备上的触摸支持\n~~~js\nconst touchSupported = () => ('ontouchstart' in window || DocumentTouch && document instanceof DocumentTouch)\n~~~\n\n### 7、 在元素后插入 HTML 字符串\n\n~~~js\nconst insertHTMLAfter = (html, el) => el.insertAdjacentHTML('afterend', html)\n~~~\n\n### 8、随机排列数组\n\n~~~js\nconst shuffle = arr => arr.sort(() => 0.5 - Math.random())\n~~~\n\n### 9、在网页上获取选定的文本\n\n~~~js\nconst getSelectedText = () => window.getSelection().toString()\n~~~\n\n### 10、获取随机布尔值\n\n~~~js\nconst getRandomBoolean = () => Math.random() >= 0.5\n~~~\n\n### 11、计算数组的平均值\n\n~~~js\nconst average = (arr) => arr.reduce((a, b) => a + b) / arr.length\n~~~\n\n\n### 12、数组扁平化\n\n~~~js\nconst flat = arr => arr.reduce((pre,cur) => pre.concat(Array.isArray(cur)? flat(cur): cur), [])\n~~~","slug":"skill/一行代码的JavaScript","published":1,"updated":"2022-10-12T02:50:25.545Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl95206cf000j3no2ahgdgsee","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><h1 id=\"一行代码的JavaScript\"><a href=\"#一行代码的JavaScript\" class=\"headerlink\" title=\"一行代码的JavaScript\"></a>一行代码的JavaScript</h1><h3 id=\"1、获取字符串中的字符数\"><a href=\"#1、获取字符串中的字符数\" class=\"headerlink\" title=\"1、获取字符串中的字符数\"></a>1、获取字符串中的字符数</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">characterCount</span> = (<span class=\"params\">str, char</span>) =&gt; str.<span class=\"title function_\">split</span>(char).<span class=\"property\">length</span> - <span class=\"number\">1</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2、检查对象是否为空\"><a href=\"#2、检查对象是否为空\" class=\"headerlink\" title=\"2、检查对象是否为空\"></a>2、检查对象是否为空</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">isEmpty</span> = obj =&gt; <span class=\"title class_\">Reflect</span>.<span class=\"title function_\">ownKeys</span>(obj).<span class=\"property\">length</span> === <span class=\"number\">0</span> &amp;&amp; obj.<span class=\"property\">constructor</span> === <span class=\"title class_\">Object</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3、等待一段时间再执行\"><a href=\"#3、等待一段时间再执行\" class=\"headerlink\" title=\"3、等待一段时间再执行\"></a>3、等待一段时间再执行</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">wait</span> = <span class=\"keyword\">async</span> (<span class=\"params\">milliseconds</span>) =&gt; <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve</span>) =&gt;</span> <span class=\"built_in\">setTimeout</span>(resolve, milliseconds));</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4、-获取两个日期之间的日差\"><a href=\"#4、-获取两个日期之间的日差\" class=\"headerlink\" title=\"4、 获取两个日期之间的日差\"></a>4、 获取两个日期之间的日差</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">daysBetween</span> = (<span class=\"params\">date1, date2</span>) =&gt; <span class=\"title class_\">Math</span>.<span class=\"title function_\">ceil</span>(<span class=\"title class_\">Math</span>.<span class=\"title function_\">abs</span>(date1 - date2) / (<span class=\"number\">1000</span> * <span class=\"number\">60</span> * <span class=\"number\">60</span> * <span class=\"number\">24</span>))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"5、重定向到另一个-URL\"><a href=\"#5、重定向到另一个-URL\" class=\"headerlink\" title=\"5、重定向到另一个 URL\"></a>5、重定向到另一个 URL</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">redirect</span> = url =&gt; location.<span class=\"property\">href</span> = url</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"6、检查设备上的触摸支持\"><a href=\"#6、检查设备上的触摸支持\" class=\"headerlink\" title=\"6、检查设备上的触摸支持\"></a>6、检查设备上的触摸支持</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">touchSupported</span> = (<span class=\"params\"></span>) =&gt; (<span class=\"string\">&#x27;ontouchstart&#x27;</span> <span class=\"keyword\">in</span> <span class=\"variable language_\">window</span> || <span class=\"title class_\">DocumentTouch</span> &amp;&amp; <span class=\"variable language_\">document</span> <span class=\"keyword\">instanceof</span> <span class=\"title class_\">DocumentTouch</span>)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"7、-在元素后插入-HTML-字符串\"><a href=\"#7、-在元素后插入-HTML-字符串\" class=\"headerlink\" title=\"7、 在元素后插入 HTML 字符串\"></a>7、 在元素后插入 HTML 字符串</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">insertHTMLAfter</span> = (<span class=\"params\">html, el</span>) =&gt; el.<span class=\"title function_\">insertAdjacentHTML</span>(<span class=\"string\">&#x27;afterend&#x27;</span>, html)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"8、随机排列数组\"><a href=\"#8、随机排列数组\" class=\"headerlink\" title=\"8、随机排列数组\"></a>8、随机排列数组</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">shuffle</span> = arr =&gt; arr.<span class=\"title function_\">sort</span>(<span class=\"function\">() =&gt;</span> <span class=\"number\">0.5</span> - <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>())</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"9、在网页上获取选定的文本\"><a href=\"#9、在网页上获取选定的文本\" class=\"headerlink\" title=\"9、在网页上获取选定的文本\"></a>9、在网页上获取选定的文本</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">getSelectedText</span> = (<span class=\"params\"></span>) =&gt; <span class=\"variable language_\">window</span>.<span class=\"title function_\">getSelection</span>().<span class=\"title function_\">toString</span>()</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"10、获取随机布尔值\"><a href=\"#10、获取随机布尔值\" class=\"headerlink\" title=\"10、获取随机布尔值\"></a>10、获取随机布尔值</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">getRandomBoolean</span> = (<span class=\"params\"></span>) =&gt; <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() &gt;= <span class=\"number\">0.5</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"11、计算数组的平均值\"><a href=\"#11、计算数组的平均值\" class=\"headerlink\" title=\"11、计算数组的平均值\"></a>11、计算数组的平均值</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">average</span> = (<span class=\"params\">arr</span>) =&gt; arr.<span class=\"title function_\">reduce</span>(<span class=\"function\">(<span class=\"params\">a, b</span>) =&gt;</span> a + b) / arr.<span class=\"property\">length</span></span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"12、数组扁平化\"><a href=\"#12、数组扁平化\" class=\"headerlink\" title=\"12、数组扁平化\"></a>12、数组扁平化</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">flat</span> = arr =&gt; arr.<span class=\"title function_\">reduce</span>(<span class=\"function\">(<span class=\"params\">pre,cur</span>) =&gt;</span> pre.<span class=\"title function_\">concat</span>(<span class=\"title class_\">Array</span>.<span class=\"title function_\">isArray</span>(cur)? <span class=\"title function_\">flat</span>(cur): cur), [])</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"一行代码的JavaScript\"><a href=\"#一行代码的JavaScript\" class=\"headerlink\" title=\"一行代码的JavaScript\"></a>一行代码的JavaScript</h1><h3 id=\"1、获取字符串中的字符数\"><a href=\"#1、获取字符串中的字符数\" class=\"headerlink\" title=\"1、获取字符串中的字符数\"></a>1、获取字符串中的字符数</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">characterCount</span> = (<span class=\"params\">str, char</span>) =&gt; str.<span class=\"title function_\">split</span>(char).<span class=\"property\">length</span> - <span class=\"number\">1</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2、检查对象是否为空\"><a href=\"#2、检查对象是否为空\" class=\"headerlink\" title=\"2、检查对象是否为空\"></a>2、检查对象是否为空</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">isEmpty</span> = obj =&gt; <span class=\"title class_\">Reflect</span>.<span class=\"title function_\">ownKeys</span>(obj).<span class=\"property\">length</span> === <span class=\"number\">0</span> &amp;&amp; obj.<span class=\"property\">constructor</span> === <span class=\"title class_\">Object</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3、等待一段时间再执行\"><a href=\"#3、等待一段时间再执行\" class=\"headerlink\" title=\"3、等待一段时间再执行\"></a>3、等待一段时间再执行</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">wait</span> = <span class=\"keyword\">async</span> (<span class=\"params\">milliseconds</span>) =&gt; <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve</span>) =&gt;</span> <span class=\"built_in\">setTimeout</span>(resolve, milliseconds));</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4、-获取两个日期之间的日差\"><a href=\"#4、-获取两个日期之间的日差\" class=\"headerlink\" title=\"4、 获取两个日期之间的日差\"></a>4、 获取两个日期之间的日差</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">daysBetween</span> = (<span class=\"params\">date1, date2</span>) =&gt; <span class=\"title class_\">Math</span>.<span class=\"title function_\">ceil</span>(<span class=\"title class_\">Math</span>.<span class=\"title function_\">abs</span>(date1 - date2) / (<span class=\"number\">1000</span> * <span class=\"number\">60</span> * <span class=\"number\">60</span> * <span class=\"number\">24</span>))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"5、重定向到另一个-URL\"><a href=\"#5、重定向到另一个-URL\" class=\"headerlink\" title=\"5、重定向到另一个 URL\"></a>5、重定向到另一个 URL</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">redirect</span> = url =&gt; location.<span class=\"property\">href</span> = url</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"6、检查设备上的触摸支持\"><a href=\"#6、检查设备上的触摸支持\" class=\"headerlink\" title=\"6、检查设备上的触摸支持\"></a>6、检查设备上的触摸支持</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">touchSupported</span> = (<span class=\"params\"></span>) =&gt; (<span class=\"string\">&#x27;ontouchstart&#x27;</span> <span class=\"keyword\">in</span> <span class=\"variable language_\">window</span> || <span class=\"title class_\">DocumentTouch</span> &amp;&amp; <span class=\"variable language_\">document</span> <span class=\"keyword\">instanceof</span> <span class=\"title class_\">DocumentTouch</span>)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"7、-在元素后插入-HTML-字符串\"><a href=\"#7、-在元素后插入-HTML-字符串\" class=\"headerlink\" title=\"7、 在元素后插入 HTML 字符串\"></a>7、 在元素后插入 HTML 字符串</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">insertHTMLAfter</span> = (<span class=\"params\">html, el</span>) =&gt; el.<span class=\"title function_\">insertAdjacentHTML</span>(<span class=\"string\">&#x27;afterend&#x27;</span>, html)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"8、随机排列数组\"><a href=\"#8、随机排列数组\" class=\"headerlink\" title=\"8、随机排列数组\"></a>8、随机排列数组</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">shuffle</span> = arr =&gt; arr.<span class=\"title function_\">sort</span>(<span class=\"function\">() =&gt;</span> <span class=\"number\">0.5</span> - <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>())</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"9、在网页上获取选定的文本\"><a href=\"#9、在网页上获取选定的文本\" class=\"headerlink\" title=\"9、在网页上获取选定的文本\"></a>9、在网页上获取选定的文本</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">getSelectedText</span> = (<span class=\"params\"></span>) =&gt; <span class=\"variable language_\">window</span>.<span class=\"title function_\">getSelection</span>().<span class=\"title function_\">toString</span>()</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"10、获取随机布尔值\"><a href=\"#10、获取随机布尔值\" class=\"headerlink\" title=\"10、获取随机布尔值\"></a>10、获取随机布尔值</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">getRandomBoolean</span> = (<span class=\"params\"></span>) =&gt; <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() &gt;= <span class=\"number\">0.5</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"11、计算数组的平均值\"><a href=\"#11、计算数组的平均值\" class=\"headerlink\" title=\"11、计算数组的平均值\"></a>11、计算数组的平均值</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">average</span> = (<span class=\"params\">arr</span>) =&gt; arr.<span class=\"title function_\">reduce</span>(<span class=\"function\">(<span class=\"params\">a, b</span>) =&gt;</span> a + b) / arr.<span class=\"property\">length</span></span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"12、数组扁平化\"><a href=\"#12、数组扁平化\" class=\"headerlink\" title=\"12、数组扁平化\"></a>12、数组扁平化</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">flat</span> = arr =&gt; arr.<span class=\"title function_\">reduce</span>(<span class=\"function\">(<span class=\"params\">pre,cur</span>) =&gt;</span> pre.<span class=\"title function_\">concat</span>(<span class=\"title class_\">Array</span>.<span class=\"title function_\">isArray</span>(cur)? <span class=\"title function_\">flat</span>(cur): cur), [])</span><br></pre></td></tr></table></figure>"},{"title":"vite中配置路径别名","description":"配置路径别名@代表src路径","date":"2022-07-25T16:00:00.000Z","cover":"https://urlify.cn/3YRb2e","_content":"\n# vite 中使用 @ ，配置路径别名\n\nvite 加 vue3项目中报错`Cannot find module 'XXXXXX ’ or its corresponding type declarations`\n\n我们只需要在以下几个文件里面配置：\n\n**vite.config.ts**: \n\n注意这里用了node的path模块需要执行`npm i --save-dev @types/node`命令\n\n~~~ts\nimport { defineConfig } from 'vite';\nimport vue from '@vitejs/plugin-vue';\nconst path = require('path');\n\nexport default defineConfig({\n  plugins: [vue()],\n  define: {\n    'process.env': {},\n  },\n  resolve: {\n    // 配置路径别名\n    alias: {\n      '@': path.resolve(__dirname, './src'),\n    },\n  },\n});\n~~~\n\n\n**tsconfig.json**：\n\n配置baseUrl，paths\n\n~~~json\n{\n  \"compilerOptions\": {\n    \"target\": \"esnext\",\n    \"useDefineForClassFields\": true,\n    \"module\": \"esnext\",\n    \"moduleResolution\": \"node\",\n    \"strict\": true,\n    \"jsx\": \"preserve\",\n    \"sourceMap\": true,\n    \"resolveJsonModule\": true,\n    \"esModuleInterop\": true,\n    \"lib\": [\"esnext\", \"dom\"],\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/*\": [\"src/*\"]\n    }\n  },\n  \"include\": [\"src/**/*.ts\", \"src/**/*.d.ts\", \"src/**/*.tsx\", \"src/**/*.vue\"]\n}\n~~~\n\n大工告成啦！接下来可以用@别名代表src的绝对路径\n\n","source":"_posts/vite/vite中用@别名.md","raw":"---\ntitle: vite中配置路径别名\ntags: [前端,项目,Vue,vite]\ncategories: [Vue3]\ndescription: 配置路径别名@代表src路径\ndate: 2022-07-26\ncover: https://urlify.cn/3YRb2e\n---\n\n# vite 中使用 @ ，配置路径别名\n\nvite 加 vue3项目中报错`Cannot find module 'XXXXXX ’ or its corresponding type declarations`\n\n我们只需要在以下几个文件里面配置：\n\n**vite.config.ts**: \n\n注意这里用了node的path模块需要执行`npm i --save-dev @types/node`命令\n\n~~~ts\nimport { defineConfig } from 'vite';\nimport vue from '@vitejs/plugin-vue';\nconst path = require('path');\n\nexport default defineConfig({\n  plugins: [vue()],\n  define: {\n    'process.env': {},\n  },\n  resolve: {\n    // 配置路径别名\n    alias: {\n      '@': path.resolve(__dirname, './src'),\n    },\n  },\n});\n~~~\n\n\n**tsconfig.json**：\n\n配置baseUrl，paths\n\n~~~json\n{\n  \"compilerOptions\": {\n    \"target\": \"esnext\",\n    \"useDefineForClassFields\": true,\n    \"module\": \"esnext\",\n    \"moduleResolution\": \"node\",\n    \"strict\": true,\n    \"jsx\": \"preserve\",\n    \"sourceMap\": true,\n    \"resolveJsonModule\": true,\n    \"esModuleInterop\": true,\n    \"lib\": [\"esnext\", \"dom\"],\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/*\": [\"src/*\"]\n    }\n  },\n  \"include\": [\"src/**/*.ts\", \"src/**/*.d.ts\", \"src/**/*.tsx\", \"src/**/*.vue\"]\n}\n~~~\n\n大工告成啦！接下来可以用@别名代表src的绝对路径\n\n","slug":"vite/vite中用@别名","published":1,"updated":"2022-10-12T02:50:25.545Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl95206ch000n3no22uq9g4ie","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><h1 id=\"vite-中使用-，配置路径别名\"><a href=\"#vite-中使用-，配置路径别名\" class=\"headerlink\" title=\"vite 中使用 @ ，配置路径别名\"></a>vite 中使用 @ ，配置路径别名</h1><p>vite 加 vue3项目中报错<code>Cannot find module &#39;XXXXXX ’ or its corresponding type declarations</code></p>\n<p>我们只需要在以下几个文件里面配置：</p>\n<p><strong>vite.config.ts</strong>: </p>\n<p>注意这里用了node的path模块需要执行<code>npm i --save-dev @types/node</code>命令</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineConfig &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [<span class=\"title function_\">vue</span>()],</span><br><span class=\"line\">  <span class=\"attr\">define</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;process.env&#x27;</span>: &#123;&#125;,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">resolve</span>: &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 配置路径别名</span></span><br><span class=\"line\">    <span class=\"attr\">alias</span>: &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;@&#x27;</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;./src&#x27;</span>),</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n\n<p><strong>tsconfig.json</strong>：</p>\n<p>配置baseUrl，paths</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;compilerOptions&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;target&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;esnext&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;useDefineForClassFields&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;module&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;esnext&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;moduleResolution&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;node&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;strict&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;jsx&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;preserve&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;sourceMap&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;resolveJsonModule&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;esModuleInterop&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;lib&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;esnext&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;dom&quot;</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;baseUrl&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;.&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;paths&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;@/*&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;src/*&quot;</span><span class=\"punctuation\">]</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;include&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;src/**/*.ts&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;src/**/*.d.ts&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;src/**/*.tsx&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;src/**/*.vue&quot;</span><span class=\"punctuation\">]</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>大工告成啦！接下来可以用@别名代表src的绝对路径</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"vite-中使用-，配置路径别名\"><a href=\"#vite-中使用-，配置路径别名\" class=\"headerlink\" title=\"vite 中使用 @ ，配置路径别名\"></a>vite 中使用 @ ，配置路径别名</h1><p>vite 加 vue3项目中报错<code>Cannot find module &#39;XXXXXX ’ or its corresponding type declarations</code></p>\n<p>我们只需要在以下几个文件里面配置：</p>\n<p><strong>vite.config.ts</strong>: </p>\n<p>注意这里用了node的path模块需要执行<code>npm i --save-dev @types/node</code>命令</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineConfig &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [<span class=\"title function_\">vue</span>()],</span><br><span class=\"line\">  <span class=\"attr\">define</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;process.env&#x27;</span>: &#123;&#125;,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">resolve</span>: &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 配置路径别名</span></span><br><span class=\"line\">    <span class=\"attr\">alias</span>: &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;@&#x27;</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;./src&#x27;</span>),</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n\n<p><strong>tsconfig.json</strong>：</p>\n<p>配置baseUrl，paths</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;compilerOptions&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;target&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;esnext&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;useDefineForClassFields&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;module&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;esnext&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;moduleResolution&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;node&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;strict&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;jsx&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;preserve&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;sourceMap&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;resolveJsonModule&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;esModuleInterop&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;lib&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;esnext&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;dom&quot;</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;baseUrl&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;.&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;paths&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;@/*&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;src/*&quot;</span><span class=\"punctuation\">]</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;include&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;src/**/*.ts&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;src/**/*.d.ts&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;src/**/*.tsx&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;src/**/*.vue&quot;</span><span class=\"punctuation\">]</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>大工告成啦！接下来可以用@别名代表src的绝对路径</p>\n"},{"title":"初识vite插件(篇一)","description":"初识vite插件","date":"2022-07-28T16:00:00.000Z","cover":"https://urlify.cn/eAJj6b","_content":"\n# 初识vite插件(篇一)\n\n### vite插件形式\n先举个简单的例子来认识下vite插件的结构：\n~~~js\nexport default function myExample () {\n  return {\n    name: 'my-example', // 名称用于警告和错误展示\n    resolveId ( source ) {\n      if (source === 'virtual-module') {\n        return source; // 返回source表明命中，vite不再询问其他插件处理该id请求\n      }\n      return null; // 返回null表明是其他id要继续处理\n    },\n    load ( id ) {\n      if (id === 'virtual-module') {\n        return 'export default \"This is virtual!\"'; // 返回\"virtual-module\"模块源码\n      }\n      return null; // 其他id继续处理\n    }\n  };\n}\n~~~\n\n### 通用钩子\n\n下面钩子会在服务器启动时调用一次:\n\n- `options` 替换或操纵rollup选项\n- `buildStart` 开始创建\n\n下面钩子每次有模块请求时都会被调用:\n\n- `resolveId` 创建自定义确认函数，常用语定位第三方依赖\n- `load` 创建自定义加载函数，可用于返回自定义的内容\n- `transform` 可用于转换已加载的模块内容\n\n下面钩子会在服务器关闭时调用一次:\n\n- buildEnd\n- closeBundle\n\n### Vite特有钩子\n\n- `config`: 修改Vite配置\n- `configResolved`：Vite配置确认\n- `configureServer`：用于配置dev server\n- `transformIndexHtml`：用于转换宿主页\n- `handleHotUpdate`：自定义HMR更新时调用\n\n那我们去走一下钩子的顺序：\n\n~~~js\nexport default function myExample () {\n  // 返回的是插件对象\n  return {\n    name: 'hooks-order', \n    // 初始化hooks，只走一次\n    options(opts) {\n      console.log('options', opts);\n    },\n    buildStart() {\n      console.log('buildStart');\n    },\n    // vite特有钩子\n    config(config) {\n      console.log('config', config);\n      return {}\n    },\n    configResolved(resolvedCofnig) {\n      console.log('configResolved');\n    },\n    configureServer(server) {\n      console.log('configureServer');\n      // server.app.use((req, res, next) => {\n      //   // custom handle request...\n      // })\n    },\n    transformIndexHtml(html) {\n      console.log('transformIndexHtml');\n      return html\n      // return html.replace(\n      //   /<title>(.*?)<\\/title>/,\n      //   `<title>Title replaced!</title>`\n      // )\n    },\n    // 通用钩子\n    resolveId ( source ) {\n      if (source === 'virtual-module') {\n        console.log('resolvedId', source);\n        return source; \n      }\n      return null; \n    },\n    load ( id ) {\n      if (id === 'virtual-module') {\n        console.log('load');\n        return 'export default \"This is virtual!\"';\n      }\n      return null;\n    },\n    transform(code, id) {\n      if (id === 'virtual-module') {\n        console.log('transform');\n      }\n      return code\n    },\n  };\n}\n~~~\n执行顺序：\n~~~js\n// config -> configResolved -> options -> configureServer -> \n// buildStart -> Vite dev server ready -> transformIndexHtml \n// -> resolvedId -> load -> transform\n~~~\n\n### 插件顺序\n\n- 别名处理Alias\n- 用户插件设置enforce: 'pre'\n- Vite核心插件\n- 用户插件未设置enforce\n- Vite构建插件\n- 用户插件设置enforce: 'post'\n- Vite构建后置插件(minify, manifest, reporting)\n","source":"_posts/vite/初识vite插件.md","raw":"---\ntitle: 初识vite插件(篇一)\ntags: [vite]\ncategories: [前端工程化]\ndescription: 初识vite插件\ndate: 2022-07-29\ncover: https://urlify.cn/eAJj6b\n---\n\n# 初识vite插件(篇一)\n\n### vite插件形式\n先举个简单的例子来认识下vite插件的结构：\n~~~js\nexport default function myExample () {\n  return {\n    name: 'my-example', // 名称用于警告和错误展示\n    resolveId ( source ) {\n      if (source === 'virtual-module') {\n        return source; // 返回source表明命中，vite不再询问其他插件处理该id请求\n      }\n      return null; // 返回null表明是其他id要继续处理\n    },\n    load ( id ) {\n      if (id === 'virtual-module') {\n        return 'export default \"This is virtual!\"'; // 返回\"virtual-module\"模块源码\n      }\n      return null; // 其他id继续处理\n    }\n  };\n}\n~~~\n\n### 通用钩子\n\n下面钩子会在服务器启动时调用一次:\n\n- `options` 替换或操纵rollup选项\n- `buildStart` 开始创建\n\n下面钩子每次有模块请求时都会被调用:\n\n- `resolveId` 创建自定义确认函数，常用语定位第三方依赖\n- `load` 创建自定义加载函数，可用于返回自定义的内容\n- `transform` 可用于转换已加载的模块内容\n\n下面钩子会在服务器关闭时调用一次:\n\n- buildEnd\n- closeBundle\n\n### Vite特有钩子\n\n- `config`: 修改Vite配置\n- `configResolved`：Vite配置确认\n- `configureServer`：用于配置dev server\n- `transformIndexHtml`：用于转换宿主页\n- `handleHotUpdate`：自定义HMR更新时调用\n\n那我们去走一下钩子的顺序：\n\n~~~js\nexport default function myExample () {\n  // 返回的是插件对象\n  return {\n    name: 'hooks-order', \n    // 初始化hooks，只走一次\n    options(opts) {\n      console.log('options', opts);\n    },\n    buildStart() {\n      console.log('buildStart');\n    },\n    // vite特有钩子\n    config(config) {\n      console.log('config', config);\n      return {}\n    },\n    configResolved(resolvedCofnig) {\n      console.log('configResolved');\n    },\n    configureServer(server) {\n      console.log('configureServer');\n      // server.app.use((req, res, next) => {\n      //   // custom handle request...\n      // })\n    },\n    transformIndexHtml(html) {\n      console.log('transformIndexHtml');\n      return html\n      // return html.replace(\n      //   /<title>(.*?)<\\/title>/,\n      //   `<title>Title replaced!</title>`\n      // )\n    },\n    // 通用钩子\n    resolveId ( source ) {\n      if (source === 'virtual-module') {\n        console.log('resolvedId', source);\n        return source; \n      }\n      return null; \n    },\n    load ( id ) {\n      if (id === 'virtual-module') {\n        console.log('load');\n        return 'export default \"This is virtual!\"';\n      }\n      return null;\n    },\n    transform(code, id) {\n      if (id === 'virtual-module') {\n        console.log('transform');\n      }\n      return code\n    },\n  };\n}\n~~~\n执行顺序：\n~~~js\n// config -> configResolved -> options -> configureServer -> \n// buildStart -> Vite dev server ready -> transformIndexHtml \n// -> resolvedId -> load -> transform\n~~~\n\n### 插件顺序\n\n- 别名处理Alias\n- 用户插件设置enforce: 'pre'\n- Vite核心插件\n- 用户插件未设置enforce\n- Vite构建插件\n- 用户插件设置enforce: 'post'\n- Vite构建后置插件(minify, manifest, reporting)\n","slug":"vite/初识vite插件","published":1,"updated":"2022-10-12T02:50:25.545Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl95206cj000o3no20sid6fao","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><h1 id=\"初识vite插件-篇一\"><a href=\"#初识vite插件-篇一\" class=\"headerlink\" title=\"初识vite插件(篇一)\"></a>初识vite插件(篇一)</h1><h3 id=\"vite插件形式\"><a href=\"#vite插件形式\" class=\"headerlink\" title=\"vite插件形式\"></a>vite插件形式</h3><p>先举个简单的例子来认识下vite插件的结构：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">myExample</span> () &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;my-example&#x27;</span>, <span class=\"comment\">// 名称用于警告和错误展示</span></span><br><span class=\"line\">    resolveId ( source ) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (source === <span class=\"string\">&#x27;virtual-module&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> source; <span class=\"comment\">// 返回source表明命中，vite不再询问其他插件处理该id请求</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">null</span>; <span class=\"comment\">// 返回null表明是其他id要继续处理</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    load ( id ) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (id === <span class=\"string\">&#x27;virtual-module&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&#x27;export default &quot;This is virtual!&quot;&#x27;</span>; <span class=\"comment\">// 返回&quot;virtual-module&quot;模块源码</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">null</span>; <span class=\"comment\">// 其他id继续处理</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"通用钩子\"><a href=\"#通用钩子\" class=\"headerlink\" title=\"通用钩子\"></a>通用钩子</h3><p>下面钩子会在服务器启动时调用一次:</p>\n<ul>\n<li><code>options</code> 替换或操纵rollup选项</li>\n<li><code>buildStart</code> 开始创建</li>\n</ul>\n<p>下面钩子每次有模块请求时都会被调用:</p>\n<ul>\n<li><code>resolveId</code> 创建自定义确认函数，常用语定位第三方依赖</li>\n<li><code>load</code> 创建自定义加载函数，可用于返回自定义的内容</li>\n<li><code>transform</code> 可用于转换已加载的模块内容</li>\n</ul>\n<p>下面钩子会在服务器关闭时调用一次:</p>\n<ul>\n<li>buildEnd</li>\n<li>closeBundle</li>\n</ul>\n<h3 id=\"Vite特有钩子\"><a href=\"#Vite特有钩子\" class=\"headerlink\" title=\"Vite特有钩子\"></a>Vite特有钩子</h3><ul>\n<li><code>config</code>: 修改Vite配置</li>\n<li><code>configResolved</code>：Vite配置确认</li>\n<li><code>configureServer</code>：用于配置dev server</li>\n<li><code>transformIndexHtml</code>：用于转换宿主页</li>\n<li><code>handleHotUpdate</code>：自定义HMR更新时调用</li>\n</ul>\n<p>那我们去走一下钩子的顺序：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">myExample</span> () &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 返回的是插件对象</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;hooks-order&#x27;</span>, </span><br><span class=\"line\">    <span class=\"comment\">// 初始化hooks，只走一次</span></span><br><span class=\"line\">    <span class=\"title function_\">options</span>(<span class=\"params\">opts</span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;options&#x27;</span>, opts);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"title function_\">buildStart</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;buildStart&#x27;</span>);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"comment\">// vite特有钩子</span></span><br><span class=\"line\">    <span class=\"title function_\">config</span>(<span class=\"params\">config</span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;config&#x27;</span>, config);</span><br><span class=\"line\">      <span class=\"keyword\">return</span> &#123;&#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"title function_\">configResolved</span>(<span class=\"params\">resolvedCofnig</span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;configResolved&#x27;</span>);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"title function_\">configureServer</span>(<span class=\"params\">server</span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;configureServer&#x27;</span>);</span><br><span class=\"line\">      <span class=\"comment\">// server.app.use((req, res, next) =&gt; &#123;</span></span><br><span class=\"line\">      <span class=\"comment\">//   // custom handle request...</span></span><br><span class=\"line\">      <span class=\"comment\">// &#125;)</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"title function_\">transformIndexHtml</span>(<span class=\"params\">html</span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;transformIndexHtml&#x27;</span>);</span><br><span class=\"line\">      <span class=\"keyword\">return</span> html</span><br><span class=\"line\">      <span class=\"comment\">// return html.replace(</span></span><br><span class=\"line\">      <span class=\"comment\">//   /&lt;title&gt;(.*?)&lt;\\/title&gt;/,</span></span><br><span class=\"line\">      <span class=\"comment\">//   `&lt;title&gt;Title replaced!&lt;/title&gt;`</span></span><br><span class=\"line\">      <span class=\"comment\">// )</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"comment\">// 通用钩子</span></span><br><span class=\"line\">    resolveId ( source ) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (source === <span class=\"string\">&#x27;virtual-module&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;resolvedId&#x27;</span>, source);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> source; </span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">null</span>; </span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    load ( id ) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (id === <span class=\"string\">&#x27;virtual-module&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;load&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&#x27;export default &quot;This is virtual!&quot;&#x27;</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"title function_\">transform</span>(<span class=\"params\">code, id</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (id === <span class=\"string\">&#x27;virtual-module&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;transform&#x27;</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> code</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>执行顺序：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// config -&gt; configResolved -&gt; options -&gt; configureServer -&gt; </span></span><br><span class=\"line\"><span class=\"comment\">// buildStart -&gt; Vite dev server ready -&gt; transformIndexHtml </span></span><br><span class=\"line\"><span class=\"comment\">// -&gt; resolvedId -&gt; load -&gt; transform</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"插件顺序\"><a href=\"#插件顺序\" class=\"headerlink\" title=\"插件顺序\"></a>插件顺序</h3><ul>\n<li>别名处理Alias</li>\n<li>用户插件设置enforce: ‘pre’</li>\n<li>Vite核心插件</li>\n<li>用户插件未设置enforce</li>\n<li>Vite构建插件</li>\n<li>用户插件设置enforce: ‘post’</li>\n<li>Vite构建后置插件(minify, manifest, reporting)</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"初识vite插件-篇一\"><a href=\"#初识vite插件-篇一\" class=\"headerlink\" title=\"初识vite插件(篇一)\"></a>初识vite插件(篇一)</h1><h3 id=\"vite插件形式\"><a href=\"#vite插件形式\" class=\"headerlink\" title=\"vite插件形式\"></a>vite插件形式</h3><p>先举个简单的例子来认识下vite插件的结构：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">myExample</span> () &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;my-example&#x27;</span>, <span class=\"comment\">// 名称用于警告和错误展示</span></span><br><span class=\"line\">    resolveId ( source ) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (source === <span class=\"string\">&#x27;virtual-module&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> source; <span class=\"comment\">// 返回source表明命中，vite不再询问其他插件处理该id请求</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">null</span>; <span class=\"comment\">// 返回null表明是其他id要继续处理</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    load ( id ) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (id === <span class=\"string\">&#x27;virtual-module&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&#x27;export default &quot;This is virtual!&quot;&#x27;</span>; <span class=\"comment\">// 返回&quot;virtual-module&quot;模块源码</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">null</span>; <span class=\"comment\">// 其他id继续处理</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"通用钩子\"><a href=\"#通用钩子\" class=\"headerlink\" title=\"通用钩子\"></a>通用钩子</h3><p>下面钩子会在服务器启动时调用一次:</p>\n<ul>\n<li><code>options</code> 替换或操纵rollup选项</li>\n<li><code>buildStart</code> 开始创建</li>\n</ul>\n<p>下面钩子每次有模块请求时都会被调用:</p>\n<ul>\n<li><code>resolveId</code> 创建自定义确认函数，常用语定位第三方依赖</li>\n<li><code>load</code> 创建自定义加载函数，可用于返回自定义的内容</li>\n<li><code>transform</code> 可用于转换已加载的模块内容</li>\n</ul>\n<p>下面钩子会在服务器关闭时调用一次:</p>\n<ul>\n<li>buildEnd</li>\n<li>closeBundle</li>\n</ul>\n<h3 id=\"Vite特有钩子\"><a href=\"#Vite特有钩子\" class=\"headerlink\" title=\"Vite特有钩子\"></a>Vite特有钩子</h3><ul>\n<li><code>config</code>: 修改Vite配置</li>\n<li><code>configResolved</code>：Vite配置确认</li>\n<li><code>configureServer</code>：用于配置dev server</li>\n<li><code>transformIndexHtml</code>：用于转换宿主页</li>\n<li><code>handleHotUpdate</code>：自定义HMR更新时调用</li>\n</ul>\n<p>那我们去走一下钩子的顺序：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">myExample</span> () &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 返回的是插件对象</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;hooks-order&#x27;</span>, </span><br><span class=\"line\">    <span class=\"comment\">// 初始化hooks，只走一次</span></span><br><span class=\"line\">    <span class=\"title function_\">options</span>(<span class=\"params\">opts</span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;options&#x27;</span>, opts);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"title function_\">buildStart</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;buildStart&#x27;</span>);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"comment\">// vite特有钩子</span></span><br><span class=\"line\">    <span class=\"title function_\">config</span>(<span class=\"params\">config</span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;config&#x27;</span>, config);</span><br><span class=\"line\">      <span class=\"keyword\">return</span> &#123;&#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"title function_\">configResolved</span>(<span class=\"params\">resolvedCofnig</span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;configResolved&#x27;</span>);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"title function_\">configureServer</span>(<span class=\"params\">server</span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;configureServer&#x27;</span>);</span><br><span class=\"line\">      <span class=\"comment\">// server.app.use((req, res, next) =&gt; &#123;</span></span><br><span class=\"line\">      <span class=\"comment\">//   // custom handle request...</span></span><br><span class=\"line\">      <span class=\"comment\">// &#125;)</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"title function_\">transformIndexHtml</span>(<span class=\"params\">html</span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;transformIndexHtml&#x27;</span>);</span><br><span class=\"line\">      <span class=\"keyword\">return</span> html</span><br><span class=\"line\">      <span class=\"comment\">// return html.replace(</span></span><br><span class=\"line\">      <span class=\"comment\">//   /&lt;title&gt;(.*?)&lt;\\/title&gt;/,</span></span><br><span class=\"line\">      <span class=\"comment\">//   `&lt;title&gt;Title replaced!&lt;/title&gt;`</span></span><br><span class=\"line\">      <span class=\"comment\">// )</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"comment\">// 通用钩子</span></span><br><span class=\"line\">    resolveId ( source ) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (source === <span class=\"string\">&#x27;virtual-module&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;resolvedId&#x27;</span>, source);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> source; </span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">null</span>; </span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    load ( id ) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (id === <span class=\"string\">&#x27;virtual-module&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;load&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&#x27;export default &quot;This is virtual!&quot;&#x27;</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"title function_\">transform</span>(<span class=\"params\">code, id</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (id === <span class=\"string\">&#x27;virtual-module&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;transform&#x27;</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> code</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>执行顺序：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// config -&gt; configResolved -&gt; options -&gt; configureServer -&gt; </span></span><br><span class=\"line\"><span class=\"comment\">// buildStart -&gt; Vite dev server ready -&gt; transformIndexHtml </span></span><br><span class=\"line\"><span class=\"comment\">// -&gt; resolvedId -&gt; load -&gt; transform</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"插件顺序\"><a href=\"#插件顺序\" class=\"headerlink\" title=\"插件顺序\"></a>插件顺序</h3><ul>\n<li>别名处理Alias</li>\n<li>用户插件设置enforce: ‘pre’</li>\n<li>Vite核心插件</li>\n<li>用户插件未设置enforce</li>\n<li>Vite构建插件</li>\n<li>用户插件设置enforce: ‘post’</li>\n<li>Vite构建后置插件(minify, manifest, reporting)</li>\n</ul>\n"},{"title":"手写一个vite mock插件（篇二）","description":"手写一个vite mock插件","date":"2022-07-28T16:00:00.000Z","cover":"https://urlify.cn/eAJj6b","_content":"\n# 手写一个vite mock插件（篇二）\n\n### 前言\n这里先给demo地址，可以直接看源码：[demo地址](https://github.com/kangkang123269/kate-demo/tree/main/vite/vite-mock-plugin)\n\n### 编写思路\n- 一开始干嘛？初始化。mock插件初始化什么，入口和能支持mock能力的devServer\n- 初始化完了，发现是不是有post，get等方法的路由请求，需不要给它分类？需要\n- 那怎么分类？考完重构一个对象的能力，是不是`so easy`.\n- 分为类是不是需要判断是否有效？有效就返回mock数据，无效执行下一个中间件\n- 前期这样想完全没有问题。\n\n来一条华丽的分割线\n\n----\n后期发现问题：\n- 发现中间件的next方法和res.send方法同时执行或导致程序中断\n\n解决这个问题我们需要判断路由是否有效，且不能在无效的时候去send和mock（假装自己知道就好了）\n\n- send函数在请求的时候需要给相应的信息，所以需要二次封装\n\n### 初始化\n\n我们从[vite初始篇一](https://juejin.cn/post/7125746860567822350)开始了解vite插件的钩子，我们需要开启一个服务去支持mock能力，需要用到`devServer`，很明显我们需要在`configureServer`这个钩子里面写，且需要mock数据的路径\n\n所以我们初始化的插件函数需要做两件事情：\n- 需要options参数入口，且为空的时候要给默认的入口\n- 在return的对象要用到`configureServer`的`server.middlewares`\n\n> server.middlewares相当于`express`的`app`\n\n~~~js\nimport path from 'path';\n\nexport default function (options = {}) {\n  // 获取mock文件入口，默认index\n  options.entry = options.entry || './mock/index.js';\n\n  // 转换为绝对路径\n  if (!path.isAbsolute(options.entry)) {\n    options.entry = path.resolve(process.cwd(), options.entry);\n  }\n\n  return {\n    configureServer: function ({ middlewares: app }) {\n        // 定义中间件：路由匹配\n      const middleware = (req, res, next) => {\n\n      };\n      app.use(middleware);\n    }\n  };\n}\n~~~\n\n再给我们的mock也初始下,下面看到我们是用的ES Moudle抛出方式，因为vite是不支持commonJS模块。所以我们需要用到`export default`，不能用到`module.exports`，本人亲测自己写一个支持require的插件也作用不到`mock`这个插件。（一个伤心的经历）\n\n~~~js\n// /mock/index.js\nexport default [\n  {\n    url: '/api/users',\n    type: 'get',\n    response: function (req, res) {\n      return res.send([\n        {\n          username: 'tom',\n          age: 18,\n        },\n        {\n          username: 'Tom',\n          age: 19,\n        },\n      ]);\n    },\n  },\n];\n~~~\n\n### 创建路由表\n\n我们需要的路由表是这种结构，一个方法对应多个路由，所以我们需要创建路由表。\n\n~~~json\n{\n    \"get\": [\n        {\n            \"url\": \"/api/1\",\n            \"type\": \"get\",\n            \"response\": function \n        },\n        {\n            \"url\": \"/api/2\",\n            \"type\": \"get\",\n            \"response\": function \n        },\n    ],\n    \"post\": [\n        {\n            \"url\": \"/api/1\",\n            \"type\": \"get\",\n            \"response\": function \n        },\n        {\n            \"url\": \"/api/2\",\n            \"type\": \"get\",\n            \"response\": function \n        },\n    ]\n}\n~~~\n\n首先获取路由，我们不能用require，所以用import. 但import是异步的，那么我们需要加上async/await等待加载完模块，用解构的方式获取mockObj\n\n~~~js\n...\nreturn {\n    configureServer: function ({ middlewares: app }) {\n        // 定义路由表\n        const mockObj = { ...(await import(options.entry)) }.default;\n        // 创建路由表\n        createRoute(mockObj);\n\n        ....\n         // 定义中间件：路由匹配\n        const middleware = (req, res, next) => {\n\n        };\n        app.use(middleware)\n    }\n};\n...\n~~~\n\n那么我们现在开始写`createRoute`函数，多尝试，也就一个简单的变量处理，下列写成函数如下：\n\n~~~js\nfunction createRoute(mockConfList) {\n  mockConfList.forEach((mockConf) => {\n    let method = mockConf.type || 'get';\n    let path = mockConf.url;\n    let handler = mockConf.response;\n    // 路由对象\n    let route = { path, method: method.toLowerCase(), handler };\n    // 如果没有改请求方法就初始化为空数组\n    if (!mockRouteMap[method]) {\n      mockRouteMap[method] = [];\n    }\n    console.log('create mock api: ', route.method, route.path);\n    // 存入映射对象中\n    mockRouteMap[method].push(route);\n  });\n}\n~~~\n创建完路由表，需要中间件里面的逻辑,也就是破路由和send数据到路由上面了。\n\n### 执行匹配路由和自定义send\n我们接下的逻辑可以这样写，先获取路由匹配的结果，如果匹配成功就send \n\n~~~js\n...\nreturn {\n    configureServer: async function ({ middlewares: app }) {\n      // 定义路由表\n      const mockObj = { ...(await import(options.entry)) }.default;\n      // 创建路由表\n      createRoute(mockObj);\n\n      // 定义中间件：路由匹配\n      const middleware = (req, res, next) => {\n        // 1. 执行匹配过程\n        let route = matchRoute(req);\n\n        // 2. 存在匹配，则这个是一个mock请求\n        if (route) {\n          console.log('mock request', route.method, route.path);\n          // 自定义send\n          res.send = send;\n          // 执行路由的`response`回调函数，可以把代码往前翻\n          route.handler(req, res);\n        } else {\n          next();\n        }\n      };\n      app.use(middleware);\n    },\n};\n\n...\n~~~\n\n#### 匹配路由\n\n根据我们浏览器请求的路由去匹配路由信息\n\n~~~js\nfunction matchRoute(req) {\n  let url = req.url;\n  let method = req.method.toLowerCase();\n  let routeList = mockRouteMap[method];\n\n  return routeList && routeList.find((item) => item.path === url);\n}\n~~~\n\n我们请求一个试下：\n\n`成功匹配`:\n\n![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e09bdc4eda6c458c90290fef6420279b~tplv-k3u1fbpfcp-watermark.image?)\n\n\n#### 自定义send\n\n这里自定义send我们可以添加请求头字段，能够知道请求的东西的类型，长度等信息\n\n~~~js\nfunction send(body) {\n  let chunk = JSON.stringify(body);\n  // Content-Length\n  if (chunk) {\n    chunk = Buffer.from(chunk, 'utf-8');\n    this.setHeader('Content-Length', chunk.length);\n  }\n  // content-type\n  this.setHeader('Content-Type', 'application/json');\n  // status\n  this.statusCode = 200;\n  // response\n  this.end(chunk, 'utf8');\n}\n~~~\n\n### 总结\n\nvite插件的掌握还是需要写些插件，看看别人的源码，了解为什么这么写，自己之后可以这样写。根据自己需求出去，应用到实践中去。\n\n","source":"_posts/vite/手写一个vite-mock-plugin.md","raw":"---\ntitle: 手写一个vite mock插件（篇二）\ntags: [vite]\ncategories: [前端工程化]\ndescription: 手写一个vite mock插件\ndate: 2022-07-29\ncover: https://urlify.cn/eAJj6b\n---\n\n# 手写一个vite mock插件（篇二）\n\n### 前言\n这里先给demo地址，可以直接看源码：[demo地址](https://github.com/kangkang123269/kate-demo/tree/main/vite/vite-mock-plugin)\n\n### 编写思路\n- 一开始干嘛？初始化。mock插件初始化什么，入口和能支持mock能力的devServer\n- 初始化完了，发现是不是有post，get等方法的路由请求，需不要给它分类？需要\n- 那怎么分类？考完重构一个对象的能力，是不是`so easy`.\n- 分为类是不是需要判断是否有效？有效就返回mock数据，无效执行下一个中间件\n- 前期这样想完全没有问题。\n\n来一条华丽的分割线\n\n----\n后期发现问题：\n- 发现中间件的next方法和res.send方法同时执行或导致程序中断\n\n解决这个问题我们需要判断路由是否有效，且不能在无效的时候去send和mock（假装自己知道就好了）\n\n- send函数在请求的时候需要给相应的信息，所以需要二次封装\n\n### 初始化\n\n我们从[vite初始篇一](https://juejin.cn/post/7125746860567822350)开始了解vite插件的钩子，我们需要开启一个服务去支持mock能力，需要用到`devServer`，很明显我们需要在`configureServer`这个钩子里面写，且需要mock数据的路径\n\n所以我们初始化的插件函数需要做两件事情：\n- 需要options参数入口，且为空的时候要给默认的入口\n- 在return的对象要用到`configureServer`的`server.middlewares`\n\n> server.middlewares相当于`express`的`app`\n\n~~~js\nimport path from 'path';\n\nexport default function (options = {}) {\n  // 获取mock文件入口，默认index\n  options.entry = options.entry || './mock/index.js';\n\n  // 转换为绝对路径\n  if (!path.isAbsolute(options.entry)) {\n    options.entry = path.resolve(process.cwd(), options.entry);\n  }\n\n  return {\n    configureServer: function ({ middlewares: app }) {\n        // 定义中间件：路由匹配\n      const middleware = (req, res, next) => {\n\n      };\n      app.use(middleware);\n    }\n  };\n}\n~~~\n\n再给我们的mock也初始下,下面看到我们是用的ES Moudle抛出方式，因为vite是不支持commonJS模块。所以我们需要用到`export default`，不能用到`module.exports`，本人亲测自己写一个支持require的插件也作用不到`mock`这个插件。（一个伤心的经历）\n\n~~~js\n// /mock/index.js\nexport default [\n  {\n    url: '/api/users',\n    type: 'get',\n    response: function (req, res) {\n      return res.send([\n        {\n          username: 'tom',\n          age: 18,\n        },\n        {\n          username: 'Tom',\n          age: 19,\n        },\n      ]);\n    },\n  },\n];\n~~~\n\n### 创建路由表\n\n我们需要的路由表是这种结构，一个方法对应多个路由，所以我们需要创建路由表。\n\n~~~json\n{\n    \"get\": [\n        {\n            \"url\": \"/api/1\",\n            \"type\": \"get\",\n            \"response\": function \n        },\n        {\n            \"url\": \"/api/2\",\n            \"type\": \"get\",\n            \"response\": function \n        },\n    ],\n    \"post\": [\n        {\n            \"url\": \"/api/1\",\n            \"type\": \"get\",\n            \"response\": function \n        },\n        {\n            \"url\": \"/api/2\",\n            \"type\": \"get\",\n            \"response\": function \n        },\n    ]\n}\n~~~\n\n首先获取路由，我们不能用require，所以用import. 但import是异步的，那么我们需要加上async/await等待加载完模块，用解构的方式获取mockObj\n\n~~~js\n...\nreturn {\n    configureServer: function ({ middlewares: app }) {\n        // 定义路由表\n        const mockObj = { ...(await import(options.entry)) }.default;\n        // 创建路由表\n        createRoute(mockObj);\n\n        ....\n         // 定义中间件：路由匹配\n        const middleware = (req, res, next) => {\n\n        };\n        app.use(middleware)\n    }\n};\n...\n~~~\n\n那么我们现在开始写`createRoute`函数，多尝试，也就一个简单的变量处理，下列写成函数如下：\n\n~~~js\nfunction createRoute(mockConfList) {\n  mockConfList.forEach((mockConf) => {\n    let method = mockConf.type || 'get';\n    let path = mockConf.url;\n    let handler = mockConf.response;\n    // 路由对象\n    let route = { path, method: method.toLowerCase(), handler };\n    // 如果没有改请求方法就初始化为空数组\n    if (!mockRouteMap[method]) {\n      mockRouteMap[method] = [];\n    }\n    console.log('create mock api: ', route.method, route.path);\n    // 存入映射对象中\n    mockRouteMap[method].push(route);\n  });\n}\n~~~\n创建完路由表，需要中间件里面的逻辑,也就是破路由和send数据到路由上面了。\n\n### 执行匹配路由和自定义send\n我们接下的逻辑可以这样写，先获取路由匹配的结果，如果匹配成功就send \n\n~~~js\n...\nreturn {\n    configureServer: async function ({ middlewares: app }) {\n      // 定义路由表\n      const mockObj = { ...(await import(options.entry)) }.default;\n      // 创建路由表\n      createRoute(mockObj);\n\n      // 定义中间件：路由匹配\n      const middleware = (req, res, next) => {\n        // 1. 执行匹配过程\n        let route = matchRoute(req);\n\n        // 2. 存在匹配，则这个是一个mock请求\n        if (route) {\n          console.log('mock request', route.method, route.path);\n          // 自定义send\n          res.send = send;\n          // 执行路由的`response`回调函数，可以把代码往前翻\n          route.handler(req, res);\n        } else {\n          next();\n        }\n      };\n      app.use(middleware);\n    },\n};\n\n...\n~~~\n\n#### 匹配路由\n\n根据我们浏览器请求的路由去匹配路由信息\n\n~~~js\nfunction matchRoute(req) {\n  let url = req.url;\n  let method = req.method.toLowerCase();\n  let routeList = mockRouteMap[method];\n\n  return routeList && routeList.find((item) => item.path === url);\n}\n~~~\n\n我们请求一个试下：\n\n`成功匹配`:\n\n![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e09bdc4eda6c458c90290fef6420279b~tplv-k3u1fbpfcp-watermark.image?)\n\n\n#### 自定义send\n\n这里自定义send我们可以添加请求头字段，能够知道请求的东西的类型，长度等信息\n\n~~~js\nfunction send(body) {\n  let chunk = JSON.stringify(body);\n  // Content-Length\n  if (chunk) {\n    chunk = Buffer.from(chunk, 'utf-8');\n    this.setHeader('Content-Length', chunk.length);\n  }\n  // content-type\n  this.setHeader('Content-Type', 'application/json');\n  // status\n  this.statusCode = 200;\n  // response\n  this.end(chunk, 'utf8');\n}\n~~~\n\n### 总结\n\nvite插件的掌握还是需要写些插件，看看别人的源码，了解为什么这么写，自己之后可以这样写。根据自己需求出去，应用到实践中去。\n\n","slug":"vite/手写一个vite-mock-plugin","published":1,"updated":"2022-10-12T02:50:25.546Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl95206cl000s3no27lhm8yok","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><h1 id=\"手写一个vite-mock插件（篇二）\"><a href=\"#手写一个vite-mock插件（篇二）\" class=\"headerlink\" title=\"手写一个vite mock插件（篇二）\"></a>手写一个vite mock插件（篇二）</h1><h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>这里先给demo地址，可以直接看源码：<a href=\"https://github.com/kangkang123269/kate-demo/tree/main/vite/vite-mock-plugin\">demo地址</a></p>\n<h3 id=\"编写思路\"><a href=\"#编写思路\" class=\"headerlink\" title=\"编写思路\"></a>编写思路</h3><ul>\n<li>一开始干嘛？初始化。mock插件初始化什么，入口和能支持mock能力的devServer</li>\n<li>初始化完了，发现是不是有post，get等方法的路由请求，需不要给它分类？需要</li>\n<li>那怎么分类？考完重构一个对象的能力，是不是<code>so easy</code>.</li>\n<li>分为类是不是需要判断是否有效？有效就返回mock数据，无效执行下一个中间件</li>\n<li>前期这样想完全没有问题。</li>\n</ul>\n<p>来一条华丽的分割线</p>\n<hr>\n<p>后期发现问题：</p>\n<ul>\n<li>发现中间件的next方法和res.send方法同时执行或导致程序中断</li>\n</ul>\n<p>解决这个问题我们需要判断路由是否有效，且不能在无效的时候去send和mock（假装自己知道就好了）</p>\n<ul>\n<li>send函数在请求的时候需要给相应的信息，所以需要二次封装</li>\n</ul>\n<h3 id=\"初始化\"><a href=\"#初始化\" class=\"headerlink\" title=\"初始化\"></a>初始化</h3><p>我们从<a href=\"https://juejin.cn/post/7125746860567822350\">vite初始篇一</a>开始了解vite插件的钩子，我们需要开启一个服务去支持mock能力，需要用到<code>devServer</code>，很明显我们需要在<code>configureServer</code>这个钩子里面写，且需要mock数据的路径</p>\n<p>所以我们初始化的插件函数需要做两件事情：</p>\n<ul>\n<li>需要options参数入口，且为空的时候要给默认的入口</li>\n<li>在return的对象要用到<code>configureServer</code>的<code>server.middlewares</code></li>\n</ul>\n<blockquote>\n<p>server.middlewares相当于<code>express</code>的<code>app</code></p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> path <span class=\"keyword\">from</span> <span class=\"string\">&#x27;path&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> (<span class=\"params\">options = &#123;&#125;</span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 获取mock文件入口，默认index</span></span><br><span class=\"line\">  options.<span class=\"property\">entry</span> = options.<span class=\"property\">entry</span> || <span class=\"string\">&#x27;./mock/index.js&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 转换为绝对路径</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!path.<span class=\"title function_\">isAbsolute</span>(options.<span class=\"property\">entry</span>)) &#123;</span><br><span class=\"line\">    options.<span class=\"property\">entry</span> = path.<span class=\"title function_\">resolve</span>(process.<span class=\"title function_\">cwd</span>(), options.<span class=\"property\">entry</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">    <span class=\"attr\">configureServer</span>: <span class=\"keyword\">function</span> (<span class=\"params\">&#123; middlewares: app &#125;</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 定义中间件：路由匹配</span></span><br><span class=\"line\">      <span class=\"keyword\">const</span> <span class=\"title function_\">middleware</span> = (<span class=\"params\">req, res, next</span>) =&gt; &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#125;;</span><br><span class=\"line\">      app.<span class=\"title function_\">use</span>(middleware);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>再给我们的mock也初始下,下面看到我们是用的ES Moudle抛出方式，因为vite是不支持commonJS模块。所以我们需要用到<code>export default</code>，不能用到<code>module.exports</code>，本人亲测自己写一个支持require的插件也作用不到<code>mock</code>这个插件。（一个伤心的经历）</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// /mock/index.js</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">url</span>: <span class=\"string\">&#x27;/api/users&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">type</span>: <span class=\"string\">&#x27;get&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">response</span>: <span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> res.<span class=\"title function_\">send</span>([</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          <span class=\"attr\">username</span>: <span class=\"string\">&#x27;tom&#x27;</span>,</span><br><span class=\"line\">          <span class=\"attr\">age</span>: <span class=\"number\">18</span>,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          <span class=\"attr\">username</span>: <span class=\"string\">&#x27;Tom&#x27;</span>,</span><br><span class=\"line\">          <span class=\"attr\">age</span>: <span class=\"number\">19</span>,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      ]);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"创建路由表\"><a href=\"#创建路由表\" class=\"headerlink\" title=\"创建路由表\"></a>创建路由表</h3><p>我们需要的路由表是这种结构，一个方法对应多个路由，所以我们需要创建路由表。</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;get&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;/api/1&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;get&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;response&quot;</span><span class=\"punctuation\">:</span> function </span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;/api/2&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;get&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;response&quot;</span><span class=\"punctuation\">:</span> function </span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;post&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;/api/1&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;get&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;response&quot;</span><span class=\"punctuation\">:</span> function </span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;/api/2&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;get&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;response&quot;</span><span class=\"punctuation\">:</span> function </span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"punctuation\">]</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>首先获取路由，我们不能用require，所以用import. 但import是异步的，那么我们需要加上async&#x2F;await等待加载完模块，用解构的方式获取mockObj</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\"><span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">    <span class=\"attr\">configureServer</span>: <span class=\"keyword\">function</span> (<span class=\"params\">&#123; middlewares: app &#125;</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 定义路由表</span></span><br><span class=\"line\">        <span class=\"keyword\">const</span> mockObj = &#123; ...(<span class=\"keyword\">await</span> <span class=\"title function_\">import</span>(options.<span class=\"property\">entry</span>)) &#125;.<span class=\"property\">default</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 创建路由表</span></span><br><span class=\"line\">        <span class=\"title function_\">createRoute</span>(mockObj);</span><br><span class=\"line\"></span><br><span class=\"line\">        ....</span><br><span class=\"line\">         <span class=\"comment\">// 定义中间件：路由匹配</span></span><br><span class=\"line\">        <span class=\"keyword\">const</span> <span class=\"title function_\">middleware</span> = (<span class=\"params\">req, res, next</span>) =&gt; &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        app.<span class=\"title function_\">use</span>(middleware)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<p>那么我们现在开始写<code>createRoute</code>函数，多尝试，也就一个简单的变量处理，下列写成函数如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">createRoute</span>(<span class=\"params\">mockConfList</span>) &#123;</span><br><span class=\"line\">  mockConfList.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">mockConf</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> method = mockConf.<span class=\"property\">type</span> || <span class=\"string\">&#x27;get&#x27;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> path = mockConf.<span class=\"property\">url</span>;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> handler = mockConf.<span class=\"property\">response</span>;</span><br><span class=\"line\">    <span class=\"comment\">// 路由对象</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> route = &#123; path, <span class=\"attr\">method</span>: method.<span class=\"title function_\">toLowerCase</span>(), handler &#125;;</span><br><span class=\"line\">    <span class=\"comment\">// 如果没有改请求方法就初始化为空数组</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!mockRouteMap[method]) &#123;</span><br><span class=\"line\">      mockRouteMap[method] = [];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;create mock api: &#x27;</span>, route.<span class=\"property\">method</span>, route.<span class=\"property\">path</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 存入映射对象中</span></span><br><span class=\"line\">    mockRouteMap[method].<span class=\"title function_\">push</span>(route);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>创建完路由表，需要中间件里面的逻辑,也就是破路由和send数据到路由上面了。</p>\n<h3 id=\"执行匹配路由和自定义send\"><a href=\"#执行匹配路由和自定义send\" class=\"headerlink\" title=\"执行匹配路由和自定义send\"></a>执行匹配路由和自定义send</h3><p>我们接下的逻辑可以这样写，先获取路由匹配的结果，如果匹配成功就send </p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\"><span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">    <span class=\"attr\">configureServer</span>: <span class=\"keyword\">async</span> <span class=\"keyword\">function</span> (<span class=\"params\">&#123; middlewares: app &#125;</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 定义路由表</span></span><br><span class=\"line\">      <span class=\"keyword\">const</span> mockObj = &#123; ...(<span class=\"keyword\">await</span> <span class=\"title function_\">import</span>(options.<span class=\"property\">entry</span>)) &#125;.<span class=\"property\">default</span>;</span><br><span class=\"line\">      <span class=\"comment\">// 创建路由表</span></span><br><span class=\"line\">      <span class=\"title function_\">createRoute</span>(mockObj);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// 定义中间件：路由匹配</span></span><br><span class=\"line\">      <span class=\"keyword\">const</span> <span class=\"title function_\">middleware</span> = (<span class=\"params\">req, res, next</span>) =&gt; &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 1. 执行匹配过程</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> route = <span class=\"title function_\">matchRoute</span>(req);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 2. 存在匹配，则这个是一个mock请求</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (route) &#123;</span><br><span class=\"line\">          <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;mock request&#x27;</span>, route.<span class=\"property\">method</span>, route.<span class=\"property\">path</span>);</span><br><span class=\"line\">          <span class=\"comment\">// 自定义send</span></span><br><span class=\"line\">          res.<span class=\"property\">send</span> = send;</span><br><span class=\"line\">          <span class=\"comment\">// 执行路由的`response`回调函数，可以把代码往前翻</span></span><br><span class=\"line\">          route.<span class=\"title function_\">handler</span>(req, res);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">          <span class=\"title function_\">next</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;;</span><br><span class=\"line\">      app.<span class=\"title function_\">use</span>(middleware);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"匹配路由\"><a href=\"#匹配路由\" class=\"headerlink\" title=\"匹配路由\"></a>匹配路由</h4><p>根据我们浏览器请求的路由去匹配路由信息</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">matchRoute</span>(<span class=\"params\">req</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> url = req.<span class=\"property\">url</span>;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> method = req.<span class=\"property\">method</span>.<span class=\"title function_\">toLowerCase</span>();</span><br><span class=\"line\">  <span class=\"keyword\">let</span> routeList = mockRouteMap[method];</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> routeList &amp;&amp; routeList.<span class=\"title function_\">find</span>(<span class=\"function\">(<span class=\"params\">item</span>) =&gt;</span> item.<span class=\"property\">path</span> === url);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>我们请求一个试下：</p>\n<p><code>成功匹配</code>:</p>\n<p><img src=\"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e09bdc4eda6c458c90290fef6420279b~tplv-k3u1fbpfcp-watermark.image\" alt=\"image.png\"></p>\n<h4 id=\"自定义send\"><a href=\"#自定义send\" class=\"headerlink\" title=\"自定义send\"></a>自定义send</h4><p>这里自定义send我们可以添加请求头字段，能够知道请求的东西的类型，长度等信息</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">send</span>(<span class=\"params\">body</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> chunk = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(body);</span><br><span class=\"line\">  <span class=\"comment\">// Content-Length</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (chunk) &#123;</span><br><span class=\"line\">    chunk = <span class=\"title class_\">Buffer</span>.<span class=\"title function_\">from</span>(chunk, <span class=\"string\">&#x27;utf-8&#x27;</span>);</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"title function_\">setHeader</span>(<span class=\"string\">&#x27;Content-Length&#x27;</span>, chunk.<span class=\"property\">length</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// content-type</span></span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"title function_\">setHeader</span>(<span class=\"string\">&#x27;Content-Type&#x27;</span>, <span class=\"string\">&#x27;application/json&#x27;</span>);</span><br><span class=\"line\">  <span class=\"comment\">// status</span></span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"property\">statusCode</span> = <span class=\"number\">200</span>;</span><br><span class=\"line\">  <span class=\"comment\">// response</span></span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"title function_\">end</span>(chunk, <span class=\"string\">&#x27;utf8&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h3><p>vite插件的掌握还是需要写些插件，看看别人的源码，了解为什么这么写，自己之后可以这样写。根据自己需求出去，应用到实践中去。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"手写一个vite-mock插件（篇二）\"><a href=\"#手写一个vite-mock插件（篇二）\" class=\"headerlink\" title=\"手写一个vite mock插件（篇二）\"></a>手写一个vite mock插件（篇二）</h1><h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>这里先给demo地址，可以直接看源码：<a href=\"https://github.com/kangkang123269/kate-demo/tree/main/vite/vite-mock-plugin\">demo地址</a></p>\n<h3 id=\"编写思路\"><a href=\"#编写思路\" class=\"headerlink\" title=\"编写思路\"></a>编写思路</h3><ul>\n<li>一开始干嘛？初始化。mock插件初始化什么，入口和能支持mock能力的devServer</li>\n<li>初始化完了，发现是不是有post，get等方法的路由请求，需不要给它分类？需要</li>\n<li>那怎么分类？考完重构一个对象的能力，是不是<code>so easy</code>.</li>\n<li>分为类是不是需要判断是否有效？有效就返回mock数据，无效执行下一个中间件</li>\n<li>前期这样想完全没有问题。</li>\n</ul>\n<p>来一条华丽的分割线</p>\n<hr>\n<p>后期发现问题：</p>\n<ul>\n<li>发现中间件的next方法和res.send方法同时执行或导致程序中断</li>\n</ul>\n<p>解决这个问题我们需要判断路由是否有效，且不能在无效的时候去send和mock（假装自己知道就好了）</p>\n<ul>\n<li>send函数在请求的时候需要给相应的信息，所以需要二次封装</li>\n</ul>\n<h3 id=\"初始化\"><a href=\"#初始化\" class=\"headerlink\" title=\"初始化\"></a>初始化</h3><p>我们从<a href=\"https://juejin.cn/post/7125746860567822350\">vite初始篇一</a>开始了解vite插件的钩子，我们需要开启一个服务去支持mock能力，需要用到<code>devServer</code>，很明显我们需要在<code>configureServer</code>这个钩子里面写，且需要mock数据的路径</p>\n<p>所以我们初始化的插件函数需要做两件事情：</p>\n<ul>\n<li>需要options参数入口，且为空的时候要给默认的入口</li>\n<li>在return的对象要用到<code>configureServer</code>的<code>server.middlewares</code></li>\n</ul>\n<blockquote>\n<p>server.middlewares相当于<code>express</code>的<code>app</code></p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> path <span class=\"keyword\">from</span> <span class=\"string\">&#x27;path&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> (<span class=\"params\">options = &#123;&#125;</span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 获取mock文件入口，默认index</span></span><br><span class=\"line\">  options.<span class=\"property\">entry</span> = options.<span class=\"property\">entry</span> || <span class=\"string\">&#x27;./mock/index.js&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 转换为绝对路径</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!path.<span class=\"title function_\">isAbsolute</span>(options.<span class=\"property\">entry</span>)) &#123;</span><br><span class=\"line\">    options.<span class=\"property\">entry</span> = path.<span class=\"title function_\">resolve</span>(process.<span class=\"title function_\">cwd</span>(), options.<span class=\"property\">entry</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">    <span class=\"attr\">configureServer</span>: <span class=\"keyword\">function</span> (<span class=\"params\">&#123; middlewares: app &#125;</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 定义中间件：路由匹配</span></span><br><span class=\"line\">      <span class=\"keyword\">const</span> <span class=\"title function_\">middleware</span> = (<span class=\"params\">req, res, next</span>) =&gt; &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#125;;</span><br><span class=\"line\">      app.<span class=\"title function_\">use</span>(middleware);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>再给我们的mock也初始下,下面看到我们是用的ES Moudle抛出方式，因为vite是不支持commonJS模块。所以我们需要用到<code>export default</code>，不能用到<code>module.exports</code>，本人亲测自己写一个支持require的插件也作用不到<code>mock</code>这个插件。（一个伤心的经历）</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// /mock/index.js</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">url</span>: <span class=\"string\">&#x27;/api/users&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">type</span>: <span class=\"string\">&#x27;get&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">response</span>: <span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> res.<span class=\"title function_\">send</span>([</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          <span class=\"attr\">username</span>: <span class=\"string\">&#x27;tom&#x27;</span>,</span><br><span class=\"line\">          <span class=\"attr\">age</span>: <span class=\"number\">18</span>,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          <span class=\"attr\">username</span>: <span class=\"string\">&#x27;Tom&#x27;</span>,</span><br><span class=\"line\">          <span class=\"attr\">age</span>: <span class=\"number\">19</span>,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      ]);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"创建路由表\"><a href=\"#创建路由表\" class=\"headerlink\" title=\"创建路由表\"></a>创建路由表</h3><p>我们需要的路由表是这种结构，一个方法对应多个路由，所以我们需要创建路由表。</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;get&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;/api/1&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;get&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;response&quot;</span><span class=\"punctuation\">:</span> function </span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;/api/2&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;get&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;response&quot;</span><span class=\"punctuation\">:</span> function </span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;post&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;/api/1&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;get&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;response&quot;</span><span class=\"punctuation\">:</span> function </span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;/api/2&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;get&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;response&quot;</span><span class=\"punctuation\">:</span> function </span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"punctuation\">]</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>首先获取路由，我们不能用require，所以用import. 但import是异步的，那么我们需要加上async&#x2F;await等待加载完模块，用解构的方式获取mockObj</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\"><span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">    <span class=\"attr\">configureServer</span>: <span class=\"keyword\">function</span> (<span class=\"params\">&#123; middlewares: app &#125;</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 定义路由表</span></span><br><span class=\"line\">        <span class=\"keyword\">const</span> mockObj = &#123; ...(<span class=\"keyword\">await</span> <span class=\"title function_\">import</span>(options.<span class=\"property\">entry</span>)) &#125;.<span class=\"property\">default</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 创建路由表</span></span><br><span class=\"line\">        <span class=\"title function_\">createRoute</span>(mockObj);</span><br><span class=\"line\"></span><br><span class=\"line\">        ....</span><br><span class=\"line\">         <span class=\"comment\">// 定义中间件：路由匹配</span></span><br><span class=\"line\">        <span class=\"keyword\">const</span> <span class=\"title function_\">middleware</span> = (<span class=\"params\">req, res, next</span>) =&gt; &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        app.<span class=\"title function_\">use</span>(middleware)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<p>那么我们现在开始写<code>createRoute</code>函数，多尝试，也就一个简单的变量处理，下列写成函数如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">createRoute</span>(<span class=\"params\">mockConfList</span>) &#123;</span><br><span class=\"line\">  mockConfList.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">mockConf</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> method = mockConf.<span class=\"property\">type</span> || <span class=\"string\">&#x27;get&#x27;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> path = mockConf.<span class=\"property\">url</span>;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> handler = mockConf.<span class=\"property\">response</span>;</span><br><span class=\"line\">    <span class=\"comment\">// 路由对象</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> route = &#123; path, <span class=\"attr\">method</span>: method.<span class=\"title function_\">toLowerCase</span>(), handler &#125;;</span><br><span class=\"line\">    <span class=\"comment\">// 如果没有改请求方法就初始化为空数组</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!mockRouteMap[method]) &#123;</span><br><span class=\"line\">      mockRouteMap[method] = [];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;create mock api: &#x27;</span>, route.<span class=\"property\">method</span>, route.<span class=\"property\">path</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 存入映射对象中</span></span><br><span class=\"line\">    mockRouteMap[method].<span class=\"title function_\">push</span>(route);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>创建完路由表，需要中间件里面的逻辑,也就是破路由和send数据到路由上面了。</p>\n<h3 id=\"执行匹配路由和自定义send\"><a href=\"#执行匹配路由和自定义send\" class=\"headerlink\" title=\"执行匹配路由和自定义send\"></a>执行匹配路由和自定义send</h3><p>我们接下的逻辑可以这样写，先获取路由匹配的结果，如果匹配成功就send </p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\"><span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">    <span class=\"attr\">configureServer</span>: <span class=\"keyword\">async</span> <span class=\"keyword\">function</span> (<span class=\"params\">&#123; middlewares: app &#125;</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 定义路由表</span></span><br><span class=\"line\">      <span class=\"keyword\">const</span> mockObj = &#123; ...(<span class=\"keyword\">await</span> <span class=\"title function_\">import</span>(options.<span class=\"property\">entry</span>)) &#125;.<span class=\"property\">default</span>;</span><br><span class=\"line\">      <span class=\"comment\">// 创建路由表</span></span><br><span class=\"line\">      <span class=\"title function_\">createRoute</span>(mockObj);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// 定义中间件：路由匹配</span></span><br><span class=\"line\">      <span class=\"keyword\">const</span> <span class=\"title function_\">middleware</span> = (<span class=\"params\">req, res, next</span>) =&gt; &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 1. 执行匹配过程</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> route = <span class=\"title function_\">matchRoute</span>(req);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 2. 存在匹配，则这个是一个mock请求</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (route) &#123;</span><br><span class=\"line\">          <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;mock request&#x27;</span>, route.<span class=\"property\">method</span>, route.<span class=\"property\">path</span>);</span><br><span class=\"line\">          <span class=\"comment\">// 自定义send</span></span><br><span class=\"line\">          res.<span class=\"property\">send</span> = send;</span><br><span class=\"line\">          <span class=\"comment\">// 执行路由的`response`回调函数，可以把代码往前翻</span></span><br><span class=\"line\">          route.<span class=\"title function_\">handler</span>(req, res);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">          <span class=\"title function_\">next</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;;</span><br><span class=\"line\">      app.<span class=\"title function_\">use</span>(middleware);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"匹配路由\"><a href=\"#匹配路由\" class=\"headerlink\" title=\"匹配路由\"></a>匹配路由</h4><p>根据我们浏览器请求的路由去匹配路由信息</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">matchRoute</span>(<span class=\"params\">req</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> url = req.<span class=\"property\">url</span>;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> method = req.<span class=\"property\">method</span>.<span class=\"title function_\">toLowerCase</span>();</span><br><span class=\"line\">  <span class=\"keyword\">let</span> routeList = mockRouteMap[method];</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> routeList &amp;&amp; routeList.<span class=\"title function_\">find</span>(<span class=\"function\">(<span class=\"params\">item</span>) =&gt;</span> item.<span class=\"property\">path</span> === url);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>我们请求一个试下：</p>\n<p><code>成功匹配</code>:</p>\n<p><img src=\"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e09bdc4eda6c458c90290fef6420279b~tplv-k3u1fbpfcp-watermark.image\" alt=\"image.png\"></p>\n<h4 id=\"自定义send\"><a href=\"#自定义send\" class=\"headerlink\" title=\"自定义send\"></a>自定义send</h4><p>这里自定义send我们可以添加请求头字段，能够知道请求的东西的类型，长度等信息</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">send</span>(<span class=\"params\">body</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> chunk = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(body);</span><br><span class=\"line\">  <span class=\"comment\">// Content-Length</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (chunk) &#123;</span><br><span class=\"line\">    chunk = <span class=\"title class_\">Buffer</span>.<span class=\"title function_\">from</span>(chunk, <span class=\"string\">&#x27;utf-8&#x27;</span>);</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"title function_\">setHeader</span>(<span class=\"string\">&#x27;Content-Length&#x27;</span>, chunk.<span class=\"property\">length</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// content-type</span></span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"title function_\">setHeader</span>(<span class=\"string\">&#x27;Content-Type&#x27;</span>, <span class=\"string\">&#x27;application/json&#x27;</span>);</span><br><span class=\"line\">  <span class=\"comment\">// status</span></span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"property\">statusCode</span> = <span class=\"number\">200</span>;</span><br><span class=\"line\">  <span class=\"comment\">// response</span></span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"title function_\">end</span>(chunk, <span class=\"string\">&#x27;utf8&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h3><p>vite插件的掌握还是需要写些插件，看看别人的源码，了解为什么这么写，自己之后可以这样写。根据自己需求出去，应用到实践中去。</p>\n"},{"title":"在Vue中使用keep-alive","description":"在Vue中使用keep-alive","date":"2022-07-26T16:00:00.000Z","cover":"https://urlify.cn/fYrUr2","_content":"\n# 在Vue中使用keep-alive\n\n### 一、路由router添加meta配置\n\n~~~js\nconst routes = [\n  {\n    path: '/keepalive',\n    name: 'keepalive',\n    component: ()=>import('../views/keepalive.vue'),\n    meta: {\n          keepAlive: false //设置页面是否需要使用缓存\n    }\n  }\n]\n~~~\n\n### 二、在Vue2.0的keep-alive的使用\nvue2.0中直接在你想要做缓存的位置，一般使用场景为配合router-view进行使用。\n~~~js\n<template>\n    <!-- vue2.x配置 --> \n    <keep-alive> \n        <router-view v-if=\"$route.meta.keepAlive\" /> \n    </keep-alive> \n    <router-view v-if=\"!$route.meta.keepAlive\"/> \n</template>\n~~~\n\n### 三、在Vue3.0的keep-alive的使用\nVue3.0配合的slot插槽使用，使用is来绑定对应路由的组件。\n\n> 修改添加key值的绑定，如果不加key值无法实现页面缓存。\n~~~js\n<template> \n    <!-- vue3.0配置 --> \n    <router-view v-slot=\"{ Component }\"> \n    <keep-alive> \n        <component :is=\"Component\" :key=\"$route.name\" v-if=\"$route.meta.keepAlive\"/> \n    </keep-alive> \n        <component :is=\"Component\" :key=\"$route.name\" v-if=\"!$route.meta.keepAlive\"/> \n    </router-view> \n</template>\n~~~","source":"_posts/vue/在Vue中使用keep-alive.md","raw":"---\ntitle: 在Vue中使用keep-alive\ntags: [前端,Vue,前端性能优化]\ncategories: [Vue]\ndescription: 在Vue中使用keep-alive\ndate: 2022-07-27\ncover: https://urlify.cn/fYrUr2\n---\n\n# 在Vue中使用keep-alive\n\n### 一、路由router添加meta配置\n\n~~~js\nconst routes = [\n  {\n    path: '/keepalive',\n    name: 'keepalive',\n    component: ()=>import('../views/keepalive.vue'),\n    meta: {\n          keepAlive: false //设置页面是否需要使用缓存\n    }\n  }\n]\n~~~\n\n### 二、在Vue2.0的keep-alive的使用\nvue2.0中直接在你想要做缓存的位置，一般使用场景为配合router-view进行使用。\n~~~js\n<template>\n    <!-- vue2.x配置 --> \n    <keep-alive> \n        <router-view v-if=\"$route.meta.keepAlive\" /> \n    </keep-alive> \n    <router-view v-if=\"!$route.meta.keepAlive\"/> \n</template>\n~~~\n\n### 三、在Vue3.0的keep-alive的使用\nVue3.0配合的slot插槽使用，使用is来绑定对应路由的组件。\n\n> 修改添加key值的绑定，如果不加key值无法实现页面缓存。\n~~~js\n<template> \n    <!-- vue3.0配置 --> \n    <router-view v-slot=\"{ Component }\"> \n    <keep-alive> \n        <component :is=\"Component\" :key=\"$route.name\" v-if=\"$route.meta.keepAlive\"/> \n    </keep-alive> \n        <component :is=\"Component\" :key=\"$route.name\" v-if=\"!$route.meta.keepAlive\"/> \n    </router-view> \n</template>\n~~~","slug":"vue/在Vue中使用keep-alive","published":1,"updated":"2022-10-12T02:50:25.546Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl95206cm000v3no220fl22rq","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><h1 id=\"在Vue中使用keep-alive\"><a href=\"#在Vue中使用keep-alive\" class=\"headerlink\" title=\"在Vue中使用keep-alive\"></a>在Vue中使用keep-alive</h1><h3 id=\"一、路由router添加meta配置\"><a href=\"#一、路由router添加meta配置\" class=\"headerlink\" title=\"一、路由router添加meta配置\"></a>一、路由router添加meta配置</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: <span class=\"string\">&#x27;/keepalive&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;keepalive&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">component</span>: <span class=\"function\">()=&gt;</span><span class=\"title function_\">import</span>(<span class=\"string\">&#x27;../views/keepalive.vue&#x27;</span>),</span><br><span class=\"line\">    <span class=\"attr\">meta</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">keepAlive</span>: <span class=\"literal\">false</span> <span class=\"comment\">//设置页面是否需要使用缓存</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"二、在Vue2-0的keep-alive的使用\"><a href=\"#二、在Vue2-0的keep-alive的使用\" class=\"headerlink\" title=\"二、在Vue2.0的keep-alive的使用\"></a>二、在Vue2.0的keep-alive的使用</h3><p>vue2.0中直接在你想要做缓存的位置，一般使用场景为配合router-view进行使用。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">    &lt;!-- vue2.<span class=\"property\">x</span>配置 --&gt; </span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">keep-alive</span>&gt;</span> </span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">router-view</span> <span class=\"attr\">v-if</span>=<span class=\"string\">&quot;$route.meta.keepAlive&quot;</span> /&gt;</span> </span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">keep-alive</span>&gt;</span></span> </span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">router-view</span> <span class=\"attr\">v-if</span>=<span class=\"string\">&quot;!$route.meta.keepAlive&quot;</span>/&gt;</span></span> </span><br><span class=\"line\">&lt;/template&gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"三、在Vue3-0的keep-alive的使用\"><a href=\"#三、在Vue3-0的keep-alive的使用\" class=\"headerlink\" title=\"三、在Vue3.0的keep-alive的使用\"></a>三、在Vue3.0的keep-alive的使用</h3><p>Vue3.0配合的slot插槽使用，使用is来绑定对应路由的组件。</p>\n<blockquote>\n<p>修改添加key值的绑定，如果不加key值无法实现页面缓存。</p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt; </span><br><span class=\"line\">    &lt;!-- vue3<span class=\"number\">.0</span>配置 --&gt; </span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">router-view</span> <span class=\"attr\">v-slot</span>=<span class=\"string\">&quot;&#123; Component &#125;&quot;</span>&gt;</span> </span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;<span class=\"name\">keep-alive</span>&gt;</span> </span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">component</span> <span class=\"attr\">:is</span>=<span class=\"string\">&quot;Component&quot;</span> <span class=\"attr\">:key</span>=<span class=\"string\">&quot;$route.name&quot;</span> <span class=\"attr\">v-if</span>=<span class=\"string\">&quot;$route.meta.keepAlive&quot;</span>/&gt;</span> </span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">keep-alive</span>&gt;</span> </span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">component</span> <span class=\"attr\">:is</span>=<span class=\"string\">&quot;Component&quot;</span> <span class=\"attr\">:key</span>=<span class=\"string\">&quot;$route.name&quot;</span> <span class=\"attr\">v-if</span>=<span class=\"string\">&quot;!$route.meta.keepAlive&quot;</span>/&gt;</span> </span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">router-view</span>&gt;</span></span> </span><br><span class=\"line\">&lt;/template&gt;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"在Vue中使用keep-alive\"><a href=\"#在Vue中使用keep-alive\" class=\"headerlink\" title=\"在Vue中使用keep-alive\"></a>在Vue中使用keep-alive</h1><h3 id=\"一、路由router添加meta配置\"><a href=\"#一、路由router添加meta配置\" class=\"headerlink\" title=\"一、路由router添加meta配置\"></a>一、路由router添加meta配置</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: <span class=\"string\">&#x27;/keepalive&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;keepalive&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">component</span>: <span class=\"function\">()=&gt;</span><span class=\"title function_\">import</span>(<span class=\"string\">&#x27;../views/keepalive.vue&#x27;</span>),</span><br><span class=\"line\">    <span class=\"attr\">meta</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">keepAlive</span>: <span class=\"literal\">false</span> <span class=\"comment\">//设置页面是否需要使用缓存</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"二、在Vue2-0的keep-alive的使用\"><a href=\"#二、在Vue2-0的keep-alive的使用\" class=\"headerlink\" title=\"二、在Vue2.0的keep-alive的使用\"></a>二、在Vue2.0的keep-alive的使用</h3><p>vue2.0中直接在你想要做缓存的位置，一般使用场景为配合router-view进行使用。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">    &lt;!-- vue2.<span class=\"property\">x</span>配置 --&gt; </span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">keep-alive</span>&gt;</span> </span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">router-view</span> <span class=\"attr\">v-if</span>=<span class=\"string\">&quot;$route.meta.keepAlive&quot;</span> /&gt;</span> </span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">keep-alive</span>&gt;</span></span> </span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">router-view</span> <span class=\"attr\">v-if</span>=<span class=\"string\">&quot;!$route.meta.keepAlive&quot;</span>/&gt;</span></span> </span><br><span class=\"line\">&lt;/template&gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"三、在Vue3-0的keep-alive的使用\"><a href=\"#三、在Vue3-0的keep-alive的使用\" class=\"headerlink\" title=\"三、在Vue3.0的keep-alive的使用\"></a>三、在Vue3.0的keep-alive的使用</h3><p>Vue3.0配合的slot插槽使用，使用is来绑定对应路由的组件。</p>\n<blockquote>\n<p>修改添加key值的绑定，如果不加key值无法实现页面缓存。</p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt; </span><br><span class=\"line\">    &lt;!-- vue3<span class=\"number\">.0</span>配置 --&gt; </span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">router-view</span> <span class=\"attr\">v-slot</span>=<span class=\"string\">&quot;&#123; Component &#125;&quot;</span>&gt;</span> </span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;<span class=\"name\">keep-alive</span>&gt;</span> </span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">component</span> <span class=\"attr\">:is</span>=<span class=\"string\">&quot;Component&quot;</span> <span class=\"attr\">:key</span>=<span class=\"string\">&quot;$route.name&quot;</span> <span class=\"attr\">v-if</span>=<span class=\"string\">&quot;$route.meta.keepAlive&quot;</span>/&gt;</span> </span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">keep-alive</span>&gt;</span> </span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">component</span> <span class=\"attr\">:is</span>=<span class=\"string\">&quot;Component&quot;</span> <span class=\"attr\">:key</span>=<span class=\"string\">&quot;$route.name&quot;</span> <span class=\"attr\">v-if</span>=<span class=\"string\">&quot;!$route.meta.keepAlive&quot;</span>/&gt;</span> </span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">router-view</span>&gt;</span></span> </span><br><span class=\"line\">&lt;/template&gt;</span><br></pre></td></tr></table></figure>"},{"title":"个人错题集","description":"前端个人错题集","date":"2022-10-11T16:00:00.000Z","cover":"https://urlify.cn/2Ev2Qz","_content":"\n# 个人错题集\n\n## react\n\n1. <Route />中的 path 属性可以使用通配符，以下关于通配符的规则描述错误的是？\n\n```text\nA. “:paramName”： 匹配URL的一个部分，直到遇到下一个/、?、#为止。这个路径参数可以通过this.props.params.paramName取出\n```\n\n```text\nB. “()”： ()表示URL的这个部分是可选的。\n```\n\n```text\nC. “*”： *匹配任意字符，直到模式里面的下一个字符为止。匹配方式是贪婪模式。\n```\n\n```text\nD. “**”：** 匹配任意字符，直到下一个/、?、#为止。匹配方式是贪婪模式。\n```\n\n<details> \n<summary>查看答案</summary> \n    \n~~~text\n答案为D，*匹配任意字符，直到模式里面的下一个字符为止。匹配方式是非贪婪模式。\n~~~\n    \n</details>\n\n2. 关于“错误边界”，以下说法错误的是？\n\n```\nA. static getDerivedStateFromError() 可以用来渲染备用UI\n```\n\n```\nB. componentDidCatch()可以打印错误信息\n```\n\n```\nC. 错误边界是一种React组件，这种组件可以捕获并打印发生在当前组件的javaScript错误\n```\n\n```\nD. class组件中只要定义了static getDerivedStateFromError()或componentDidCatch()其中一个，该组件就会变成错误边界\n```\n\n<details> \n<summary>查看答案</summary> \n    \n~~~\n答案为C\n解析：错误边界无法捕获 以下四种场景中产生的错误： \n    1.`事件处理函数`（因为 Error Boundaries 实现的本质是触发更新，但是事件处理函数不在render或者commit阶段，所以无法进行捕获，\n如果你需要在事件处理器内部捕获错误，可以使用原生的 try / catch 语句 ） \n    2. 异步代码（例如 setTimeout 或 requestAnimationFrame 回调函数） \n    3. 服务端渲染（因为触发更新只能在客户端进行，不能在serve端进行） \n    4. 它自身抛出来的错误（因为错误抛出要向父节点冒泡寻找 Error Boundaries 处理，无法处理自身产生的错误）\n~~~\n    \n</details>\n\n3. 以下不属于 React 支持的触摸事件的是？\n\n```\nA. onTouchCancel\n```\n\n```\nB. onTouchEnd\n```\n\n```\nC. onTouchStart\n```\n\n```\nD. onTouchOver\n```\n\n<details> \n<summary>查看答案</summary>\n\n答案为 D\nReact 支持的触摸事件有：onTouchStart，onTouchMove，onTouchEnd，onTouchCancel\n\n| 事件          | 触发时机                                               |\n| ------------- | ------------------------------------------------------ |\n| onTouchStart  | 手指触摸屏幕的时候触发                                 |\n| onTouchMove   | 手指在屏幕上滑动的时候触发                             |\n| onTouchEnd    | 手指从屏幕上移开的时候触发                             |\n| onTouchCancel | 触摸事件被中断时发生，如：来电话、来短信、弹出消息提示 |\n\n</details>\n\n4. 以下哪项对 react-router-dom 中组件分类是错误的?\n\n```\nA. 路由器组件: BrowserRouter和HashRouter\n```\n\n```\nB. 导航组件: Link和NavLink\n```\n\n```\nC. 路由匹配组件: Route和Switch\n```\n\n```\nD. 导航组件: Route和Switch\n```\n\n<details> \n<summary>查看答案</summary>\n\n```text\n答案为D\n解析：在react-router-dom中通常使用的组件有三种路由器组件: 如BrowserRouter和HashRouter\n\n路由匹配组件: Route和Switch 组件\n\n导航组件: Link和NavLink 组件\n```\n\n</details>\n\n5. 以下不属于 react 支持的剪贴板事件的是?\n\n```\nA. onCopy\n```\n\n```\nB. onPaste\n```\n\n```\nC. onCut\n```\n\n```\nD. onBeforeCopy\n```\n\n<details> \n<summary>查看答案</summary>\n\n```text\n答案为D\n解析：react支持的剪贴板事件有onCopy，onCut，onPaste\n```\n\n</details>\n\n6. 以下不属于 StrictMode 的作用或优点的是？\n\n```\nA. 检测过时的 context API\n```\n\n```\nB. 识别不安全的生命周期\n```\n\n```\nC. 检测意外的副作用\n```\n\n```\nD. 在生产环境也生效\n```\n\n<details> \n<summary>查看答案</summary>\n\n```text\n答案为D\n解析：严格模式检查仅在开发模式下运行，它们不会影响生产构建。\n```\n\n</details>\n\n7. 以下关于 Mobx 中原则说法错误的是?\n\n```\nA. Mobx 支持单向数据流\n```\n\n```\nB. 当状态改变时，所有衍生都会进行自动更新，可以观察到中间值\n```\n\n```\nC. 所有衍生默认都是同步更新\n```\n\n```\nD. 所有的计算值都应该是纯净的\n```\n\n<details> \n<summary>查看答案</summary>\n\n```text\n答案为B\n解析：当状态改变时，所有衍生都会进行原子级的自动更新。因此永远不可能观察到中间值。\n```\n\n</details>\n\n8. 关于 Context 一下说法错误的是？\n\n```\nA. Context提供了一种在组件之间共享此类值的方式，而不必显式地通过组件树的逐层传递 props\n```\n\n```\nB. Context设计目的是为了共享那些对于一个组件树而言是“全局”的数据\n```\n\n```\nC. Context会提高组件的复用性\n```\n\n```\nD. Context能让你将这些数据向组件树下所有的组件进行“广播”，所有的组件都能访问到这些数据，也能访问到后续的数据更新\n```\n\n<details> \n<summary>查看答案</summary>\n\n```text\n答案为C\n解析：当一些值需要在多个组件间共享的时候，context是个可以避免数据层层传递的方法，但他会使得组件得复用性变差。\n```\n\n</details>\n\n9. 以下关于 useContext 说法错误的是?\n\n```\nA. 调用了useContext的组件总会在context值变化时重新渲染\n```\n\n```\nB. 当组件上层最近的 <MyContext.Provider> 更新时，该 Hook 会触发重渲染\n```\n\n```\nC. useContext 的参数必须是 context 对象本身：\n```\n\n```\nD. 当组件最上层的 <MyContext.Provider> 更新时，该 Hook 会触发重渲染\n```\n\n<details> \n<summary>查看答案</summary>\n\n```text\n答案为C\n解析：useContext 的参数必须是 *context 对象本身*：\n当组件上层最近的 <MyContext.Provider> 更新时，该 Hook 会触发重渲染，并使用最新传递给 MyContext provider 的 context value 值。\n```\n\n</details>\n\n10. 可以使子节点渲染到存在于父组件以外的 DOM 节点上的方法是?\n\n```\nA. React.createPortal\n```\n\n```\nB. React.createElement\n```\n\n```\nC. ReactDOM.createPortal\n```\n\n```\nD. ReactDom.render\n```\n\n<details> \n<summary>查看答案</summary>\n\n```text\n答案为C\n解析：ReactDOM.createPortal函数可以将子节点渲染到存在于父组件以外的DOM节点上。\n```\n\n</details>\n    \n11. 关于React中的“状态提升”说法错误的是?\n\n```\nA. React建议任何可变数据应当只有一个相对应的唯一“数据源”\n```\n\n```\nB. 提升状态(state)方式相比于双向绑定方式需要编写更多的“样板”代码\n```\n\n```\nC. 虽然某些数据可以由props或state推导得出，但是我们最好还是单独在state声明它\n```\n\n```\nD. 通常，多个组件需要反映相同的变化数据，都应尽量将共享状态提升到最近的公共父组件中去\n```\n\n<details> \n<summary>查看答案</summary>\n\n```text\n答案为C\n解析：其中ABD都为官方说法，C选项中如果某些数据可以由props或state推导得出，那么就不应该将其在state中声明。\n```\n\n</details>\n\n## 其他\n\n1. 请选择下面代码输出 1 的次数\n\n```js\nvar vm = new Vue({\n  el: \"#example\",\n  data: {\n    message: \"Hello\",\n  },\n  computed: {\n    test: function () {\n      console.log(1);\n      return this.message;\n    },\n  },\n  created: function () {\n    this.message = \"World\";\n    for (var i = 0; i < 5; i++) {\n      console.log(this.test);\n    }\n  },\n});\n```\n\n解释：因为 vue 的 `computed` 具有`缓存`功能。`message` 只`更新了一次`，所以 `test` `只触发一次`，执行一次 console.log(1)。\n具体来说，computed 内的 test 函数会被加入到 message 这个响应式数据的依赖视图中，当修改了 message（触发了 message 的 set）之后，test 这个 computed 的 dirty 属性会被设置为 true，当视图渲染的时候，发现 dirty 为 true 了，就会执行 1 次 test 函数以获取最新的值。\n","source":"_posts/前端笔试/错题集.md","raw":"---\ntitle: 个人错题集\ntags: [前端, 错题集]\ncategories: [前端笔试]\ndescription: 前端个人错题集\ndate: 2022-10-12\ncover: https://urlify.cn/2Ev2Qz\n---\n\n# 个人错题集\n\n## react\n\n1. <Route />中的 path 属性可以使用通配符，以下关于通配符的规则描述错误的是？\n\n```text\nA. “:paramName”： 匹配URL的一个部分，直到遇到下一个/、?、#为止。这个路径参数可以通过this.props.params.paramName取出\n```\n\n```text\nB. “()”： ()表示URL的这个部分是可选的。\n```\n\n```text\nC. “*”： *匹配任意字符，直到模式里面的下一个字符为止。匹配方式是贪婪模式。\n```\n\n```text\nD. “**”：** 匹配任意字符，直到下一个/、?、#为止。匹配方式是贪婪模式。\n```\n\n<details> \n<summary>查看答案</summary> \n    \n~~~text\n答案为D，*匹配任意字符，直到模式里面的下一个字符为止。匹配方式是非贪婪模式。\n~~~\n    \n</details>\n\n2. 关于“错误边界”，以下说法错误的是？\n\n```\nA. static getDerivedStateFromError() 可以用来渲染备用UI\n```\n\n```\nB. componentDidCatch()可以打印错误信息\n```\n\n```\nC. 错误边界是一种React组件，这种组件可以捕获并打印发生在当前组件的javaScript错误\n```\n\n```\nD. class组件中只要定义了static getDerivedStateFromError()或componentDidCatch()其中一个，该组件就会变成错误边界\n```\n\n<details> \n<summary>查看答案</summary> \n    \n~~~\n答案为C\n解析：错误边界无法捕获 以下四种场景中产生的错误： \n    1.`事件处理函数`（因为 Error Boundaries 实现的本质是触发更新，但是事件处理函数不在render或者commit阶段，所以无法进行捕获，\n如果你需要在事件处理器内部捕获错误，可以使用原生的 try / catch 语句 ） \n    2. 异步代码（例如 setTimeout 或 requestAnimationFrame 回调函数） \n    3. 服务端渲染（因为触发更新只能在客户端进行，不能在serve端进行） \n    4. 它自身抛出来的错误（因为错误抛出要向父节点冒泡寻找 Error Boundaries 处理，无法处理自身产生的错误）\n~~~\n    \n</details>\n\n3. 以下不属于 React 支持的触摸事件的是？\n\n```\nA. onTouchCancel\n```\n\n```\nB. onTouchEnd\n```\n\n```\nC. onTouchStart\n```\n\n```\nD. onTouchOver\n```\n\n<details> \n<summary>查看答案</summary>\n\n答案为 D\nReact 支持的触摸事件有：onTouchStart，onTouchMove，onTouchEnd，onTouchCancel\n\n| 事件          | 触发时机                                               |\n| ------------- | ------------------------------------------------------ |\n| onTouchStart  | 手指触摸屏幕的时候触发                                 |\n| onTouchMove   | 手指在屏幕上滑动的时候触发                             |\n| onTouchEnd    | 手指从屏幕上移开的时候触发                             |\n| onTouchCancel | 触摸事件被中断时发生，如：来电话、来短信、弹出消息提示 |\n\n</details>\n\n4. 以下哪项对 react-router-dom 中组件分类是错误的?\n\n```\nA. 路由器组件: BrowserRouter和HashRouter\n```\n\n```\nB. 导航组件: Link和NavLink\n```\n\n```\nC. 路由匹配组件: Route和Switch\n```\n\n```\nD. 导航组件: Route和Switch\n```\n\n<details> \n<summary>查看答案</summary>\n\n```text\n答案为D\n解析：在react-router-dom中通常使用的组件有三种路由器组件: 如BrowserRouter和HashRouter\n\n路由匹配组件: Route和Switch 组件\n\n导航组件: Link和NavLink 组件\n```\n\n</details>\n\n5. 以下不属于 react 支持的剪贴板事件的是?\n\n```\nA. onCopy\n```\n\n```\nB. onPaste\n```\n\n```\nC. onCut\n```\n\n```\nD. onBeforeCopy\n```\n\n<details> \n<summary>查看答案</summary>\n\n```text\n答案为D\n解析：react支持的剪贴板事件有onCopy，onCut，onPaste\n```\n\n</details>\n\n6. 以下不属于 StrictMode 的作用或优点的是？\n\n```\nA. 检测过时的 context API\n```\n\n```\nB. 识别不安全的生命周期\n```\n\n```\nC. 检测意外的副作用\n```\n\n```\nD. 在生产环境也生效\n```\n\n<details> \n<summary>查看答案</summary>\n\n```text\n答案为D\n解析：严格模式检查仅在开发模式下运行，它们不会影响生产构建。\n```\n\n</details>\n\n7. 以下关于 Mobx 中原则说法错误的是?\n\n```\nA. Mobx 支持单向数据流\n```\n\n```\nB. 当状态改变时，所有衍生都会进行自动更新，可以观察到中间值\n```\n\n```\nC. 所有衍生默认都是同步更新\n```\n\n```\nD. 所有的计算值都应该是纯净的\n```\n\n<details> \n<summary>查看答案</summary>\n\n```text\n答案为B\n解析：当状态改变时，所有衍生都会进行原子级的自动更新。因此永远不可能观察到中间值。\n```\n\n</details>\n\n8. 关于 Context 一下说法错误的是？\n\n```\nA. Context提供了一种在组件之间共享此类值的方式，而不必显式地通过组件树的逐层传递 props\n```\n\n```\nB. Context设计目的是为了共享那些对于一个组件树而言是“全局”的数据\n```\n\n```\nC. Context会提高组件的复用性\n```\n\n```\nD. Context能让你将这些数据向组件树下所有的组件进行“广播”，所有的组件都能访问到这些数据，也能访问到后续的数据更新\n```\n\n<details> \n<summary>查看答案</summary>\n\n```text\n答案为C\n解析：当一些值需要在多个组件间共享的时候，context是个可以避免数据层层传递的方法，但他会使得组件得复用性变差。\n```\n\n</details>\n\n9. 以下关于 useContext 说法错误的是?\n\n```\nA. 调用了useContext的组件总会在context值变化时重新渲染\n```\n\n```\nB. 当组件上层最近的 <MyContext.Provider> 更新时，该 Hook 会触发重渲染\n```\n\n```\nC. useContext 的参数必须是 context 对象本身：\n```\n\n```\nD. 当组件最上层的 <MyContext.Provider> 更新时，该 Hook 会触发重渲染\n```\n\n<details> \n<summary>查看答案</summary>\n\n```text\n答案为C\n解析：useContext 的参数必须是 *context 对象本身*：\n当组件上层最近的 <MyContext.Provider> 更新时，该 Hook 会触发重渲染，并使用最新传递给 MyContext provider 的 context value 值。\n```\n\n</details>\n\n10. 可以使子节点渲染到存在于父组件以外的 DOM 节点上的方法是?\n\n```\nA. React.createPortal\n```\n\n```\nB. React.createElement\n```\n\n```\nC. ReactDOM.createPortal\n```\n\n```\nD. ReactDom.render\n```\n\n<details> \n<summary>查看答案</summary>\n\n```text\n答案为C\n解析：ReactDOM.createPortal函数可以将子节点渲染到存在于父组件以外的DOM节点上。\n```\n\n</details>\n    \n11. 关于React中的“状态提升”说法错误的是?\n\n```\nA. React建议任何可变数据应当只有一个相对应的唯一“数据源”\n```\n\n```\nB. 提升状态(state)方式相比于双向绑定方式需要编写更多的“样板”代码\n```\n\n```\nC. 虽然某些数据可以由props或state推导得出，但是我们最好还是单独在state声明它\n```\n\n```\nD. 通常，多个组件需要反映相同的变化数据，都应尽量将共享状态提升到最近的公共父组件中去\n```\n\n<details> \n<summary>查看答案</summary>\n\n```text\n答案为C\n解析：其中ABD都为官方说法，C选项中如果某些数据可以由props或state推导得出，那么就不应该将其在state中声明。\n```\n\n</details>\n\n## 其他\n\n1. 请选择下面代码输出 1 的次数\n\n```js\nvar vm = new Vue({\n  el: \"#example\",\n  data: {\n    message: \"Hello\",\n  },\n  computed: {\n    test: function () {\n      console.log(1);\n      return this.message;\n    },\n  },\n  created: function () {\n    this.message = \"World\";\n    for (var i = 0; i < 5; i++) {\n      console.log(this.test);\n    }\n  },\n});\n```\n\n解释：因为 vue 的 `computed` 具有`缓存`功能。`message` 只`更新了一次`，所以 `test` `只触发一次`，执行一次 console.log(1)。\n具体来说，computed 内的 test 函数会被加入到 message 这个响应式数据的依赖视图中，当修改了 message（触发了 message 的 set）之后，test 这个 computed 的 dirty 属性会被设置为 true，当视图渲染的时候，发现 dirty 为 true 了，就会执行 1 次 test 函数以获取最新的值。\n","slug":"前端笔试/错题集","published":1,"updated":"2022-10-14T02:58:19.766Z","_id":"cl95206co00103no2do3odsv5","comments":1,"layout":"post","photos":[],"link":"","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><h1 id=\"个人错题集\"><a href=\"#个人错题集\" class=\"headerlink\" title=\"个人错题集\"></a>个人错题集</h1><h2 id=\"react\"><a href=\"#react\" class=\"headerlink\" title=\"react\"></a>react</h2><ol>\n<li><Route />中的 path 属性可以使用通配符，以下关于通配符的规则描述错误的是？</li>\n</ol>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. “:paramName”： 匹配URL的一个部分，直到遇到下一个/、?、#为止。这个路径参数可以通过this.props.params.paramName取出</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. “()”： ()表示URL的这个部分是可选的。</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. “*”： *匹配任意字符，直到模式里面的下一个字符为止。匹配方式是贪婪模式。</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. “**”：** 匹配任意字符，直到下一个/、?、#为止。匹配方式是贪婪模式。</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary> \n    \n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为D，*匹配任意字符，直到模式里面的下一个字符为止。匹配方式是非贪婪模式。</span><br></pre></td></tr></table></figure>\n</details>\n\n<ol start=\"2\">\n<li>关于“错误边界”，以下说法错误的是？</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. static getDerivedStateFromError() 可以用来渲染备用UI</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. componentDidCatch()可以打印错误信息</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. 错误边界是一种React组件，这种组件可以捕获并打印发生在当前组件的javaScript错误</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. class组件中只要定义了static getDerivedStateFromError()或componentDidCatch()其中一个，该组件就会变成错误边界</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary> \n    \n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为C</span><br><span class=\"line\">解析：错误边界无法捕获 以下四种场景中产生的错误： </span><br><span class=\"line\">    1.`事件处理函数`（因为 Error Boundaries 实现的本质是触发更新，但是事件处理函数不在render或者commit阶段，所以无法进行捕获，</span><br><span class=\"line\">如果你需要在事件处理器内部捕获错误，可以使用原生的 try / catch 语句 ） </span><br><span class=\"line\">    2. 异步代码（例如 setTimeout 或 requestAnimationFrame 回调函数） </span><br><span class=\"line\">    3. 服务端渲染（因为触发更新只能在客户端进行，不能在serve端进行） </span><br><span class=\"line\">    4. 它自身抛出来的错误（因为错误抛出要向父节点冒泡寻找 Error Boundaries 处理，无法处理自身产生的错误）</span><br></pre></td></tr></table></figure>\n</details>\n\n<ol start=\"3\">\n<li>以下不属于 React 支持的触摸事件的是？</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. onTouchCancel</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. onTouchEnd</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. onTouchStart</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. onTouchOver</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<p>答案为 D<br>React 支持的触摸事件有：onTouchStart，onTouchMove，onTouchEnd，onTouchCancel</p>\n<table>\n<thead>\n<tr>\n<th>事件</th>\n<th>触发时机</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>onTouchStart</td>\n<td>手指触摸屏幕的时候触发</td>\n</tr>\n<tr>\n<td>onTouchMove</td>\n<td>手指在屏幕上滑动的时候触发</td>\n</tr>\n<tr>\n<td>onTouchEnd</td>\n<td>手指从屏幕上移开的时候触发</td>\n</tr>\n<tr>\n<td>onTouchCancel</td>\n<td>触摸事件被中断时发生，如：来电话、来短信、弹出消息提示</td>\n</tr>\n</tbody></table>\n</details>\n\n<ol start=\"4\">\n<li>以下哪项对 react-router-dom 中组件分类是错误的?</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. 路由器组件: BrowserRouter和HashRouter</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. 导航组件: Link和NavLink</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. 路由匹配组件: Route和Switch</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. 导航组件: Route和Switch</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为D</span><br><span class=\"line\">解析：在react-router-dom中通常使用的组件有三种路由器组件: 如BrowserRouter和HashRouter</span><br><span class=\"line\"></span><br><span class=\"line\">路由匹配组件: Route和Switch 组件</span><br><span class=\"line\"></span><br><span class=\"line\">导航组件: Link和NavLink 组件</span><br></pre></td></tr></table></figure>\n\n</details>\n\n<ol start=\"5\">\n<li>以下不属于 react 支持的剪贴板事件的是?</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. onCopy</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. onPaste</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. onCut</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. onBeforeCopy</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为D</span><br><span class=\"line\">解析：react支持的剪贴板事件有onCopy，onCut，onPaste</span><br></pre></td></tr></table></figure>\n\n</details>\n\n<ol start=\"6\">\n<li>以下不属于 StrictMode 的作用或优点的是？</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. 检测过时的 context API</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. 识别不安全的生命周期</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. 检测意外的副作用</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. 在生产环境也生效</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为D</span><br><span class=\"line\">解析：严格模式检查仅在开发模式下运行，它们不会影响生产构建。</span><br></pre></td></tr></table></figure>\n\n</details>\n\n<ol start=\"7\">\n<li>以下关于 Mobx 中原则说法错误的是?</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. Mobx 支持单向数据流</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. 当状态改变时，所有衍生都会进行自动更新，可以观察到中间值</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. 所有衍生默认都是同步更新</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. 所有的计算值都应该是纯净的</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为B</span><br><span class=\"line\">解析：当状态改变时，所有衍生都会进行原子级的自动更新。因此永远不可能观察到中间值。</span><br></pre></td></tr></table></figure>\n\n</details>\n\n<ol start=\"8\">\n<li>关于 Context 一下说法错误的是？</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. Context提供了一种在组件之间共享此类值的方式，而不必显式地通过组件树的逐层传递 props</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. Context设计目的是为了共享那些对于一个组件树而言是“全局”的数据</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. Context会提高组件的复用性</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. Context能让你将这些数据向组件树下所有的组件进行“广播”，所有的组件都能访问到这些数据，也能访问到后续的数据更新</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为C</span><br><span class=\"line\">解析：当一些值需要在多个组件间共享的时候，context是个可以避免数据层层传递的方法，但他会使得组件得复用性变差。</span><br></pre></td></tr></table></figure>\n\n</details>\n\n<ol start=\"9\">\n<li>以下关于 useContext 说法错误的是?</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. 调用了useContext的组件总会在context值变化时重新渲染</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. 当组件上层最近的 &lt;MyContext.Provider&gt; 更新时，该 Hook 会触发重渲染</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. useContext 的参数必须是 context 对象本身：</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. 当组件最上层的 &lt;MyContext.Provider&gt; 更新时，该 Hook 会触发重渲染</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为C</span><br><span class=\"line\">解析：useContext 的参数必须是 *context 对象本身*：</span><br><span class=\"line\">当组件上层最近的 &lt;MyContext.Provider&gt; 更新时，该 Hook 会触发重渲染，并使用最新传递给 MyContext provider 的 context value 值。</span><br></pre></td></tr></table></figure>\n\n</details>\n\n<ol start=\"10\">\n<li>可以使子节点渲染到存在于父组件以外的 DOM 节点上的方法是?</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. React.createPortal</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. React.createElement</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. ReactDOM.createPortal</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. ReactDom.render</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为C</span><br><span class=\"line\">解析：ReactDOM.createPortal函数可以将子节点渲染到存在于父组件以外的DOM节点上。</span><br></pre></td></tr></table></figure>\n\n</details>\n    \n<ol start=\"11\">\n<li>关于React中的“状态提升”说法错误的是?</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. React建议任何可变数据应当只有一个相对应的唯一“数据源”</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. 提升状态(state)方式相比于双向绑定方式需要编写更多的“样板”代码</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. 虽然某些数据可以由props或state推导得出，但是我们最好还是单独在state声明它</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. 通常，多个组件需要反映相同的变化数据，都应尽量将共享状态提升到最近的公共父组件中去</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为C</span><br><span class=\"line\">解析：其中ABD都为官方说法，C选项中如果某些数据可以由props或state推导得出，那么就不应该将其在state中声明。</span><br></pre></td></tr></table></figure>\n\n</details>\n\n<h2 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h2><ol>\n<li>请选择下面代码输出 1 的次数</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> vm = <span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">el</span>: <span class=\"string\">&quot;#example&quot;</span>,</span><br><span class=\"line\">  <span class=\"attr\">data</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">message</span>: <span class=\"string\">&quot;Hello&quot;</span>,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">computed</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">test</span>: <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">message</span>;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">created</span>: <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">message</span> = <span class=\"string\">&quot;World&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">test</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>解释：因为 vue 的 <code>computed</code> 具有<code>缓存</code>功能。<code>message</code> 只<code>更新了一次</code>，所以 <code>test</code> <code>只触发一次</code>，执行一次 console.log(1)。<br>具体来说，computed 内的 test 函数会被加入到 message 这个响应式数据的依赖视图中，当修改了 message（触发了 message 的 set）之后，test 这个 computed 的 dirty 属性会被设置为 true，当视图渲染的时候，发现 dirty 为 true 了，就会执行 1 次 test 函数以获取最新的值。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"个人错题集\"><a href=\"#个人错题集\" class=\"headerlink\" title=\"个人错题集\"></a>个人错题集</h1><h2 id=\"react\"><a href=\"#react\" class=\"headerlink\" title=\"react\"></a>react</h2><ol>\n<li><Route />中的 path 属性可以使用通配符，以下关于通配符的规则描述错误的是？</li>\n</ol>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. “:paramName”： 匹配URL的一个部分，直到遇到下一个/、?、#为止。这个路径参数可以通过this.props.params.paramName取出</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. “()”： ()表示URL的这个部分是可选的。</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. “*”： *匹配任意字符，直到模式里面的下一个字符为止。匹配方式是贪婪模式。</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. “**”：** 匹配任意字符，直到下一个/、?、#为止。匹配方式是贪婪模式。</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary> \n    \n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为D，*匹配任意字符，直到模式里面的下一个字符为止。匹配方式是非贪婪模式。</span><br></pre></td></tr></table></figure>\n</details>\n\n<ol start=\"2\">\n<li>关于“错误边界”，以下说法错误的是？</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. static getDerivedStateFromError() 可以用来渲染备用UI</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. componentDidCatch()可以打印错误信息</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. 错误边界是一种React组件，这种组件可以捕获并打印发生在当前组件的javaScript错误</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. class组件中只要定义了static getDerivedStateFromError()或componentDidCatch()其中一个，该组件就会变成错误边界</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary> \n    \n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为C</span><br><span class=\"line\">解析：错误边界无法捕获 以下四种场景中产生的错误： </span><br><span class=\"line\">    1.`事件处理函数`（因为 Error Boundaries 实现的本质是触发更新，但是事件处理函数不在render或者commit阶段，所以无法进行捕获，</span><br><span class=\"line\">如果你需要在事件处理器内部捕获错误，可以使用原生的 try / catch 语句 ） </span><br><span class=\"line\">    2. 异步代码（例如 setTimeout 或 requestAnimationFrame 回调函数） </span><br><span class=\"line\">    3. 服务端渲染（因为触发更新只能在客户端进行，不能在serve端进行） </span><br><span class=\"line\">    4. 它自身抛出来的错误（因为错误抛出要向父节点冒泡寻找 Error Boundaries 处理，无法处理自身产生的错误）</span><br></pre></td></tr></table></figure>\n</details>\n\n<ol start=\"3\">\n<li>以下不属于 React 支持的触摸事件的是？</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. onTouchCancel</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. onTouchEnd</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. onTouchStart</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. onTouchOver</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<p>答案为 D<br>React 支持的触摸事件有：onTouchStart，onTouchMove，onTouchEnd，onTouchCancel</p>\n<table>\n<thead>\n<tr>\n<th>事件</th>\n<th>触发时机</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>onTouchStart</td>\n<td>手指触摸屏幕的时候触发</td>\n</tr>\n<tr>\n<td>onTouchMove</td>\n<td>手指在屏幕上滑动的时候触发</td>\n</tr>\n<tr>\n<td>onTouchEnd</td>\n<td>手指从屏幕上移开的时候触发</td>\n</tr>\n<tr>\n<td>onTouchCancel</td>\n<td>触摸事件被中断时发生，如：来电话、来短信、弹出消息提示</td>\n</tr>\n</tbody></table>\n</details>\n\n<ol start=\"4\">\n<li>以下哪项对 react-router-dom 中组件分类是错误的?</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. 路由器组件: BrowserRouter和HashRouter</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. 导航组件: Link和NavLink</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. 路由匹配组件: Route和Switch</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. 导航组件: Route和Switch</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为D</span><br><span class=\"line\">解析：在react-router-dom中通常使用的组件有三种路由器组件: 如BrowserRouter和HashRouter</span><br><span class=\"line\"></span><br><span class=\"line\">路由匹配组件: Route和Switch 组件</span><br><span class=\"line\"></span><br><span class=\"line\">导航组件: Link和NavLink 组件</span><br></pre></td></tr></table></figure>\n\n</details>\n\n<ol start=\"5\">\n<li>以下不属于 react 支持的剪贴板事件的是?</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. onCopy</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. onPaste</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. onCut</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. onBeforeCopy</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为D</span><br><span class=\"line\">解析：react支持的剪贴板事件有onCopy，onCut，onPaste</span><br></pre></td></tr></table></figure>\n\n</details>\n\n<ol start=\"6\">\n<li>以下不属于 StrictMode 的作用或优点的是？</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. 检测过时的 context API</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. 识别不安全的生命周期</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. 检测意外的副作用</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. 在生产环境也生效</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为D</span><br><span class=\"line\">解析：严格模式检查仅在开发模式下运行，它们不会影响生产构建。</span><br></pre></td></tr></table></figure>\n\n</details>\n\n<ol start=\"7\">\n<li>以下关于 Mobx 中原则说法错误的是?</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. Mobx 支持单向数据流</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. 当状态改变时，所有衍生都会进行自动更新，可以观察到中间值</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. 所有衍生默认都是同步更新</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. 所有的计算值都应该是纯净的</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为B</span><br><span class=\"line\">解析：当状态改变时，所有衍生都会进行原子级的自动更新。因此永远不可能观察到中间值。</span><br></pre></td></tr></table></figure>\n\n</details>\n\n<ol start=\"8\">\n<li>关于 Context 一下说法错误的是？</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. Context提供了一种在组件之间共享此类值的方式，而不必显式地通过组件树的逐层传递 props</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. Context设计目的是为了共享那些对于一个组件树而言是“全局”的数据</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. Context会提高组件的复用性</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. Context能让你将这些数据向组件树下所有的组件进行“广播”，所有的组件都能访问到这些数据，也能访问到后续的数据更新</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为C</span><br><span class=\"line\">解析：当一些值需要在多个组件间共享的时候，context是个可以避免数据层层传递的方法，但他会使得组件得复用性变差。</span><br></pre></td></tr></table></figure>\n\n</details>\n\n<ol start=\"9\">\n<li>以下关于 useContext 说法错误的是?</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. 调用了useContext的组件总会在context值变化时重新渲染</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. 当组件上层最近的 &lt;MyContext.Provider&gt; 更新时，该 Hook 会触发重渲染</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. useContext 的参数必须是 context 对象本身：</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. 当组件最上层的 &lt;MyContext.Provider&gt; 更新时，该 Hook 会触发重渲染</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为C</span><br><span class=\"line\">解析：useContext 的参数必须是 *context 对象本身*：</span><br><span class=\"line\">当组件上层最近的 &lt;MyContext.Provider&gt; 更新时，该 Hook 会触发重渲染，并使用最新传递给 MyContext provider 的 context value 值。</span><br></pre></td></tr></table></figure>\n\n</details>\n\n<ol start=\"10\">\n<li>可以使子节点渲染到存在于父组件以外的 DOM 节点上的方法是?</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. React.createPortal</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. React.createElement</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. ReactDOM.createPortal</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. ReactDom.render</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为C</span><br><span class=\"line\">解析：ReactDOM.createPortal函数可以将子节点渲染到存在于父组件以外的DOM节点上。</span><br></pre></td></tr></table></figure>\n\n</details>\n    \n<ol start=\"11\">\n<li>关于React中的“状态提升”说法错误的是?</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A. React建议任何可变数据应当只有一个相对应的唯一“数据源”</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">B. 提升状态(state)方式相比于双向绑定方式需要编写更多的“样板”代码</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C. 虽然某些数据可以由props或state推导得出，但是我们最好还是单独在state声明它</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D. 通常，多个组件需要反映相同的变化数据，都应尽量将共享状态提升到最近的公共父组件中去</span><br></pre></td></tr></table></figure>\n\n<details> \n<summary>查看答案</summary>\n\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案为C</span><br><span class=\"line\">解析：其中ABD都为官方说法，C选项中如果某些数据可以由props或state推导得出，那么就不应该将其在state中声明。</span><br></pre></td></tr></table></figure>\n\n</details>\n\n<h2 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h2><ol>\n<li>请选择下面代码输出 1 的次数</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> vm = <span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">el</span>: <span class=\"string\">&quot;#example&quot;</span>,</span><br><span class=\"line\">  <span class=\"attr\">data</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">message</span>: <span class=\"string\">&quot;Hello&quot;</span>,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">computed</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">test</span>: <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">message</span>;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">created</span>: <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">message</span> = <span class=\"string\">&quot;World&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">test</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>解释：因为 vue 的 <code>computed</code> 具有<code>缓存</code>功能。<code>message</code> 只<code>更新了一次</code>，所以 <code>test</code> <code>只触发一次</code>，执行一次 console.log(1)。<br>具体来说，computed 内的 test 函数会被加入到 message 这个响应式数据的依赖视图中，当修改了 message（触发了 message 的 set）之后，test 这个 computed 的 dirty 属性会被设置为 true，当视图渲染的时候，发现 dirty 为 true 了，就会执行 1 次 test 函数以获取最新的值。</p>\n"},{"title":"docker基础学习","description":"docker基础学习","date":"2022-07-27T16:00:00.000Z","cover":"https://urlify.cn/yqme2e","_content":"\n# docker基础学习——（篇一）\n\n### 安装 Docker\n\n- Mac：[download.docker.com/mac/stable/…](https://download.docker.com/mac/stable/Docker.dmg)\n- Windows：[download.docker.com/win/stable/…](https://download.docker.com/win/stable/Docker for Windows Installer.exe)\n- Linux：[get.docker.com/](https://get.docker.com/)\n\n\n\n### Docker的组成部分\n\n- 镜像(image)\n  - docker镜像就好像是一个模板，可以通过这个模板来创建出来容器的服务，mysql镜像--->run命令--->mysql容器(提供mysql服务)\n  - 通过这个镜像可以创建多个容器(最终服务运行或者项目运行就在容器中的)\n- 容器(container)\n  - Docker利用容器技术，独立运行一个或者一个组应用，通过镜像进行创建\n  - 启动，停止，删除，基本命令\n  - 目前就可以把这个容器理解为就是一个简易的linux系统\n- 仓库(repository)\n  - 仓库就是存放镜像的地方\n  - 仓库分为公有仓库和私有仓库\n  - Docker Hub(默认是国外的)\n  - 阿里云……都有容器服务器(配置镜像加速)\n\n#### **docker的运行**\n\n- run命令执行后到底发生了什么？\n\n  **在执行了docker这个命令后，从client端发送到server这个服务端，在服务中进行执行，这样首先docker会在本地进行查找，看看镜像是不是存在，存在直接运行，不存在的话，会发送指令到docker-hub中，进行查找，若找到了就进行下载，若没有找到，会从服务端返回错误信息，假设找到了，下载到本地，本地就会加载这个镜像，运行起来。**\n\n- **底层原理**\n\n  - docker是一个Client-Server结构的系统，docker的守护进程运行在主机上，通过socket从客户端进行访问\n  - Docker-server接收到docker-client的指令，就会执行这个命令\n\n### docker一些基础的命令\n\n#### 镜像命令\n\n- 查看所有的镜像列表\n\n~~~\ndocker images \n~~~\n\n- 搜索镜像\n\n~~~\ndocker search 镜像名称 \n~~~\n\n- 下载镜像\n\n~~~\ndocker pull 镜像名称\ndocker pull 镜像名称:tag \n~~~\n\n- 删除镜像\n\n~~~\nrmi -------remove image\nDocker rmi -f 镜像id/镜像名称                删除一个镜像 \nDocker rmi -f 镜像id 镜像id  镜像id        删除多个镜像 \nDocker rmi -f  $(docker images -aq)     删除所有镜像 \n~~~\n\n#### 容器命令\n\n- **下载容器**\n\n~~~\ndocker pull centos\n~~~\n\n- **新建容器并启动**\n\n~~~\nDocker run [可选参数] image\n~~~\n\n可选参数：\n\n- `--name = \"Name\"` 给容器起名字 centos1 centos2 用来区分容器\n- `-d`   后台的方式进行运行\n- `-it`    使用交互式的运行方式，进入容器后查看内容\n- `-p`    指定容器的端口  -p 8080：8080\n  - 四种端口的指定方式\n    - -p ip:主机端口:容器端口\n    - **-p** **主机端口：容器端口** **（最常用）**\n    - -p 容器端口\n    - 端口号\n- **列出所有运行的容器**\n  - `无参数` 列出当前正在运行的容器\n  - `-a` 列出当前正在运行的容器+带出历史运行过的容器\n  - `-n=？` 显示最近创建的容器\n  - `-q` 只显示容器的编号\n- **退出容器**\n  - Exit 直接容器停止并且退出了\n  - Ctrl+Q 容器不停止但是退出了\n- **删除容器**\n  - `Docker rm` 容器id\n  - `Docker rm` 容器id 容器id(删除多个)\n  - `Docker rm -f $(docker ps -aq)`\n    - Docker ps -a -q|xargs docker rm 管道的方式删除所有的容器\n    - -f 是强制删除\n- **启动和停止容器的操作**\n  - 启动\n    - docker start 容器id\n  - 重启容器\n    - docker restart 容器id\n  - 停止容器\n    - docker stop 容器id\n  - 杀掉容器\n    - docker kill 容器id\n\n#### 其他常见命令\n\n- 后台启动容器\n\n  - `Docker run -d` 镜像名\n    - 问题：docker ps 发现centos停止了\n    - 常见的坑：docker 容器使用后台运行，就必须要有一个前台进程，docker发现没有应用，就会自动提停止\n      - 通俗的理解就是：我们在run centos的时候，之前会切换到容器之中让我们进行操作，但是-d直接从后台进行启动，docker会检测到这个部分是没有人操作或者容器没有动静，自己就会将相应的资源进行停止\n      - 所以nginx容器启动后，发现自己没有提供服务，就会立刻停止，就是没有程序了\n\n- 查看日志\n\n  - Docker logs -tf --tail 10 容器id\n\n- 测试\n\n  - 自己编写一段shell脚本让程序在后台自己跑\n    - Docker run -d centos /bin/sh -c \"while true;do echo hahaha;sleep 1;done\"\n  - docker ps\n  - Docker logs -tf --tail 10 容器id\n\n- 查看容器内部的进程信息\n\n  - top命令\n    - docker top 容器id\n\n- 查看容器的元数据\n\n  - docker inspect 容器id\n\n- 进入当前正在运行的容器\n\n  - exec\n    - 通常情况下的容器都是在后台方式运行的，需要我们进入容器 ，修改一些配置\n\n- 查看历史命令\n\n~~~\ndocker history 镜像id \n~~~\n\n\n\n#### 分层理解\n\n- 分层的镜像\n  - 我们可以去下载一个镜像，注意观察下载日志的输出，可以看到的是一层一层的下载\n- 思考：为什么Docker镜像要采用这种分层的结构那？\n  - 最大的好处，我觉得莫过于资源共享！比如有多个镜像团队都从相同的Base镜像构建而来，那么宿主机只需要在磁盘中保留一份base镜像，同时内存中也只需要加载一份base镜像，这样就可以为所有的容器服务了，而且镜像的每一层都可以被共享。\n\n#### commit镜像\n\nDocker commit 提交容器成为一个新的副本\n\n~~~\nDocker commit -m=\"提交的描述信息\" -a=\"作者\" 容器id 目标镜像:[Tag] \n~~~\n\n- 实战测试\n  - 启动一个默认的tomcat\n  - 发现这个tomcat 是没写webapps应用的，镜像的原因，官方镜像默认webapps下面是没有东西的\n  - 自己拷贝文件进去\n  - 将我们修改过的镜像提交成一个新的镜像\n\n\n\n> 推荐学习：https://juejin.cn/post/6977180684376866847","source":"_posts/docker/docker基础学习.md","raw":"---\ntitle: docker基础学习\ntags: [运维]\ncategories: [docker]\ndescription: docker基础学习\ndate: 2022-07-28\ncover: https://urlify.cn/yqme2e\n---\n\n# docker基础学习——（篇一）\n\n### 安装 Docker\n\n- Mac：[download.docker.com/mac/stable/…](https://download.docker.com/mac/stable/Docker.dmg)\n- Windows：[download.docker.com/win/stable/…](https://download.docker.com/win/stable/Docker for Windows Installer.exe)\n- Linux：[get.docker.com/](https://get.docker.com/)\n\n\n\n### Docker的组成部分\n\n- 镜像(image)\n  - docker镜像就好像是一个模板，可以通过这个模板来创建出来容器的服务，mysql镜像--->run命令--->mysql容器(提供mysql服务)\n  - 通过这个镜像可以创建多个容器(最终服务运行或者项目运行就在容器中的)\n- 容器(container)\n  - Docker利用容器技术，独立运行一个或者一个组应用，通过镜像进行创建\n  - 启动，停止，删除，基本命令\n  - 目前就可以把这个容器理解为就是一个简易的linux系统\n- 仓库(repository)\n  - 仓库就是存放镜像的地方\n  - 仓库分为公有仓库和私有仓库\n  - Docker Hub(默认是国外的)\n  - 阿里云……都有容器服务器(配置镜像加速)\n\n#### **docker的运行**\n\n- run命令执行后到底发生了什么？\n\n  **在执行了docker这个命令后，从client端发送到server这个服务端，在服务中进行执行，这样首先docker会在本地进行查找，看看镜像是不是存在，存在直接运行，不存在的话，会发送指令到docker-hub中，进行查找，若找到了就进行下载，若没有找到，会从服务端返回错误信息，假设找到了，下载到本地，本地就会加载这个镜像，运行起来。**\n\n- **底层原理**\n\n  - docker是一个Client-Server结构的系统，docker的守护进程运行在主机上，通过socket从客户端进行访问\n  - Docker-server接收到docker-client的指令，就会执行这个命令\n\n### docker一些基础的命令\n\n#### 镜像命令\n\n- 查看所有的镜像列表\n\n~~~\ndocker images \n~~~\n\n- 搜索镜像\n\n~~~\ndocker search 镜像名称 \n~~~\n\n- 下载镜像\n\n~~~\ndocker pull 镜像名称\ndocker pull 镜像名称:tag \n~~~\n\n- 删除镜像\n\n~~~\nrmi -------remove image\nDocker rmi -f 镜像id/镜像名称                删除一个镜像 \nDocker rmi -f 镜像id 镜像id  镜像id        删除多个镜像 \nDocker rmi -f  $(docker images -aq)     删除所有镜像 \n~~~\n\n#### 容器命令\n\n- **下载容器**\n\n~~~\ndocker pull centos\n~~~\n\n- **新建容器并启动**\n\n~~~\nDocker run [可选参数] image\n~~~\n\n可选参数：\n\n- `--name = \"Name\"` 给容器起名字 centos1 centos2 用来区分容器\n- `-d`   后台的方式进行运行\n- `-it`    使用交互式的运行方式，进入容器后查看内容\n- `-p`    指定容器的端口  -p 8080：8080\n  - 四种端口的指定方式\n    - -p ip:主机端口:容器端口\n    - **-p** **主机端口：容器端口** **（最常用）**\n    - -p 容器端口\n    - 端口号\n- **列出所有运行的容器**\n  - `无参数` 列出当前正在运行的容器\n  - `-a` 列出当前正在运行的容器+带出历史运行过的容器\n  - `-n=？` 显示最近创建的容器\n  - `-q` 只显示容器的编号\n- **退出容器**\n  - Exit 直接容器停止并且退出了\n  - Ctrl+Q 容器不停止但是退出了\n- **删除容器**\n  - `Docker rm` 容器id\n  - `Docker rm` 容器id 容器id(删除多个)\n  - `Docker rm -f $(docker ps -aq)`\n    - Docker ps -a -q|xargs docker rm 管道的方式删除所有的容器\n    - -f 是强制删除\n- **启动和停止容器的操作**\n  - 启动\n    - docker start 容器id\n  - 重启容器\n    - docker restart 容器id\n  - 停止容器\n    - docker stop 容器id\n  - 杀掉容器\n    - docker kill 容器id\n\n#### 其他常见命令\n\n- 后台启动容器\n\n  - `Docker run -d` 镜像名\n    - 问题：docker ps 发现centos停止了\n    - 常见的坑：docker 容器使用后台运行，就必须要有一个前台进程，docker发现没有应用，就会自动提停止\n      - 通俗的理解就是：我们在run centos的时候，之前会切换到容器之中让我们进行操作，但是-d直接从后台进行启动，docker会检测到这个部分是没有人操作或者容器没有动静，自己就会将相应的资源进行停止\n      - 所以nginx容器启动后，发现自己没有提供服务，就会立刻停止，就是没有程序了\n\n- 查看日志\n\n  - Docker logs -tf --tail 10 容器id\n\n- 测试\n\n  - 自己编写一段shell脚本让程序在后台自己跑\n    - Docker run -d centos /bin/sh -c \"while true;do echo hahaha;sleep 1;done\"\n  - docker ps\n  - Docker logs -tf --tail 10 容器id\n\n- 查看容器内部的进程信息\n\n  - top命令\n    - docker top 容器id\n\n- 查看容器的元数据\n\n  - docker inspect 容器id\n\n- 进入当前正在运行的容器\n\n  - exec\n    - 通常情况下的容器都是在后台方式运行的，需要我们进入容器 ，修改一些配置\n\n- 查看历史命令\n\n~~~\ndocker history 镜像id \n~~~\n\n\n\n#### 分层理解\n\n- 分层的镜像\n  - 我们可以去下载一个镜像，注意观察下载日志的输出，可以看到的是一层一层的下载\n- 思考：为什么Docker镜像要采用这种分层的结构那？\n  - 最大的好处，我觉得莫过于资源共享！比如有多个镜像团队都从相同的Base镜像构建而来，那么宿主机只需要在磁盘中保留一份base镜像，同时内存中也只需要加载一份base镜像，这样就可以为所有的容器服务了，而且镜像的每一层都可以被共享。\n\n#### commit镜像\n\nDocker commit 提交容器成为一个新的副本\n\n~~~\nDocker commit -m=\"提交的描述信息\" -a=\"作者\" 容器id 目标镜像:[Tag] \n~~~\n\n- 实战测试\n  - 启动一个默认的tomcat\n  - 发现这个tomcat 是没写webapps应用的，镜像的原因，官方镜像默认webapps下面是没有东西的\n  - 自己拷贝文件进去\n  - 将我们修改过的镜像提交成一个新的镜像\n\n\n\n> 推荐学习：https://juejin.cn/post/6977180684376866847","slug":"docker/docker基础学习","published":1,"updated":"2022-10-12T02:50:25.543Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl95206cp00123no2deeheb9h","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><h1 id=\"docker基础学习——（篇一）\"><a href=\"#docker基础学习——（篇一）\" class=\"headerlink\" title=\"docker基础学习——（篇一）\"></a>docker基础学习——（篇一）</h1><h3 id=\"安装-Docker\"><a href=\"#安装-Docker\" class=\"headerlink\" title=\"安装 Docker\"></a>安装 Docker</h3><ul>\n<li>Mac：<a href=\"https://download.docker.com/mac/stable/Docker.dmg\">download.docker.com&#x2F;mac&#x2F;stable&#x2F;…</a></li>\n<li>Windows：[download.docker.com&#x2F;win&#x2F;stable&#x2F;…](<a href=\"https://download.docker.com/win/stable/Docker\">https://download.docker.com/win/stable/Docker</a> for Windows Installer.exe)</li>\n<li>Linux：<a href=\"https://get.docker.com/\">get.docker.com&#x2F;</a></li>\n</ul>\n<h3 id=\"Docker的组成部分\"><a href=\"#Docker的组成部分\" class=\"headerlink\" title=\"Docker的组成部分\"></a>Docker的组成部分</h3><ul>\n<li>镜像(image)<ul>\n<li>docker镜像就好像是一个模板，可以通过这个模板来创建出来容器的服务，mysql镜像—&gt;run命令—&gt;mysql容器(提供mysql服务)</li>\n<li>通过这个镜像可以创建多个容器(最终服务运行或者项目运行就在容器中的)</li>\n</ul>\n</li>\n<li>容器(container)<ul>\n<li>Docker利用容器技术，独立运行一个或者一个组应用，通过镜像进行创建</li>\n<li>启动，停止，删除，基本命令</li>\n<li>目前就可以把这个容器理解为就是一个简易的linux系统</li>\n</ul>\n</li>\n<li>仓库(repository)<ul>\n<li>仓库就是存放镜像的地方</li>\n<li>仓库分为公有仓库和私有仓库</li>\n<li>Docker Hub(默认是国外的)</li>\n<li>阿里云……都有容器服务器(配置镜像加速)</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"docker的运行\"><a href=\"#docker的运行\" class=\"headerlink\" title=\"docker的运行\"></a><strong>docker的运行</strong></h4><ul>\n<li><p>run命令执行后到底发生了什么？</p>\n<p><strong>在执行了docker这个命令后，从client端发送到server这个服务端，在服务中进行执行，这样首先docker会在本地进行查找，看看镜像是不是存在，存在直接运行，不存在的话，会发送指令到docker-hub中，进行查找，若找到了就进行下载，若没有找到，会从服务端返回错误信息，假设找到了，下载到本地，本地就会加载这个镜像，运行起来。</strong></p>\n</li>\n<li><p><strong>底层原理</strong></p>\n<ul>\n<li>docker是一个Client-Server结构的系统，docker的守护进程运行在主机上，通过socket从客户端进行访问</li>\n<li>Docker-server接收到docker-client的指令，就会执行这个命令</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"docker一些基础的命令\"><a href=\"#docker一些基础的命令\" class=\"headerlink\" title=\"docker一些基础的命令\"></a>docker一些基础的命令</h3><h4 id=\"镜像命令\"><a href=\"#镜像命令\" class=\"headerlink\" title=\"镜像命令\"></a>镜像命令</h4><ul>\n<li>查看所有的镜像列表</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images </span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>搜索镜像</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker search 镜像名称 </span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>下载镜像</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull 镜像名称</span><br><span class=\"line\">docker pull 镜像名称:tag </span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>删除镜像</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rmi -------remove image</span><br><span class=\"line\">Docker rmi -f 镜像id/镜像名称                删除一个镜像 </span><br><span class=\"line\">Docker rmi -f 镜像id 镜像id  镜像id        删除多个镜像 </span><br><span class=\"line\">Docker rmi -f  $(docker images -aq)     删除所有镜像 </span><br></pre></td></tr></table></figure>\n\n<h4 id=\"容器命令\"><a href=\"#容器命令\" class=\"headerlink\" title=\"容器命令\"></a>容器命令</h4><ul>\n<li><strong>下载容器</strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull centos</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong>新建容器并启动</strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Docker run [可选参数] image</span><br></pre></td></tr></table></figure>\n\n<p>可选参数：</p>\n<ul>\n<li><code>--name = &quot;Name&quot;</code> 给容器起名字 centos1 centos2 用来区分容器</li>\n<li><code>-d</code>   后台的方式进行运行</li>\n<li><code>-it</code>    使用交互式的运行方式，进入容器后查看内容</li>\n<li><code>-p</code>    指定容器的端口  -p 8080：8080<ul>\n<li>四种端口的指定方式<ul>\n<li>-p ip:主机端口:容器端口</li>\n<li><strong>-p</strong> <strong>主机端口：容器端口</strong> <strong>（最常用）</strong></li>\n<li>-p 容器端口</li>\n<li>端口号</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><strong>列出所有运行的容器</strong><ul>\n<li><code>无参数</code> 列出当前正在运行的容器</li>\n<li><code>-a</code> 列出当前正在运行的容器+带出历史运行过的容器</li>\n<li><code>-n=？</code> 显示最近创建的容器</li>\n<li><code>-q</code> 只显示容器的编号</li>\n</ul>\n</li>\n<li><strong>退出容器</strong><ul>\n<li>Exit 直接容器停止并且退出了</li>\n<li>Ctrl+Q 容器不停止但是退出了</li>\n</ul>\n</li>\n<li><strong>删除容器</strong><ul>\n<li><code>Docker rm</code> 容器id</li>\n<li><code>Docker rm</code> 容器id 容器id(删除多个)</li>\n<li><code>Docker rm -f $(docker ps -aq)</code><ul>\n<li>Docker ps -a -q|xargs docker rm 管道的方式删除所有的容器</li>\n<li>-f 是强制删除</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><strong>启动和停止容器的操作</strong><ul>\n<li>启动<ul>\n<li>docker start 容器id</li>\n</ul>\n</li>\n<li>重启容器<ul>\n<li>docker restart 容器id</li>\n</ul>\n</li>\n<li>停止容器<ul>\n<li>docker stop 容器id</li>\n</ul>\n</li>\n<li>杀掉容器<ul>\n<li>docker kill 容器id</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"其他常见命令\"><a href=\"#其他常见命令\" class=\"headerlink\" title=\"其他常见命令\"></a>其他常见命令</h4><ul>\n<li><p>后台启动容器</p>\n<ul>\n<li><code>Docker run -d</code> 镜像名<ul>\n<li>问题：docker ps 发现centos停止了</li>\n<li>常见的坑：docker 容器使用后台运行，就必须要有一个前台进程，docker发现没有应用，就会自动提停止<ul>\n<li>通俗的理解就是：我们在run centos的时候，之前会切换到容器之中让我们进行操作，但是-d直接从后台进行启动，docker会检测到这个部分是没有人操作或者容器没有动静，自己就会将相应的资源进行停止</li>\n<li>所以nginx容器启动后，发现自己没有提供服务，就会立刻停止，就是没有程序了</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>查看日志</p>\n<ul>\n<li>Docker logs -tf –tail 10 容器id</li>\n</ul>\n</li>\n<li><p>测试</p>\n<ul>\n<li>自己编写一段shell脚本让程序在后台自己跑<ul>\n<li>Docker run -d centos &#x2F;bin&#x2F;sh -c “while true;do echo hahaha;sleep 1;done”</li>\n</ul>\n</li>\n<li>docker ps</li>\n<li>Docker logs -tf –tail 10 容器id</li>\n</ul>\n</li>\n<li><p>查看容器内部的进程信息</p>\n<ul>\n<li>top命令<ul>\n<li>docker top 容器id</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>查看容器的元数据</p>\n<ul>\n<li>docker inspect 容器id</li>\n</ul>\n</li>\n<li><p>进入当前正在运行的容器</p>\n<ul>\n<li>exec<ul>\n<li>通常情况下的容器都是在后台方式运行的，需要我们进入容器 ，修改一些配置</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>查看历史命令</p>\n</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker history 镜像id </span><br></pre></td></tr></table></figure>\n\n\n\n<h4 id=\"分层理解\"><a href=\"#分层理解\" class=\"headerlink\" title=\"分层理解\"></a>分层理解</h4><ul>\n<li>分层的镜像<ul>\n<li>我们可以去下载一个镜像，注意观察下载日志的输出，可以看到的是一层一层的下载</li>\n</ul>\n</li>\n<li>思考：为什么Docker镜像要采用这种分层的结构那？<ul>\n<li>最大的好处，我觉得莫过于资源共享！比如有多个镜像团队都从相同的Base镜像构建而来，那么宿主机只需要在磁盘中保留一份base镜像，同时内存中也只需要加载一份base镜像，这样就可以为所有的容器服务了，而且镜像的每一层都可以被共享。</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"commit镜像\"><a href=\"#commit镜像\" class=\"headerlink\" title=\"commit镜像\"></a>commit镜像</h4><p>Docker commit 提交容器成为一个新的副本</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Docker commit -m=&quot;提交的描述信息&quot; -a=&quot;作者&quot; 容器id 目标镜像:[Tag] </span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>实战测试<ul>\n<li>启动一个默认的tomcat</li>\n<li>发现这个tomcat 是没写webapps应用的，镜像的原因，官方镜像默认webapps下面是没有东西的</li>\n<li>自己拷贝文件进去</li>\n<li>将我们修改过的镜像提交成一个新的镜像</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>推荐学习：<a href=\"https://juejin.cn/post/6977180684376866847\">https://juejin.cn/post/6977180684376866847</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"docker基础学习——（篇一）\"><a href=\"#docker基础学习——（篇一）\" class=\"headerlink\" title=\"docker基础学习——（篇一）\"></a>docker基础学习——（篇一）</h1><h3 id=\"安装-Docker\"><a href=\"#安装-Docker\" class=\"headerlink\" title=\"安装 Docker\"></a>安装 Docker</h3><ul>\n<li>Mac：<a href=\"https://download.docker.com/mac/stable/Docker.dmg\">download.docker.com&#x2F;mac&#x2F;stable&#x2F;…</a></li>\n<li>Windows：[download.docker.com&#x2F;win&#x2F;stable&#x2F;…](<a href=\"https://download.docker.com/win/stable/Docker\">https://download.docker.com/win/stable/Docker</a> for Windows Installer.exe)</li>\n<li>Linux：<a href=\"https://get.docker.com/\">get.docker.com&#x2F;</a></li>\n</ul>\n<h3 id=\"Docker的组成部分\"><a href=\"#Docker的组成部分\" class=\"headerlink\" title=\"Docker的组成部分\"></a>Docker的组成部分</h3><ul>\n<li>镜像(image)<ul>\n<li>docker镜像就好像是一个模板，可以通过这个模板来创建出来容器的服务，mysql镜像—&gt;run命令—&gt;mysql容器(提供mysql服务)</li>\n<li>通过这个镜像可以创建多个容器(最终服务运行或者项目运行就在容器中的)</li>\n</ul>\n</li>\n<li>容器(container)<ul>\n<li>Docker利用容器技术，独立运行一个或者一个组应用，通过镜像进行创建</li>\n<li>启动，停止，删除，基本命令</li>\n<li>目前就可以把这个容器理解为就是一个简易的linux系统</li>\n</ul>\n</li>\n<li>仓库(repository)<ul>\n<li>仓库就是存放镜像的地方</li>\n<li>仓库分为公有仓库和私有仓库</li>\n<li>Docker Hub(默认是国外的)</li>\n<li>阿里云……都有容器服务器(配置镜像加速)</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"docker的运行\"><a href=\"#docker的运行\" class=\"headerlink\" title=\"docker的运行\"></a><strong>docker的运行</strong></h4><ul>\n<li><p>run命令执行后到底发生了什么？</p>\n<p><strong>在执行了docker这个命令后，从client端发送到server这个服务端，在服务中进行执行，这样首先docker会在本地进行查找，看看镜像是不是存在，存在直接运行，不存在的话，会发送指令到docker-hub中，进行查找，若找到了就进行下载，若没有找到，会从服务端返回错误信息，假设找到了，下载到本地，本地就会加载这个镜像，运行起来。</strong></p>\n</li>\n<li><p><strong>底层原理</strong></p>\n<ul>\n<li>docker是一个Client-Server结构的系统，docker的守护进程运行在主机上，通过socket从客户端进行访问</li>\n<li>Docker-server接收到docker-client的指令，就会执行这个命令</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"docker一些基础的命令\"><a href=\"#docker一些基础的命令\" class=\"headerlink\" title=\"docker一些基础的命令\"></a>docker一些基础的命令</h3><h4 id=\"镜像命令\"><a href=\"#镜像命令\" class=\"headerlink\" title=\"镜像命令\"></a>镜像命令</h4><ul>\n<li>查看所有的镜像列表</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images </span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>搜索镜像</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker search 镜像名称 </span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>下载镜像</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull 镜像名称</span><br><span class=\"line\">docker pull 镜像名称:tag </span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>删除镜像</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rmi -------remove image</span><br><span class=\"line\">Docker rmi -f 镜像id/镜像名称                删除一个镜像 </span><br><span class=\"line\">Docker rmi -f 镜像id 镜像id  镜像id        删除多个镜像 </span><br><span class=\"line\">Docker rmi -f  $(docker images -aq)     删除所有镜像 </span><br></pre></td></tr></table></figure>\n\n<h4 id=\"容器命令\"><a href=\"#容器命令\" class=\"headerlink\" title=\"容器命令\"></a>容器命令</h4><ul>\n<li><strong>下载容器</strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull centos</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong>新建容器并启动</strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Docker run [可选参数] image</span><br></pre></td></tr></table></figure>\n\n<p>可选参数：</p>\n<ul>\n<li><code>--name = &quot;Name&quot;</code> 给容器起名字 centos1 centos2 用来区分容器</li>\n<li><code>-d</code>   后台的方式进行运行</li>\n<li><code>-it</code>    使用交互式的运行方式，进入容器后查看内容</li>\n<li><code>-p</code>    指定容器的端口  -p 8080：8080<ul>\n<li>四种端口的指定方式<ul>\n<li>-p ip:主机端口:容器端口</li>\n<li><strong>-p</strong> <strong>主机端口：容器端口</strong> <strong>（最常用）</strong></li>\n<li>-p 容器端口</li>\n<li>端口号</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><strong>列出所有运行的容器</strong><ul>\n<li><code>无参数</code> 列出当前正在运行的容器</li>\n<li><code>-a</code> 列出当前正在运行的容器+带出历史运行过的容器</li>\n<li><code>-n=？</code> 显示最近创建的容器</li>\n<li><code>-q</code> 只显示容器的编号</li>\n</ul>\n</li>\n<li><strong>退出容器</strong><ul>\n<li>Exit 直接容器停止并且退出了</li>\n<li>Ctrl+Q 容器不停止但是退出了</li>\n</ul>\n</li>\n<li><strong>删除容器</strong><ul>\n<li><code>Docker rm</code> 容器id</li>\n<li><code>Docker rm</code> 容器id 容器id(删除多个)</li>\n<li><code>Docker rm -f $(docker ps -aq)</code><ul>\n<li>Docker ps -a -q|xargs docker rm 管道的方式删除所有的容器</li>\n<li>-f 是强制删除</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><strong>启动和停止容器的操作</strong><ul>\n<li>启动<ul>\n<li>docker start 容器id</li>\n</ul>\n</li>\n<li>重启容器<ul>\n<li>docker restart 容器id</li>\n</ul>\n</li>\n<li>停止容器<ul>\n<li>docker stop 容器id</li>\n</ul>\n</li>\n<li>杀掉容器<ul>\n<li>docker kill 容器id</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"其他常见命令\"><a href=\"#其他常见命令\" class=\"headerlink\" title=\"其他常见命令\"></a>其他常见命令</h4><ul>\n<li><p>后台启动容器</p>\n<ul>\n<li><code>Docker run -d</code> 镜像名<ul>\n<li>问题：docker ps 发现centos停止了</li>\n<li>常见的坑：docker 容器使用后台运行，就必须要有一个前台进程，docker发现没有应用，就会自动提停止<ul>\n<li>通俗的理解就是：我们在run centos的时候，之前会切换到容器之中让我们进行操作，但是-d直接从后台进行启动，docker会检测到这个部分是没有人操作或者容器没有动静，自己就会将相应的资源进行停止</li>\n<li>所以nginx容器启动后，发现自己没有提供服务，就会立刻停止，就是没有程序了</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>查看日志</p>\n<ul>\n<li>Docker logs -tf –tail 10 容器id</li>\n</ul>\n</li>\n<li><p>测试</p>\n<ul>\n<li>自己编写一段shell脚本让程序在后台自己跑<ul>\n<li>Docker run -d centos &#x2F;bin&#x2F;sh -c “while true;do echo hahaha;sleep 1;done”</li>\n</ul>\n</li>\n<li>docker ps</li>\n<li>Docker logs -tf –tail 10 容器id</li>\n</ul>\n</li>\n<li><p>查看容器内部的进程信息</p>\n<ul>\n<li>top命令<ul>\n<li>docker top 容器id</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>查看容器的元数据</p>\n<ul>\n<li>docker inspect 容器id</li>\n</ul>\n</li>\n<li><p>进入当前正在运行的容器</p>\n<ul>\n<li>exec<ul>\n<li>通常情况下的容器都是在后台方式运行的，需要我们进入容器 ，修改一些配置</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>查看历史命令</p>\n</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker history 镜像id </span><br></pre></td></tr></table></figure>\n\n\n\n<h4 id=\"分层理解\"><a href=\"#分层理解\" class=\"headerlink\" title=\"分层理解\"></a>分层理解</h4><ul>\n<li>分层的镜像<ul>\n<li>我们可以去下载一个镜像，注意观察下载日志的输出，可以看到的是一层一层的下载</li>\n</ul>\n</li>\n<li>思考：为什么Docker镜像要采用这种分层的结构那？<ul>\n<li>最大的好处，我觉得莫过于资源共享！比如有多个镜像团队都从相同的Base镜像构建而来，那么宿主机只需要在磁盘中保留一份base镜像，同时内存中也只需要加载一份base镜像，这样就可以为所有的容器服务了，而且镜像的每一层都可以被共享。</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"commit镜像\"><a href=\"#commit镜像\" class=\"headerlink\" title=\"commit镜像\"></a>commit镜像</h4><p>Docker commit 提交容器成为一个新的副本</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Docker commit -m=&quot;提交的描述信息&quot; -a=&quot;作者&quot; 容器id 目标镜像:[Tag] </span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>实战测试<ul>\n<li>启动一个默认的tomcat</li>\n<li>发现这个tomcat 是没写webapps应用的，镜像的原因，官方镜像默认webapps下面是没有东西的</li>\n<li>自己拷贝文件进去</li>\n<li>将我们修改过的镜像提交成一个新的镜像</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>推荐学习：<a href=\"https://juejin.cn/post/6977180684376866847\">https://juejin.cn/post/6977180684376866847</a></p>\n</blockquote>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cl95206bv00013no2cb5dboqb","category_id":"cl95206c100043no20m9r0iqw","_id":"cl95206cg000k3no2ay13e7kr"},{"post_id":"cl95206cc000g3no216y51asw","category_id":"cl95206c8000c3no20708d6yy","_id":"cl95206cj000p3no28qb2cmbi"},{"post_id":"cl95206cf000j3no2ahgdgsee","category_id":"cl95206c8000c3no20708d6yy","_id":"cl95206cl000t3no2aj90b9xg"},{"post_id":"cl95206c400073no27h1vduop","category_id":"cl95206ch000m3no2f4ftb0ej","_id":"cl95206co000z3no2e0st09gg"},{"post_id":"cl95206c600093no245k7eh5o","category_id":"cl95206ch000m3no2f4ftb0ej","_id":"cl95206cr00133no22euq4ajv"},{"post_id":"cl95206c8000b3no2a95qg30y","category_id":"cl95206cn000y3no2f4di7nww","_id":"cl95206ct00193no26g8f666q"},{"post_id":"cl95206bz00033no2ccw01daf","category_id":"cl95206c8000c3no20708d6yy","_id":"cl95206cu001c3no22bi1f78a"},{"post_id":"cl95206bz00033no2ccw01daf","category_id":"cl95206cr00153no25rab2zqv","_id":"cl95206cv001f3no2caoifsob"},{"post_id":"cl95206ch000n3no22uq9g4ie","category_id":"cl95206ct001a3no255ux3ft5","_id":"cl95206cv001i3no2hoor54e7"},{"post_id":"cl95206cj000o3no20sid6fao","category_id":"cl95206cu001d3no25k4p6w98","_id":"cl95206cy001n3no243pke8qf"},{"post_id":"cl95206cl000s3no27lhm8yok","category_id":"cl95206cu001d3no25k4p6w98","_id":"cl95206cz001r3no21xvuf4d5"},{"post_id":"cl95206cm000v3no220fl22rq","category_id":"cl95206cy001m3no23bpc0hpv","_id":"cl95206d0001v3no29hvs6t2q"},{"post_id":"cl95206co00103no2do3odsv5","category_id":"cl95206cz001t3no28slz9dem","_id":"cl95206d1001y3no21tar16u9"},{"post_id":"cl95206cp00123no2deeheb9h","category_id":"cl95206d0001w3no28quaap2z","_id":"cl95206d200223no2dgvkcsru"}],"PostTag":[{"post_id":"cl95206c600093no245k7eh5o","tag_id":"cl95206c200053no2g8sy3tf5","_id":"cl95206cb000e3no2d227bdyy"},{"post_id":"cl95206bv00013no2cb5dboqb","tag_id":"cl95206c200053no2g8sy3tf5","_id":"cl95206ce000h3no29zni6ure"},{"post_id":"cl95206bz00033no2ccw01daf","tag_id":"cl95206c200053no2g8sy3tf5","_id":"cl95206cm000u3no250a3157l"},{"post_id":"cl95206bz00033no2ccw01daf","tag_id":"cl95206cg000l3no26y49hk81","_id":"cl95206cn000w3no206u23bge"},{"post_id":"cl95206c400073no27h1vduop","tag_id":"cl95206c200053no2g8sy3tf5","_id":"cl95206cp00113no200dn83xl"},{"post_id":"cl95206c8000b3no2a95qg30y","tag_id":"cl95206c200053no2g8sy3tf5","_id":"cl95206cs00163no2bhsn7j9b"},{"post_id":"cl95206c8000b3no2a95qg30y","tag_id":"cl95206cn000x3no22rsc07gh","_id":"cl95206cs00173no22vezdtti"},{"post_id":"cl95206cc000g3no216y51asw","tag_id":"cl95206c200053no2g8sy3tf5","_id":"cl95206cu001e3no247sp9w7m"},{"post_id":"cl95206cc000g3no216y51asw","tag_id":"cl95206cg000l3no26y49hk81","_id":"cl95206cv001g3no29306e9sl"},{"post_id":"cl95206cc000g3no216y51asw","tag_id":"cl95206ct00183no2c1wmgu40","_id":"cl95206cx001k3no2f0lx9bj5"},{"post_id":"cl95206cf000j3no2ahgdgsee","tag_id":"cl95206c200053no2g8sy3tf5","_id":"cl95206cy001o3no2eol3b1w9"},{"post_id":"cl95206cf000j3no2ahgdgsee","tag_id":"cl95206cg000l3no26y49hk81","_id":"cl95206cz001p3no26a48bfck"},{"post_id":"cl95206cf000j3no2ahgdgsee","tag_id":"cl95206ct00183no2c1wmgu40","_id":"cl95206cz001s3no281b32iw5"},{"post_id":"cl95206ch000n3no22uq9g4ie","tag_id":"cl95206c200053no2g8sy3tf5","_id":"cl95206d1001z3no28ikdfme8"},{"post_id":"cl95206ch000n3no22uq9g4ie","tag_id":"cl95206cx001l3no23nmuhcm5","_id":"cl95206d200203no239so94ks"},{"post_id":"cl95206ch000n3no22uq9g4ie","tag_id":"cl95206cz001q3no275h78zxv","_id":"cl95206d200233no2g5q0hi63"},{"post_id":"cl95206ch000n3no22uq9g4ie","tag_id":"cl95206d0001u3no2b9e6hde1","_id":"cl95206d200243no29baaf1al"},{"post_id":"cl95206cj000o3no20sid6fao","tag_id":"cl95206d0001u3no2b9e6hde1","_id":"cl95206d300263no2biye0f9j"},{"post_id":"cl95206cl000s3no27lhm8yok","tag_id":"cl95206d0001u3no2b9e6hde1","_id":"cl95206d300273no20sgo85vs"},{"post_id":"cl95206cm000v3no220fl22rq","tag_id":"cl95206c200053no2g8sy3tf5","_id":"cl95206d6002a3no20h7he9x2"},{"post_id":"cl95206cm000v3no220fl22rq","tag_id":"cl95206cz001q3no275h78zxv","_id":"cl95206d6002b3no224hmalpr"},{"post_id":"cl95206cm000v3no220fl22rq","tag_id":"cl95206d300283no2gmgc93aa","_id":"cl95206d7002d3no2d1q3381i"},{"post_id":"cl95206co00103no2do3odsv5","tag_id":"cl95206c200053no2g8sy3tf5","_id":"cl95206d7002e3no2amhl7tgt"},{"post_id":"cl95206co00103no2do3odsv5","tag_id":"cl95206d600293no22vde6np1","_id":"cl95206d7002f3no2guu56xu9"},{"post_id":"cl95206cp00123no2deeheb9h","tag_id":"cl95206d7002c3no22k7yeaa0","_id":"cl95206d7002g3no27boi3y9d"}],"Tag":[{"name":"前端","_id":"cl95206c200053no2g8sy3tf5"},{"name":"JavaScript","_id":"cl95206cg000l3no26y49hk81"},{"name":"react-dnd","_id":"cl95206cn000x3no22rsc07gh"},{"name":"skill","_id":"cl95206ct00183no2c1wmgu40"},{"name":"项目","_id":"cl95206cx001l3no23nmuhcm5"},{"name":"Vue","_id":"cl95206cz001q3no275h78zxv"},{"name":"vite","_id":"cl95206d0001u3no2b9e6hde1"},{"name":"前端性能优化","_id":"cl95206d300283no2gmgc93aa"},{"name":"错题集","_id":"cl95206d600293no22vde6np1"},{"name":"运维","_id":"cl95206d7002c3no22k7yeaa0"}]}}